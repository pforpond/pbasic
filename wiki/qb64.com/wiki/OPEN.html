<!DOCTYPE html>
<html lang="en-US">

  
<!-- Mirrored from qb64.com/wiki/OPEN by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:14:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.html">
    <link rel="stylesheet" type="text/css" media="screen" href="../assets/css/style2443.css?v=eb9b8c9cad488bd1304035e1bfc5d2e89b0f78df">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>QB64.com | QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="QB64.com" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<meta property="og:description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<link rel="canonical" href="OPEN-2.html" />
<meta property="og:url" content="OPEN-2.html" />
<meta property="og:site_name" content="QB64.com" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="QB64.com" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.","headline":"QB64.com","url":"https://qb64.com/wiki/OPEN.html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
            <!--<a id="forkme_banner" href="https://github.com/DualBrain/QB64">View on GitHub</a>-->
          

          <h1 id="project_title">QB64.com</h1>
          <h2 id="project_tagline">QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>The <a href="OPEN.html">OPEN</a> statement is used to open a file or <a href="OPEN-COM.html">OPEN COM</a> serial communications port for program input or output.</p>

<h2 id="syntax">Syntax</h2>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td><a href="OPEN.html">OPEN</a> fileName$ [<strong>FOR</strong> mode] [{ACCESS</td>
        <td>{LOCK</td>
        <td>SHARED}} [{READ</td>
        <td>WRITE}] <a href="AS.html">AS</a> [#]fileNumber&amp; [LEN = recordLength]</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h3 id="legacy-gw-basic-syntax">Legacy <em>GW-BASIC</em> syntax</h3>

<blockquote>
  <p><a href="OPEN.html">OPEN</a> modeLetter$, [#]fileNumber&amp;, fileName$[, recordLength]</p>
</blockquote>

<h2 id="parameters">Parameter(s)</h2>

<ul>
  <li>The fileName$ is a <a href="STRING.html">STRING</a> variable or literal file name (path optional) in quotes.</li>
  <li>FOR mode can be: <a href="APPEND.html">APPEND</a> (write to end), <a href="BINARY.html">BINARY</a> (read/write), <a href="INPUT-(file-mode).html">INPUT (file mode)</a> (read), <a href="OUTPUT.html">OUTPUT</a> (write new) or <a href="RANDOM.html">RANDOM</a> (read/write).</li>
  <li>GW-BASIC’s modeLetter$ is a <a href="STRING.html">STRING</a> variable or the letter “A”, “B”, “I”, “O” or “R” designating the OPEN modes above.</li>
  <li>fileNumber&amp; can be any <strong>positive</strong> <a href="INTEGER.html">INTEGER</a> or <a href="LONG.html">LONG</a> whole number value or an unused value determined by the <a href="FREEFILE.html">FREEFILE</a> function.</li>
  <li><a href="LEN.html">LEN</a> = or recordLength is optional to denote the RANDOM file record byte length (default = 128) or sequential (default = 512) load buffer.</li>
</ul>

<h2 id="description">Description</h2>

<ul>
  <li><strong>QB64</strong> can open as many files as your computer memory can handle. QBasic could only open about 15 at a time.</li>
  <li><strong>QB64 will allocate 4 bytes of memory for every possible file number up to the highest number used in a program.</strong></li>
  <li>mode defaults to RANDOM if the mode or FOR access statement is omitted. (see open modes described below)</li>
  <li><strong>Only the fileName$, fileNumber&amp; and LEN = recordLength values can use variable values in the QBasic syntax.</strong></li>
  <li>If <a href="LEN.html">LEN</a> = is ommitted, sequential file record sizes default to 512 and <a href="RANDOM.html">RANDOM</a> to 128 bytes in QBasic.</li>
  <li>fileName$ can be up to 255 characters with no limit on file name extension length in <strong>QB64</strong>.</li>
  <li>Once a file or port is opened, it can be used in any program procedure using the assigned file number.</li>
  <li>The <strong>“SCRN:”</strong> device is supported in <strong>version 1.000 and up</strong> (see Example 3).</li>
  <li><strong>Devices such as “KYBD:”, “CONS:”, and “LPTn:” are <a href="Keywords-currently-not-supported-by-QB64.html">Keywords currently not supported by QB64</a></strong>.
    <blockquote>
      <p><strong>Note:</strong> OPEN “LPTn” is not supported by QB64, but may be supported directly by your operating system.</p>
    </blockquote>
  </li>
  <li><a href="OPEN-COM.html">OPEN COM</a> can also be used for serial port access in <strong>QB64</strong>.</li>
</ul>

<h2 id="errors">Error(s)</h2>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Illegal <strong>QB64</strong> Windows filename characters are ** “ * / \</td>
          <td>? : &lt; &gt; **. Multiple dots (periods) are allowed.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Possible OPEN <a href="ERROR-Codes.html">ERROR Codes</a> include “Bad file name or number”, “Bad File Mode”, “File Not Found” or “Path Not Found”.
    <ul>
      <li>An OPEN file not found error may occur if <a href="CHR%24.html">CHR$</a>(0) to (31) are used in a Windows file name.</li>
    </ul>
  </li>
  <li><strong>QB64</strong> does not have DOS file name limitations.</li>
</ul>

<h2 id="details">Details</h2>

<h3 id="file-access-and-lock-permissions">File ACCESS and LOCK Permissions</h3>

<ul>
  <li><a href="ACCESS.html">ACCESS</a> clause limits file access to READ, WRITE or READ WRITE on a network.</li>
  <li><a href="LOCK-(access).html">LOCK (access)</a> clause can specify SHARED or a LOCK READ or LOCK WRITE file lock in an OPEN statement working on a network.</li>
  <li>A separate <a href="LOCK.html">LOCK</a> statement can lock or <a href="UNLOCK.html">UNLOCK</a> file access on a network using a format that can lock specific records.</li>
  <li>If another process already has access to a specified file, program access is denied for that file OPEN access. A “Permission Denied” error 70 will be returned. A network program must be able to handle a denial of access error.</li>
</ul>

<h3 id="file-access-modes">File Access Modes</h3>

<ul>
  <li>FOR mode can be:
    <ul>
      <li><strong>OUTPUT</strong>: Sequential mode creates a new file or erases an existing file for new program output. Use <a href="WRITE-(file-statement).html">WRITE (file statement)</a> to write numerical or text data or <a href="PRINT-(file-statement).html">PRINT (file statement)</a> for text. <strong>OUTPUT clears files of all data</strong> and clears the receive buffer on other devices such as COM ports.</li>
      <li><strong>APPEND</strong>: Sequential mode creates a new file if it doesn’t exist or appends program output to the end of an existing file. Use <a href="WRITE-(file-statement).html">WRITE (file statement)</a> for numerical or text data or <a href="PRINT-(file-statement).html">PRINT (file statement)</a> for text as in the OUTPUT mode. <strong>APPEND does not remove previous data.</strong></li>
      <li><strong>INPUT</strong> : Sequential mode <strong>only reads input</strong> from an existing file. <strong><a href="ERROR-Codes.html">ERROR Codes</a> if file does not exist.</strong> Use <a href="INPUT-(file-statement).html">INPUT (file statement)</a> for comma separated numerical or text data and <a href="LINE-INPUT-(file-statement).html">LINE INPUT (file statement)</a> or <a href="INPUT%24.html">INPUT$</a> to only read text data. <strong>Use <a href="_FILEEXISTS.html">_FILEEXISTS</a> or <a href="_DIREXISTS.html">_DIREXISTS</a> to avoid errors.</strong></li>
      <li><strong>BINARY</strong>: Creates a new file when it doesn’t exist or reads and writes to an existing binary file. Use <a href="GET.html">GET</a> to read or <a href="PUT.html">PUT</a> to write byte positions simultaneously. <a href="LEN.html">LEN</a> = statements are ignored in this mode.</li>
      <li><strong>RANDOM</strong>: Creates a new file when it doesn’t exist or reads or writes to an existing random file record. Use <a href="GET.html">GET</a> or <a href="PUT.html">PUT</a> to read or write to file records. A <a href="LEN.html">LEN</a> = statement can define the byte size of a record (no LEN statement defaults to 128 bytes)</li>
      <li>Modes <strong>INPUT</strong>, <strong>BINARY</strong> and <strong>RANDOM</strong> allow a file to be concurrently opened in a different mode and number.</li>
    </ul>
  </li>
</ul>

<h4 id="gw-basic-modes">GW-BASIC modes</h4>

<ul>
  <li>
    <p><em>Mode letter</em> is a variable or literal <a href="STRING.html">STRING</a> letter value as one of the following:</p>
  </li>
  <li>“A” = <strong>APPEND</strong>.</li>
  <li>“B” = <strong>BINARY</strong>.</li>
  <li>“I” = <strong>INPUT</strong>.</li>
  <li>“O” = <strong>OUTPUT</strong>.</li>
  <li>“R” = <strong>RANDOM</strong>.</li>
</ul>

<h2 id="examples">Example(s)</h2>

<p>Function that displays errors and the number of errors in QBasic filenames. Returns 0 when filename is OK.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
 <span class="n">file$</span> <span class="o">=</span> <span class="s">"Hello,~1.mp3"</span>      <span class="c1">'example call below</span>
 <span class="n">LOCATE</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span> <span class="n">errors%</span> <span class="o">=</span> <span class="n">CheckName</span><span class="err">%</span><span class="p">(</span><span class="n">file$</span><span class="p">):</span> <span class="n">COLOR</span> <span class="mi">14</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"  Total Errors ="</span><span class="err">;</span> <span class="n">errors%</span> 

<span class="n">FUNCTION</span> <span class="n">CheckName</span><span class="err">%</span> <span class="p">(</span><span class="n">Filename</span><span class="err">$</span><span class="p">)</span>
  <span class="c1">'NOTE: Function also displays filename errors so LOCATE on screen before call!</span>
  <span class="n">DIM</span> <span class="n">L</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">DP</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">XL</span> <span class="n">AS</span> <span class="n">INTEGER</span>
  <span class="n">L</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">Filename</span><span class="err">$</span><span class="p">):</span> <span class="n">DP</span> <span class="o">=</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">Filename</span><span class="err">$</span><span class="p">,</span> <span class="s">"."</span><span class="p">):</span> <span class="n">IF</span> <span class="n">DP</span> <span class="n">THEN</span> <span class="n">XL</span> <span class="o">=</span> <span class="n">L</span> <span class="o">-</span> <span class="n">DP</span> <span class="c1">'extension</span>
  <span class="n">IF</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">OR</span> <span class="n">L</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="n">OR</span> <span class="n">DP</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="n">OR</span> <span class="n">XL</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="n">THEN</span> 
    <span class="n">CheckName</span><span class="err">%</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">COLOR</span> <span class="mi">12</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Illegal format!"</span><span class="err">;</span> <span class="p">:</span> <span class="n">EXIT</span> <span class="n">FUNCTION</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">FOR</span> <span class="n">i%</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">TO</span> <span class="n">L</span>      <span class="c1">'check each filename character"</span>
     <span class="n">code%</span> <span class="o">=</span> <span class="n">ASC</span><span class="p">(</span><span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">Filename</span><span class="err">$</span><span class="p">,</span> <span class="n">i%</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span> <span class="n">COLOR</span> <span class="mi">10</span>      <span class="c1">' see ASCII codes</span>
     <span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">code%</span>       <span class="c1">'check for errors and highlight in red</span>
	<span class="c1">'CASE 34, 42 TO 44, 47, 58 TO 63, 91 TO 93, 124: E% = E% + 1: COLOR 12 ' **QBasic errors**</span>
        <span class="n">CASE</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">124</span><span class="p">:</span> <span class="n">E</span><span class="err">%</span> <span class="o">=</span> <span class="n">E</span><span class="err">%</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">COLOR</span> <span class="mi">12</span> <span class="c1">' **QB64 errors**</span>
        <span class="n">CASE</span> <span class="mi">46</span><span class="p">:</span> <span class="n">dot%</span> <span class="o">=</span> <span class="n">dot%</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">IF</span> <span class="n">dot%</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="n">THEN</span> <span class="n">E</span><span class="err">%</span> <span class="o">=</span> <span class="n">E</span><span class="err">%</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">COLOR</span> <span class="mi">12</span>
     <span class="n">END</span> <span class="n">SELECT</span>     
     <span class="n">PRINT</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="n">code%</span><span class="p">)</span><span class="err">;</span>  <span class="c1">'use LOCATE before FUNCTION call to place print</span>
  <span class="n">NEXT</span>  
  <span class="n">CheckName</span><span class="err">%</span> <span class="o">=</span> <span class="n">E</span><span class="err">%</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>

<p>*Note: The QBasic character error list is commented out and the function will return invalid filenames under QB64.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                         Hello,~1.mp3  Total Errors&lt;nowiki&gt; = &lt;/nowiki&gt;1

</code></pre></div></div>

<blockquote>
  <p><em>Note:</em> The screen output displays filename characters in green except for red comma QBasic error.</p>
</blockquote>

<p>When <strong>OPEN “SCRN:” FOR OUTPUT AS #f</strong> is used, <strong>PRINT #f</strong> will print the text to the screen instead of to a file:</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">f%</span> <span class="o">=</span> <span class="n">FREEFILE</span> <span class="c1">'should always be 1 at program start</span>
<span class="n">OPEN</span> <span class="s">"SCRN:"</span> <span class="n">FOR</span> <span class="n">OUTPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="n">f%</span>
<span class="n">g%</span> <span class="o">=</span> <span class="n">FREEFILE</span> <span class="c1">'should always be 2 after 1</span>
<span class="n">OPEN</span> <span class="s">"temp.txt"</span> <span class="n">FOR</span> <span class="n">OUTPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="n">g%</span>

<span class="n">FOR</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">TO</span> <span class="mi">2</span>
    <span class="n">PRINT</span> <span class="p">#</span><span class="n">i</span><span class="p">,</span> <span class="s">"Hello World, Screen and File version"</span>
<span class="n">NEXT</span> 

</code></pre></div></div>

<blockquote>
  <p><em>Note:</em> Linux or Mac file names can use a path destination such as “.\SCRN:” to use SCRN: as an actual file name.</p>
</blockquote>

<p>Showcasing different file modes.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CLS</span>

<span class="n">OPEN</span> <span class="s">"test.tst"</span> <span class="n">FOR</span> <span class="n">OUTPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="mi">1</span>
<span class="n">PRINT</span> <span class="p">#</span><span class="mi">1</span><span class="p">,</span> <span class="s">"If test.tst didn't exist:"</span>
<span class="n">PRINT</span> <span class="p">#</span><span class="mi">1</span><span class="p">,</span> <span class="s">"A new file was created named test.tst and then deleted."</span>
<span class="n">PRINT</span> <span class="p">#</span><span class="mi">1</span><span class="p">,</span> <span class="s">"If test.tst did exist:"</span>
<span class="n">PRINT</span> <span class="p">#</span><span class="mi">1</span><span class="p">,</span> <span class="s">"It was overwritten with this and deleted."</span>
<span class="n">CLOSE</span> <span class="p">#</span><span class="mi">1</span>

<span class="n">OPEN</span> <span class="s">"test.tst"</span> <span class="n">FOR</span> <span class="n">INPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="mi">1</span>
<span class="n">DO</span> <span class="n">UNTIL</span> <span class="n">EOF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">INPUT</span> <span class="p">#</span><span class="mi">1</span><span class="p">,</span> <span class="n">a$</span>
<span class="n">PRINT</span> <span class="n">a$</span>
<span class="n">LOOP</span>
<span class="n">CLOSE</span> <span class="p">#</span><span class="mi">1</span>

<span class="n">KILL</span> <span class="s">"test.tst"</span>

<span class="n">END</span>

</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
If test.tst didn't exist:
A new file was created named test.tst and then deleted.
If test.tst did exist:
It was overwritten with this and deleted.

</code></pre></div></div>

<blockquote>
  <p><strong>Warning:</strong> Make sure you don’t have a file named test.tst before you run this or it will be overwritten.</p>
</blockquote>

<h2 id="see-also">See Also</h2>

<ul>
  <li><a href="PRINT-(file-statement).html">PRINT (file statement)</a>, <a href="INPUT-(file-statement).html">INPUT (file statement)</a></li>
  <li><a href="GET.html">GET</a>, <a href="PUT.html">PUT</a>, <a href="WRITE-(file-statement).html">WRITE (file statement)</a></li>
  <li><a href="INPUT%24.html">INPUT$</a>, <a href="LINE-INPUT-(file-statement).html">LINE INPUT (file statement)</a></li>
  <li><a href="CLOSE.html">CLOSE</a>, <a href="LOF.html">LOF</a>, <a href="EOF.html">EOF</a>, <a href="LOC.html">LOC</a></li>
  <li><a href="SEEK-(statement).html">SEEK (statement)</a>, <a href="SEEK.html">SEEK</a></li>
  <li><a href="OPEN-COM.html">OPEN COM</a>, <a href="LEN.html">LEN</a>, <a href="RESET.html">RESET</a></li>
  <li><a href="FIELD.html">FIELD</a>, <a href="TYPE.html">TYPE</a></li>
  <li><a href="_FILEEXISTS.html">_FILEEXISTS</a>, <a href="_DIREXISTS.html">_DIREXISTS</a></li>
  <li><a href="_OPENCLIENT.html">_OPENCLIENT</a>, <a href="_OPENHOST.html">_OPENHOST</a>, <a href="_OPENCONNECTION.html">_OPENCONNECTION</a> (TCP/IP)</li>
  <li><a href="_SNDOPEN.html">_SNDOPEN</a>, <a href="_LOADIMAGE.html">_LOADIMAGE</a></li>
</ul>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">QB64.com maintained by <a href="https://github.com/DualBrain">Cory Smith</a> on <a href="https://github.com/DualBrain/QB64">GitHub</a>.</p>
        
        <p>Published with <a href="https://pages.github.com/">GitHub Pages</a></p>
      </footer>
    </div>
  </body>

<!-- Mirrored from qb64.com/wiki/OPEN by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:14:48 GMT -->
</html>