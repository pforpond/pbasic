<!DOCTYPE html>
<html lang="en-US">

  
<!-- Mirrored from qb64.com/wiki/ON-ERROR.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:44:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.html">
    <link rel="stylesheet" type="text/css" media="screen" href="../assets/css/style2443.css?v=eb9b8c9cad488bd1304035e1bfc5d2e89b0f78df">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>QB64.com | QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="QB64.com" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<meta property="og:description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<link rel="canonical" href="ON-ERROR-2.html" />
<meta property="og:url" content="ON-ERROR-2.html" />
<meta property="og:site_name" content="QB64.com" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="QB64.com" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.","headline":"QB64.com","url":"https://qb64.com/wiki/ON-ERROR.html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
            <!--<a id="forkme_banner" href="https://github.com/DualBrain/QB64">View on GitHub</a>-->
          

          <h1 id="project_title">QB64.com</h1>
          <h2 id="project_tagline">QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><a href="ON-ERROR.html">ON ERROR</a> is used with <a href="GOTO.html">GOTO</a> to handle errors in a program.</p>

<h2 id="syntax">Syntax</h2>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td><a href="ON-ERROR.html">ON ERROR</a> <a href="GOTO.html">GOTO</a> {<em>lineNumber</em></td>
        <td><em>lineLabel</em>}</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h2 id="description">Description</h2>

<ul>
  <li>An <em>untreated error</em> in a program will cause execution to stop and an error message is displayed to the user, who can choose to continue (ignore the error - which could have unexpected results) or end the program.</li>
  <li>Use <a href="ON-ERROR.html">ON ERROR</a> when your program performs operations that are likely to generate errors, like file access operations.</li>
  <li><a href="ON-ERROR.html">ON ERROR</a> statements can be in the main module code or in <a href="SUB.html">SUB</a> or <a href="FUNCTION.html">FUNCTION</a> procedures.</li>
  <li><a href="ON-ERROR.html">ON ERROR</a> statements take precedence in the order they are encountered. It will also handle any subroutine errors.</li>
  <li><strong>ON ERROR GOTO 0</strong> can be used to disable custom <a href="ON-ERROR.html">ON ERROR</a> trapping and give default error messages.</li>
  <li>A subsequent ON ERROR statement will override the previous one.</li>
  <li><a href="GOTO.html">GOTO</a> is required in the statement. Cannot use <a href="GOSUB.html">GOSUB</a>.</li>
  <li>Comment out <a href="ON-ERROR.html">ON ERROR</a> to find specific error locations. QB64 can return the file line position with <a href="_ERRORLINE.html">_ERRORLINE</a></li>
  <li>Note: QB64 does not support the PDS (QuickBASIC 7) <strong>ON ERROR RESUME NEXT</strong> statement.</li>
</ul>

<h2 id="examples">Example(s)</h2>

<p>Using an error handler that ignores any error.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
 <span class="n">ON</span> <span class="n">ERROR</span> <span class="n">GOTO</span> <span class="n">Errhandler</span>
   <span class="c1">' Main module program error simulation code</span>
 <span class="n">ERROR</span> <span class="mi">7</span>           <span class="c1">' simulate an Out of Memory Error</span>
 <span class="n">PRINT</span> <span class="s">"Error handled...ending program"</span>
 <span class="n">SLEEP</span> <span class="mi">4</span>
 <span class="n">SYSTEM</span>            <span class="c1">' end of program code</span>

 <span class="n">Errhandler</span><span class="p">:</span>              <span class="c1">'error handler sub program line label</span>
  <span class="n">PRINT</span> <span class="s">"Error"</span><span class="err">;</span> <span class="n">ERR</span><span class="err">;</span> <span class="s">"on program file line"</span><span class="err">;</span> <span class="n">_ERRORLINE</span>
  <span class="n">BEEP</span>             <span class="c1">' warning beep</span>
 <span class="n">RESUME</span> <span class="n">NEXT</span>       <span class="c1">' moves program to code following the error. </span>

</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Error 7 on program file line 3 
Error handled...ending program

</code></pre></div></div>

<blockquote>
  <p><em>Explanation:</em> The ON ERROR statement is normally placed at the beginning of the main module code.  Errhandle is the line label sub referred to in the statement. The handler prints the error code and attempts to use the next line of code using <a href="RESUME.html">RESUME</a> NEXT which is only used in error handling procedures. <a href="_ERRORLINE.html">_ERRORLINE</a> returns the program file’s actual text line count found in the IDE.</p>
</blockquote>

<p>Using an error handler in a <a href="SUB.html">SUB</a> procedure.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">s</span>
<span class="n">END</span>

<span class="n">hand</span><span class="p">:</span>
<span class="n">PRINT</span> <span class="s">"got error!"</span>
<span class="n">RESUME</span> <span class="n">NEXT</span>

<span class="n">SUB</span> <span class="n">s</span>
<span class="n">ON</span> <span class="n">ERROR</span> <span class="n">GOTO</span> <span class="n">hand</span>
<span class="n">ERROR</span> <span class="mi">1</span>
<span class="n">ON</span> <span class="n">ERROR</span> <span class="n">GOTO</span> <span class="mi">0</span>
<span class="n">PRINT</span> <span class="s">"Done!"</span>
<span class="n">END</span> <span class="n">SUB</span> 

</code></pre></div></div>

<blockquote>
  <p><em>Explanation:</em> The <a href="GOTO.html">GOTO</a> procedure must be in the main code area after <a href="END.html">END</a> to avoid a <a href="RESUME.html">RESUME</a> error later. Use GOTO 0 to clear the ON ERROR set in the sub so that later errors are not handled by it.</p>
</blockquote>

<h2 id="see-also">See Also</h2>

<ul>
  <li><a href="ERR.html">ERR</a>, <a href="ERL.html">ERL</a>, <a href="RESUME.html">RESUME</a></li>
  <li><a href="ON..-2.html">ON…GOTO</a></li>
  <li><a href="_ERRORLINE.html">_ERRORLINE</a>, <a href="_INCLERRORLINE.html">_INCLERRORLINE</a>, <a href="_INCLERRORFILE%24.html">_INCLERRORFILE$</a>, <a href="_ERRORMESSAGE%24.html">_ERRORMESSAGE$</a></li>
  <li><a href="ERROR.html">ERROR</a> (simulates an error)</li>
  <li><a href="ERROR-Codes.html">ERROR Codes</a></li>
</ul>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">QB64.com maintained by <a href="https://github.com/DualBrain">Cory Smith</a> on <a href="https://github.com/DualBrain/QB64">GitHub</a>.</p>
        
        <p>Published with <a href="https://pages.github.com/">GitHub Pages</a></p>
      </footer>
    </div>
  </body>

<!-- Mirrored from qb64.com/wiki/ON-ERROR.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:44:35 GMT -->
</html>