<!DOCTYPE html>
<html lang="en-US">

  
<!-- Mirrored from qb64.com/wiki/FILELIST$-(function) by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:44:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.html">
    <link rel="stylesheet" type="text/css" media="screen" href="../assets/css/style2443.css?v=eb9b8c9cad488bd1304035e1bfc5d2e89b0f78df">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>QB64.com | QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="QB64.com" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<meta property="og:description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<link rel="canonical" href="FILELIST%24-(function)-2.html" />
<meta property="og:url" content="FILELIST%24-(function)-2.html" />
<meta property="og:site_name" content="QB64.com" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="QB64.com" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.","headline":"QB64.com","url":"https://qb64.com/wiki/FILELIST$-(function).html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
            <!--<a id="forkme_banner" href="https://github.com/DualBrain/QB64">View on GitHub</a>-->
          

          <h1 id="project_title">QB64.com</h1>
          <h2 id="project_tagline">QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>The <strong>FILELIST$</strong> function can be used in place of the old QBasic <a href="FILES.html">FILES</a> statement to view a list of files. Displays long and short(8.3) DOS filenames with the last modified information. Function name returns the short filename while <strong>SHARED</strong> string variables <strong>LFN$</strong> and <strong>Path$</strong> return the long name and absolute path from the current root drive. The leading underscore should make it compatible with most older QBasic program code run in <strong>QB64</strong>. The function allows mouse click file selection, letter press searches, file name exist verification without a screen display, and many of the DIR options available in DOS. Including sorting by name, extension, attributes and more! <strong>Your program screens are not changed after a display and the function can be integrated into a program using Putimage!</strong></p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                             **FILELIST$ Function Features**

        1) **Only displays a file list when necessary.** Otherwise one or no files found
           work "silently". Can be used to check if a file exists without an error!

        2) **Completely restores the program screen after a file list display!** It is
           not necessary to create a new screen like you did after FILES. See Demo.

        3) Users can jump to the leading filename letter by pressing a letter key.

        4) Selection of files is done by a mouse click anywhere on a filename row.
           Clicking near the bottom or keypress can advance to the next page list.
          
        5) Does not require ***.***! Press Enter to display all files in current folder. 
           No program typing errors! Just press Enter after a valid path for list! 

        6) If it doesn't find a file, it returns a 0 length string. **NO FILE ERRORS!**
           Just check for empty or zero length string returns in your program.

        7) Includes various filename options for sorting as described below the code.

        8) To view the current sub-directories, use Spec$ = **"/A:D"** in any lettercase.
       
        9) Update: Display now **highlights** the mouse selection rows for clarity. Also
           Displays the present search path. Option **/S** will search all sub-directories.
           The file's actual **Path$** will be returned even if it was not displayed!

       10) The newest version sets up the entire process using two position parameters
           so that it can be viewed on your program screen area. See **[FILELIST$](FILELIST$)**

</code></pre></div></div>

<p><strong><a href="http://i301.photobucket.com/albums/nn53/burger2227/FILE-ss2.jpg">Screenshot</a></strong></p>

<p><strong>The function is NOT a QB64 authorized function!</strong> This program code is free to use in your programs! No claims are made as to the suitability of the code and the user is responsible for any damages. You are free to alter the code as you see fit.</p>

<p><strong>NOTE: IF <a href="%24STATIC.html">$STATIC</a> Metacommand is required, change function Arrays to <a href="STATIC.html">STATIC</a> and <a href="ERASE.html">ERASE</a> them at start and every loop!</strong></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">_TITLE</span> <span class="s">"Demo of FILELIST$ Function by Ted Weissgerber 2010"</span>
<span class="n">handle&amp;</span> <span class="o">=</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span> <span class="c1">'Demo code creates custom sized screen mode</span>
<span class="n">SCREEN</span> <span class="n">handle&amp;</span>
<span class="n">Align</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">"SUPER "</span> <span class="o">+</span> <span class="n">QQ</span><span class="err">$</span><span class="p">(</span><span class="s">"FILELIST$"</span><span class="p">)</span> <span class="o">+</span> <span class="s">" SEARCH"</span>
<span class="n">Align</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">"The FILELIST$ function locates files from any input. Enter or "</span> <span class="o">+</span> <span class="n">QQ</span><span class="err">$</span><span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="o">+</span> <span class="s">" same as "</span> <span class="o">+</span> <span class="n">QQ</span><span class="err">$</span><span class="p">(</span><span class="s">"*.*"</span><span class="p">)</span>
<span class="n">Align</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s">"Shared variables Path$ and LFN$ return path and long name if available."</span>
<span class="n">DO</span>
  <span class="n">LOCATE</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span> <span class="c1">'entry below can enclose file names in quotes</span>
  <span class="n">LINEPUT</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">"Enter a filename Search spec: "</span><span class="p">,</span> <span class="n">spec$</span>
  <span class="n">IF</span> <span class="n">UCASE</span><span class="err">$</span><span class="p">(</span><span class="n">spec$</span><span class="p">)</span> <span class="o">=</span> <span class="s">"END"</span> <span class="n">THEN</span> <span class="n">EXIT</span> <span class="n">DO</span>
  <span class="n">filename$</span> <span class="o">=</span> <span class="n">FILELIST</span><span class="err">$</span><span class="p">(</span><span class="n">spec$</span><span class="p">)</span>
  <span class="n">LOCATE</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>
  <span class="n">Align</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">filename$</span>
  <span class="n">LOCATE</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
  <span class="n">Align</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">Path</span><span class="err">$</span> <span class="o">+</span> <span class="n">spec$</span>
  <span class="n">Align</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="s">"Note that your "</span> <span class="o">+</span> <span class="n">QQ</span><span class="err">$</span><span class="p">(</span><span class="s">"spec$"</span><span class="p">)</span> <span class="o">+</span> <span class="s">" also returns the selected file name."</span>
  <span class="n">LOCATE</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
  <span class="n">Align</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s">"LFN$ = "</span> <span class="o">+</span> <span class="n">LFN</span><span class="err">$</span> <span class="o">+</span> <span class="s">" LEN ="</span> <span class="o">+</span> <span class="n">STR</span><span class="err">$</span><span class="p">(</span><span class="n">LEN</span><span class="p">(</span><span class="n">LFN</span><span class="err">$</span><span class="p">))</span>
  <span class="n">Align</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s">"Enter "</span> <span class="o">+</span> <span class="n">QQ</span><span class="err">$</span><span class="p">(</span><span class="s">"END"</span><span class="p">)</span> <span class="o">+</span> <span class="s">" to quit"</span>
<span class="n">LOOP</span>
<span class="n">SYSTEM</span>
<span class="c1">'----------------------------- End of Demo Code -------------------------------</span>

<span class="n">SUB</span> <span class="n">Align</span> <span class="p">(</span><span class="n">c0l0r%</span><span class="p">,</span> <span class="n">Tr0w</span><span class="err">%</span><span class="p">,</span> <span class="n">t3xt$</span><span class="p">)</span> <span class="c1">'auto centers printed text</span>
<span class="n">Tc0l</span><span class="err">%</span> <span class="o">=</span> <span class="p">(</span><span class="n">_WIDTH</span> <span class="o">\</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">LEN</span><span class="p">(</span><span class="n">t3xt$</span><span class="p">)</span> <span class="o">\</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Tc0l</span><span class="err">%</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">Tc0l</span><span class="err">%</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">COLOR</span> <span class="n">c0l0r%</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="n">Tr0w</span><span class="err">%</span><span class="p">,</span> <span class="n">Tc0l</span><span class="err">%</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">t3xt$</span><span class="err">;</span>
<span class="n">END</span> <span class="n">SUB</span>

<span class="n">SUB</span> <span class="n">LINEPUT</span> <span class="p">(</span><span class="n">c0l0r%</span><span class="p">,</span> <span class="n">Tr0w</span><span class="err">%</span><span class="p">,</span> <span class="n">t3xt$</span><span class="p">,</span> <span class="n">r3turn$</span><span class="p">)</span>
<span class="c1">'Auto centering LINE INPUT entry allows quotation marks around filenames with spaces</span>
<span class="n">Tc0l</span><span class="err">%</span> <span class="o">=</span> <span class="p">((</span><span class="n">_WIDTH</span> <span class="o">\</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">LEN</span><span class="p">(</span><span class="n">t3xt$</span><span class="p">)</span> <span class="o">\</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Tc0l</span><span class="err">%</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">Tc0l</span><span class="err">%</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">COLOR</span> <span class="n">c0l0r%</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="n">Tr0w</span><span class="err">%</span><span class="p">,</span> <span class="n">Tc0l</span><span class="err">%</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">t3xt$</span><span class="err">;</span>
<span class="n">LINE</span> <span class="n">INPUT</span> <span class="err">;</span> <span class="s">""</span><span class="p">,</span> <span class="n">r3turn$</span> <span class="c1">'semicolon in case bottom 2 rows</span>
<span class="n">END</span> <span class="n">SUB</span>

<span class="n">FUNCTION</span> <span class="n">QQ</span><span class="err">$</span> <span class="p">(</span><span class="n">t3xt$</span><span class="p">)</span> <span class="c1">'Quote unQuote text in quotes</span>
<span class="n">QQ</span><span class="err">$</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="o">+</span> <span class="n">t3xt$</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="c1">' &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Place INCLUDE file reference here when used as library &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>

</code></pre></div></div>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'****** NOTE: FILELIST$ Function can also be included as an external library(see below) ******</span>

<span class="n">FUNCTION</span> <span class="n">FILELIST</span><span class="err">$</span> <span class="p">(</span><span class="n">Spec</span><span class="err">$</span><span class="p">)</span>
<span class="n">SHARED</span> <span class="n">Path</span><span class="err">$</span><span class="p">,</span> <span class="n">LFN</span><span class="err">$</span> <span class="c1">'values also accessable by main program</span>
<span class="n">REDIM</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">Paths</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c1">'&lt;&lt;&lt; $DYNAMIC only</span>
<span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">ENVIRON</span><span class="err">$</span><span class="p">(</span><span class="s">"OS"</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">EXIT</span> <span class="n">FUNCTION</span> <span class="c1">'DIR X cannot be used on Win 9X</span>
<span class="n">f%</span> <span class="o">=</span> <span class="n">FREEFILE</span>
<span class="n">SHELL</span> <span class="n">_HIDE</span> <span class="s">"CD &gt; D0S-DATA.INF"</span> <span class="c1">'********************** Optional TITLE &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="n">OPEN</span> <span class="s">"D0S-DATA.INF"</span> <span class="n">FOR</span> <span class="n">INPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="n">f%</span>
<span class="n">LINE</span> <span class="n">INPUT</span> <span class="p">#</span><span class="n">f%</span><span class="p">,</span> <span class="n">current$</span>
<span class="n">CLOSE</span> <span class="p">#</span><span class="n">f%</span> <span class="c1">' ******************************************** END TITLE(see _TITLE below)</span>
<span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="n">UCASE</span><span class="err">$</span><span class="p">(</span><span class="n">LTRIM</span><span class="err">$</span><span class="p">(</span><span class="n">RTRIM</span><span class="err">$</span><span class="p">(</span><span class="n">Spec</span><span class="err">$</span><span class="p">)))</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">Spec</span><span class="err">$</span><span class="p">,</span> <span class="s">"/A:D"</span><span class="p">)</span> <span class="n">OR</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">Spec</span><span class="err">$</span><span class="p">,</span> <span class="s">"/O:G"</span><span class="p">)</span> <span class="n">THEN</span>
  <span class="n">DL</span><span class="err">$</span> <span class="o">=</span> <span class="s">"DIR"</span><span class="p">:</span> <span class="n">BS</span><span class="err">$</span> <span class="o">=</span> <span class="s">"\"</span> <span class="c1">'directory searches only</span>
<span class="n">ELSE</span><span class="p">:</span> <span class="n">DL</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="n">BS</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">mode&amp;</span> <span class="o">=</span> <span class="n">_COPYIMAGE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">'save previous screen value to restore if files displayed.</span>
<span class="c1">' Get Specific file information if available</span>
<span class="n">SHELL</span> <span class="n">_HIDE</span> <span class="s">"cmd /c dir "</span> <span class="o">+</span> <span class="n">Spec</span><span class="err">$</span> <span class="o">+</span> <span class="s">" /X &gt; D0S-DATA.INF"</span> <span class="c1">'get data</span>
<span class="n">Head</span><span class="err">$</span> <span class="o">=</span> <span class="s">"      Short Name          Long Name                     Last Modified     "</span>
<span class="n">tmp$</span> <span class="o">=</span> <span class="s">" \ \  \          \   \                              \ \                  \"</span>
<span class="n">OPEN</span> <span class="s">"D0S-DATA.INF"</span> <span class="n">FOR</span> <span class="n">INPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="n">f%</span> <span class="c1">'read the data file</span>
<span class="n">DO</span> <span class="n">UNTIL</span> <span class="n">EOF</span><span class="p">(</span><span class="n">f%</span><span class="p">)</span>
  <span class="n">LINE</span> <span class="n">INPUT</span> <span class="p">#</span><span class="n">f%</span><span class="p">,</span> <span class="n">line$</span>
  <span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="s">":\"</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">Path</span><span class="err">$</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="s">":\"</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">IF</span> <span class="n">RIGHT</span><span class="err">$</span><span class="p">(</span><span class="n">Path</span><span class="err">$</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="s">"\"</span> <span class="n">THEN</span> <span class="n">Path</span><span class="err">$</span> <span class="o">=</span> <span class="n">Path</span><span class="err">$</span> <span class="o">+</span> <span class="s">"\"</span>
    <span class="n">setcode%</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">filecode%</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">line$</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">25</span> <span class="n">AND</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="s">" "</span> <span class="n">THEN</span> <span class="c1">'don't read other info</span>
    <span class="n">IF</span> <span class="n">format%</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span>
      <span class="n">IF</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"M"</span> <span class="n">OR</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="s">"&lt;"</span><span class="p">)</span> <span class="o">=</span> <span class="mi">25</span> <span class="n">THEN</span>
        <span class="n">Sst</span><span class="err">%</span> <span class="o">=</span> <span class="mi">40</span><span class="p">:</span> <span class="n">Lst</span><span class="err">%</span> <span class="o">=</span> <span class="mi">53</span><span class="p">:</span> <span class="n">Dst</span><span class="err">%</span> <span class="o">=</span> <span class="mi">26</span><span class="p">:</span> <span class="n">format%</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">' XP</span>
      <span class="n">ELSE</span><span class="p">:</span> <span class="n">Sst</span><span class="err">%</span> <span class="o">=</span> <span class="mi">37</span><span class="p">:</span> <span class="n">Lst</span><span class="err">%</span> <span class="o">=</span> <span class="mi">50</span><span class="p">:</span> <span class="n">Dst</span><span class="err">%</span> <span class="o">=</span> <span class="mi">23</span><span class="p">:</span> <span class="n">format%</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">'VISTA</span>
      <span class="n">END</span> <span class="n">IF</span>
    <span class="n">END</span> <span class="n">IF</span>
    <span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">line$</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">Lst</span><span class="err">%</span> <span class="n">THEN</span> <span class="n">filecode%</span> <span class="o">=</span> <span class="n">ASC</span><span class="p">(</span><span class="n">UCASE</span><span class="err">$</span><span class="p">(</span><span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="n">Lst</span><span class="err">%</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span> <span class="n">ELSE</span> <span class="n">filecode%</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">D1R</span><span class="err">$</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="n">Dst</span><span class="err">%</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">'returns directories only with Spec$ = "/A:D" or "/O:G"</span>
    <span class="n">IF</span> <span class="n">D1R</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="s">"DIR"</span> <span class="n">THEN</span> <span class="n">D1R</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">'change if anything else</span>
    <span class="n">IF</span> <span class="n">D1R</span><span class="err">$</span> <span class="o">=</span> <span class="n">DL</span><span class="err">$</span> <span class="n">AND</span> <span class="n">filecode%</span> <span class="o">&gt;=</span> <span class="n">setcode%</span> <span class="n">THEN</span>
      <span class="n">cnt%</span> <span class="o">=</span> <span class="n">cnt%</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="n">D1R</span><span class="err">$</span><span class="p">:</span> <span class="n">Paths</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="n">Path</span><span class="err">$</span>
      <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
      <span class="n">IF</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="n">Sst</span><span class="err">%</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">THEN</span>
        <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="n">Sst</span><span class="err">%</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">Sst</span><span class="err">%</span><span class="p">,</span> <span class="n">line$</span><span class="p">,</span> <span class="s">" "</span><span class="p">)</span> <span class="o">-</span> <span class="n">Sst</span><span class="err">%</span><span class="p">)</span>
        <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="n">Lst</span><span class="err">%</span><span class="p">)</span>
      <span class="n">ELSE</span><span class="p">:</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">line$</span><span class="p">,</span> <span class="n">Lst</span><span class="err">%</span><span class="p">):</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span>
      <span class="n">END</span> <span class="n">IF</span>
      <span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">Spec</span><span class="err">$</span><span class="p">)</span> <span class="n">AND</span> <span class="p">(</span><span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="n">UCASE</span><span class="err">$</span><span class="p">(</span><span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">))</span> <span class="n">OR</span> <span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="n">UCASE</span><span class="err">$</span><span class="p">(</span><span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)))</span> <span class="n">THEN</span>
        <span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">+</span> <span class="n">BS</span><span class="err">$</span><span class="p">:</span> <span class="n">FILELIST</span><span class="err">$</span> <span class="o">=</span> <span class="n">Spec</span><span class="err">$</span><span class="p">:</span> <span class="n">LFN</span><span class="err">$</span> <span class="o">=</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">+</span> <span class="n">BS</span><span class="err">$</span>
        <span class="n">noshow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">GOSUB</span> <span class="n">KILLdata</span> <span class="c1">' verifies file exist query (no display)</span>
      <span class="n">END</span> <span class="n">IF</span>
      <span class="n">IF</span> <span class="n">page%</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="c1">' pages after first</span>
        <span class="n">IF</span> <span class="n">cnt%</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">THEN</span> <span class="n">GOSUB</span> <span class="n">NewScreen</span>
        <span class="n">COLOR</span> <span class="mi">11</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">USING</span> <span class="n">tmp$</span><span class="err">;</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span><span class="err">;</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span><span class="err">;</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span><span class="err">;</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span>
        <span class="n">IF</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="s">"DIR"</span> <span class="n">AND</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"."</span> <span class="n">THEN</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span>
      <span class="n">ELSE</span> <span class="c1">'first page = 0</span>
        <span class="n">IF</span> <span class="n">cnt%</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">THEN</span> <span class="c1">'only display to screen if 2 or more files are found</span>
          <span class="n">FList</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
          <span class="n">SCREEN</span> <span class="n">FList</span><span class="o">&amp;</span><span class="p">:</span> <span class="n">_TITLE</span> <span class="n">current$</span><span class="p">:</span> <span class="n">GOSUB</span> <span class="n">NewScreen</span> <span class="c1">'********* Optional TITLE &lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
          <span class="n">COLOR</span> <span class="mi">11</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">USING</span> <span class="n">tmp$</span><span class="err">;</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">;</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">;</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="err">;</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
          <span class="n">_DISPLAY</span>
          <span class="n">IF</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"DIR"</span> <span class="n">AND</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"."</span> <span class="n">THEN</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">END</span> <span class="n">IF</span>
        <span class="n">IF</span> <span class="n">cnt%</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="n">THEN</span>
          <span class="n">COLOR</span> <span class="mi">11</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">USING</span> <span class="n">tmp$</span><span class="err">;</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span><span class="err">;</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span><span class="err">;</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span><span class="err">;</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span>
          <span class="n">IF</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="s">"DIR"</span> <span class="n">AND</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"."</span> <span class="n">THEN</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">cnt%</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">END</span> <span class="n">IF</span>
      <span class="n">END</span> <span class="n">IF</span> <span class="c1">'page%</span>
      <span class="n">IF</span> <span class="n">cnt%</span> <span class="n">MOD</span> <span class="mi">25</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="c1">'each page holds 25 file names</span>
        <span class="n">COLOR</span> <span class="mi">14</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Select file or click here for next."</span><span class="err">;</span> <span class="c1">'&lt;&lt;&lt;&lt; Prompt text can be changed</span>
        <span class="n">GOSUB</span> <span class="n">pickfile</span>
        <span class="n">page%</span> <span class="o">=</span> <span class="n">page%</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">cnt%</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">REDIM</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">Paths</span><span class="err">$</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c1">'&lt;&lt;&lt; $DYNAMIC only</span>
      <span class="n">END</span> <span class="n">IF</span> <span class="c1">'mod  25</span>
    <span class="n">END</span> <span class="n">IF</span> <span class="c1">'DIR = DL$</span>
  <span class="n">END</span> <span class="n">IF</span> <span class="c1">'len line$ &gt; 25</span>
<span class="n">LOOP</span>
<span class="n">CLOSE</span> <span class="p">#</span><span class="n">f%</span>
<span class="n">last</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">total%</span> <span class="o">=</span> <span class="n">cnt%</span> <span class="o">+</span> <span class="p">(</span><span class="n">page%</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">total%</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">FILELIST</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">LFN</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">noshow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">GOSUB</span> <span class="n">KILLdata</span><span class="p">:</span> <span class="c1">'no files(no display)</span>
<span class="n">IF</span> <span class="n">total%</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">THEN</span>   <span class="c1">'one file(no display)</span>
  <span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">BS</span><span class="err">$</span><span class="p">:</span> <span class="n">FILELIST</span><span class="err">$</span> <span class="o">=</span> <span class="n">Spec</span><span class="err">$</span><span class="p">:</span> <span class="n">LFN</span><span class="err">$</span> <span class="o">=</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">BS</span><span class="err">$</span><span class="p">:</span> <span class="n">noshow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">GOSUB</span> <span class="n">KILLdata</span> 
<span class="n">END</span> <span class="n">IF</span>
<span class="n">IF</span> <span class="n">DL</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">THEN</span>
  <span class="n">COLOR</span> <span class="mi">10</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">65</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">total%</span><span class="err">;</span> <span class="s">"Files"</span>
<span class="n">ELSE</span><span class="p">:</span> <span class="n">COLOR</span> <span class="mi">10</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">65</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">total%</span><span class="err">;</span> <span class="s">"Folders"</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">COLOR</span> <span class="mi">14</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Select file or click here to Exit. "</span><span class="err">;</span> <span class="c1">'&lt;&lt;&lt; Prompt text can be changed</span>
<span class="n">pickfile</span><span class="p">:</span>
<span class="n">_DEST</span> <span class="n">FList</span><span class="o">&amp;</span>
<span class="n">ShowPath</span><span class="err">$</span> <span class="o">=</span> <span class="n">RIGHT</span><span class="err">$</span><span class="p">(</span><span class="n">Path</span><span class="err">$</span><span class="p">,</span> <span class="mi">78</span><span class="p">)</span>
<span class="n">COLOR</span> <span class="mi">15</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">41</span> <span class="o">-</span> <span class="p">(</span><span class="n">LEN</span><span class="p">(</span><span class="n">ShowPath</span><span class="err">$</span><span class="p">)</span> <span class="o">\</span> <span class="mi">2</span><span class="p">):</span> <span class="n">PRINT</span> <span class="n">ShowPath</span><span class="err">$;</span>
<span class="n">_DISPLAY</span>
<span class="n">DO</span><span class="p">:</span> <span class="n">Key</span><span class="err">$</span> <span class="o">=</span> <span class="n">UCASE</span><span class="err">$</span><span class="p">(</span><span class="n">INKEY</span><span class="err">$</span><span class="p">):</span> <span class="n">_LIMIT</span> <span class="mi">30</span>
  <span class="n">DO</span> <span class="n">WHILE</span> <span class="n">_MOUSEINPUT</span>
    <span class="n">Tcol</span><span class="err">%</span> <span class="o">=</span> <span class="p">((</span><span class="n">_MOUSEX</span> <span class="o">-</span> <span class="n">xpos%</span><span class="p">)</span> <span class="o">\</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">'mouse column with Putimage offset</span>
    <span class="n">Trow</span><span class="err">%</span> <span class="o">=</span> <span class="p">((</span><span class="n">_MOUSEY</span> <span class="o">-</span> <span class="n">ypos%</span><span class="p">)</span> <span class="o">\</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">'mouse row with offset</span>
    <span class="n">Pick</span> <span class="o">=</span> <span class="n">_MOUSEBUTTON</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">' get left button selection click</span>
  <span class="n">LOOP</span>
  <span class="n">IF</span> <span class="n">Trow</span><span class="err">%</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="n">AND</span> <span class="n">Trow</span><span class="err">%</span> <span class="o">&lt;</span> <span class="n">cnt%</span> <span class="o">+</span> <span class="mi">3</span> <span class="n">AND</span> <span class="n">Tcol</span><span class="err">%</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">AND</span> <span class="n">Tcol</span><span class="err">%</span> <span class="o">&lt;</span> <span class="mi">80</span> <span class="n">THEN</span> <span class="c1">'when mouse in area</span>
    <span class="n">R</span><span class="err">%</span> <span class="o">=</span> <span class="n">Trow</span><span class="err">%</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">IF</span> <span class="n">P</span><span class="err">%</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">OR</span> <span class="n">P</span><span class="err">%</span> <span class="o">&gt;</span> <span class="n">cnt%</span> <span class="o">+</span> <span class="mi">3</span> <span class="n">THEN</span> <span class="n">P</span><span class="err">%</span> <span class="o">=</span> <span class="n">R</span><span class="err">%</span>
    <span class="n">IF</span> <span class="n">P</span><span class="err">%</span> <span class="o">=</span> <span class="n">R</span><span class="err">%</span> <span class="n">THEN</span>
      <span class="n">COLOR</span> <span class="mi">15</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="n">R</span><span class="err">%</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">USING</span> <span class="n">tmp$</span><span class="err">;</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span>
    <span class="n">ELSE</span>
      <span class="n">COLOR</span> <span class="mi">11</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="n">P</span><span class="err">%</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">USING</span> <span class="n">tmp$</span><span class="err">;</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">P</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">P</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">P</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="n">P</span><span class="err">%</span><span class="p">)</span>
    <span class="n">END</span> <span class="n">IF</span>
    <span class="n">_DISPLAY</span>
    <span class="n">P</span><span class="err">%</span> <span class="o">=</span> <span class="n">R</span><span class="err">%</span>
    <span class="n">IF</span> <span class="n">Pick</span> <span class="n">THEN</span>
      <span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span>
      <span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">Spec</span><span class="err">$</span><span class="p">)</span> <span class="n">THEN</span>
        <span class="n">COLOR</span> <span class="mi">13</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="n">R</span><span class="err">%</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">USING</span> <span class="n">tmp$</span><span class="err">;</span> <span class="n">DIR</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">SHFN</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span><span class="err">;</span> <span class="n">Last</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span>
        <span class="n">_DISPLAY</span>
        <span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="n">Spec</span><span class="err">$</span> <span class="o">+</span> <span class="n">BS</span><span class="err">$</span><span class="p">:</span> <span class="n">FILELIST</span><span class="err">$</span> <span class="o">=</span> <span class="n">Spec</span><span class="err">$</span><span class="p">:</span> <span class="n">Path</span><span class="err">$</span> <span class="o">=</span> <span class="n">Paths</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span>
        <span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">))</span> <span class="n">THEN</span> <span class="n">LFN</span><span class="err">$</span> <span class="o">=</span> <span class="n">LGFN</span><span class="err">$</span><span class="p">(</span><span class="n">R</span><span class="err">%</span><span class="p">)</span> <span class="o">+</span> <span class="n">BS</span><span class="err">$</span> <span class="n">ELSE</span> <span class="n">LFN</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">_DELAY</span> <span class="mf">1.5</span><span class="p">:</span> <span class="n">CLS</span><span class="p">:</span> <span class="n">SCREEN</span> <span class="n">mode&amp;</span><span class="p">:</span> <span class="n">GOSUB</span> <span class="n">KILLdata</span> <span class="c1">'exit if user selection</span>
      <span class="n">END</span> <span class="n">IF</span>
    <span class="n">END</span> <span class="n">IF</span> <span class="c1">'len spec</span>
  <span class="n">END</span> <span class="n">IF</span> <span class="c1">'pick</span>
  <span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">Key</span><span class="err">$</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">usercode%</span> <span class="o">=</span> <span class="n">ASC</span><span class="p">(</span><span class="n">Key</span><span class="err">$</span><span class="p">)</span> <span class="n">ELSE</span> <span class="n">usercode%</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">IF</span> <span class="n">usercode%</span> <span class="o">&gt;</span> <span class="n">setcode%</span> <span class="n">THEN</span> <span class="n">setcode%</span> <span class="o">=</span> <span class="n">usercode%</span> <span class="c1">'user can press letter to jump to</span>
  <span class="n">IF</span> <span class="n">Pick</span> <span class="n">AND</span> <span class="n">Trow</span><span class="err">%</span> <span class="o">&gt;</span> <span class="mi">27</span> <span class="n">THEN</span> <span class="n">EXIT</span> <span class="n">DO</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">LEN</span><span class="p">(</span><span class="n">Key</span><span class="err">$</span><span class="p">)</span>
<span class="n">_DELAY</span> <span class="p">.</span><span class="err">4</span> <span class="c1">'adjust delay for page scroll speed</span>
<span class="n">DO</span><span class="p">:</span> <span class="n">Key</span><span class="err">$</span> <span class="o">=</span> <span class="n">INKEY</span><span class="err">$</span><span class="p">:</span> <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">Key</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">IF</span> <span class="n">last</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">RETURN</span> <span class="c1">'exit if file no more data</span>
<span class="n">FILELIST</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">Spec</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span><span class="p">:</span> <span class="n">LFN</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">CLS</span><span class="p">:</span> <span class="n">SCREEN</span> <span class="n">mode&amp;</span> <span class="c1">'resets program screen to previous condition</span>
<span class="n">KILLdata</span><span class="p">:</span>
<span class="n">CLOSE</span> <span class="p">#</span><span class="n">f%</span><span class="p">:</span> <span class="n">KILL</span> <span class="s">"D0S-DATA.INF"</span> <span class="c1">'kill D0S-DATA.INF file and exit</span>
<span class="n">IF</span> <span class="n">FList</span><span class="o">&amp;</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="n">THEN</span> <span class="n">_FREEIMAGE</span> <span class="n">FList</span><span class="o">&amp;</span>
<span class="n">IF</span> <span class="n">noshow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="n">AND</span> <span class="n">mode&amp;</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="n">THEN</span> <span class="n">_FREEIMAGE</span> <span class="n">mode&amp;</span>
<span class="n">_AUTODISPLAY</span> <span class="c1">'reset default settings</span>
<span class="n">EXIT</span> <span class="n">FUNCTION</span>
<span class="n">RETURN</span>
<span class="n">NewScreen</span><span class="p">:</span> <span class="c1">'clear screen and set display format</span>
<span class="n">LINE</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">639</span><span class="p">,</span> <span class="mi">499</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">BF</span>
<span class="n">COLOR</span> <span class="mi">14</span><span class="p">:</span> <span class="n">LOCATE</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">Head</span><span class="err">$</span>
<span class="n">LINE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">636</span><span class="p">,</span> <span class="mi">476</span><span class="p">),</span> <span class="mi">13</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="n">LINE</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">635</span><span class="p">,</span> <span class="mi">475</span><span class="p">),</span> <span class="mi">13</span><span class="p">,</span> <span class="n">B</span>
<span class="n">RETURN</span>
<span class="n">END</span> <span class="n">FUNCTION</span> <span class="o">*</span> <span class="o">*</span>      

</code></pre></div></div>

<p>Updated for VISTA screen format 8/20/2010.</p>

<p>Updated for programs using $DYNAMIC Metacommand 9/16/2010.</p>

<p>Added option for current path to TITLE bar 11/16/2010</p>

<p><strong><a href="http://i301.photobucket.com/albums/nn53/burger2227/FILE-ss2.jpg">Function Screenshot</a></strong></p>

<p><strong>CREATING A FILELIST$ $INCLUDE LIBRARY</strong></p>

<p>The Function can be also be added to any program as a text library by saving it as a text BI file!</p>

<p>Just <a href="%24INCLUDE.html">$INCLUDE</a> the BI text file (grey area above) at the end of your program AFTER the SUB procedures.</p>

<p>To create a <strong>BI</strong> file use Notepad or another text editor, copy code in grey area  and Save as <strong>ALL FILES</strong> using <em>anyname.BI</em></p>

<p>**NOTE: Once the program is compiled, the BI file is no longer needed with the stand alone EXE program!</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                     **FILELIST$(Spec$) OPTIONS** (/X already used!)
Syntax: 
                         
FILELIST$([drive:][path][filename][/A[:]attrib](:]attrib)[/L][/O[:]sortorder](:]sortorder)[/S][/T[:]timefield](:]timefield))

 NOTE: When path is specified, that path is returned to the SHARED Path$ variable. 

               The FILELIST$ function can use the following options:

             **/A** List by attribute. Syntax: /A:attribute 
                      :D Directories (use /A:D after any path or by itself)
                      :R Read-only files 
                      :H Hidden files 
                      :A Files ready for archiving 
                      :S System files 
                     - Prefix means not 

             **/L** Use lowercase.

             **/O** List of files in sorted order. Syntax: /O:sortorder
                      :N By name (alphabetical is default) 
                      :S By size (smallest first) 
                      :E By extension (alphabetical) 
                      :D By date/time (oldest first) 
                      :G Group directories only (/O:G)
                      - Prefix to reverse order 

             NOTE: Alphabetical keypress is disabled when using /O.

             **/S** Searches all directory and subdirectory files

             **/T** Time field displayed or used for sorting. Syntax: /T:timefield         
                      :A Last Access 
                      :C Creation 
                      :W Last Written 

   DIR commands that don't work: /B, /C, /D, /N, /P, /Q, and /W. (/X already used) 
            
               These options return nothing or do not change a search!

    **To Search filenames with spaces, add CHR$(34) quote to each side of the spec file name!**

                   filename$ = FILELIST$(CHR$(34) + Spec$ + CHR$(34))


 **NOTE: [LINE INPUT](LINE-INPUT) allows quoted entries such as: "free cell.ico" for filenames with spaces.**

</code></pre></div></div>

<p><strong>FILELIST$ Function can also be displayed on your program screen with Putimage!</strong></p>

<p>First use Flist&amp; as the source in: _PUTIMAGE , Flist&amp;, newimagepage&amp;
Then Putimage again at a position on screen larger than 640 X 480 to display
 _DEST main&amp;: _PUTIMAGE (x, y), newimagepage&amp; 
Where DEST main&amp; is the main program screen. Add the code to the function.</p>

<p><strong><a href="FILELIST%24.html">FILELIST$</a></strong></p>

<blockquote>
  <p><em>NOTE:</em> The data file name D0S-DATA.INF uses a zero instead of an O in D0S and is deleted after a search!</p>
</blockquote>

<h2 id="see-also">See Also</h2>

<ul>
  <li><a href="FILES.html">FILES</a>, <a href="SHELL.html">SHELL</a></li>
  <li><a href="_HIDE.html">_HIDE</a>, <a href="_COPYIMAGE.html">_COPYIMAGE</a>, <a href="_PUTIMAGE.html">_PUTIMAGE</a></li>
  <li><a href="%24INCLUDE.html">$INCLUDE</a> (<a href="Metacommand.html">Metacommand</a>)</li>
</ul>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">QB64.com maintained by <a href="https://github.com/DualBrain">Cory Smith</a> on <a href="https://github.com/DualBrain/QB64">GitHub</a>.</p>
        
        <p>Published with <a href="https://pages.github.com/">GitHub Pages</a></p>
      </footer>
    </div>
  </body>

<!-- Mirrored from qb64.com/wiki/FILELIST$-(function) by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:44:43 GMT -->
</html>