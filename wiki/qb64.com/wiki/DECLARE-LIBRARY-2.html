<!DOCTYPE html>
<html lang="en-US">

  
<!-- Mirrored from qb64.com/wiki/DECLARE-LIBRARY.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:43:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.html">
    <link rel="stylesheet" type="text/css" media="screen" href="../assets/css/style2443.css?v=eb9b8c9cad488bd1304035e1bfc5d2e89b0f78df">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>QB64.com | QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="QB64.com" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<meta property="og:description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<link rel="canonical" href="DECLARE-LIBRARY-2.html" />
<meta property="og:url" content="DECLARE-LIBRARY-2.html" />
<meta property="og:site_name" content="QB64.com" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="QB64.com" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.","headline":"QB64.com","url":"https://qb64.com/wiki/DECLARE-LIBRARY.html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
            <!--<a id="forkme_banner" href="https://github.com/DualBrain/QB64">View on GitHub</a>-->
          

          <h1 id="project_title">QB64.com</h1>
          <h2 id="project_tagline">QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>The <strong>DECLARE LIBRARY</strong> declaration allows the use of external library <a href="SUB.html">SUB</a> and <a href="FUNCTION.html">FUNCTION</a> procedures supported by QB64.</p>

<h2 id="syntax">Syntax</h2>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td><strong>DECLARE</strong> [DYNAMIC</td>
        <td>CUSTOMTYPE</td>
        <td>STATIC] <strong>LIBRARY</strong> [{<em>“Library_filename”</em></td>
        <td><em>“Headerfile”</em>}]</td>
      </tr>
    </tbody>
  </table>

  <table>
    <tbody>
      <tr>
        <td>{<a href="SUB.html">SUB</a></td>
        <td><a href="FUNCTION.html">FUNCTION</a>} [<em>procedure_name</em> ALIAS] <em>library_procedure</em> ([BYVAL] <em>parameter AS</em>, …)</td>
      </tr>
    </tbody>
  </table>

  <p>… ‘other SUBs or Functions as required</p>

  <p><strong>END DECLARE</strong></p>
</blockquote>

<h2 id="parameters">Parameter(s)</h2>

<ul>
  <li>The Library_filename is needed if a Library is not already loaded by QB64. Do not include the <em>.DLL</em>, <em>LIB</em> or <em>.H</em> file extension.</li>
  <li>It’s always a good idea to try declaring Windows API libraries without a Library_filename first, as most Windows headers are already included in QB64 source.</li>
  <li>Begin the Library_filename with <strong>./</strong> or <em>*.*</em> to make it relative to the path where your source file is saved, so you can keep all your project files together.</li>
  <li>Procedure_name is any program procedure name you want to designate by using <a href="ALIAS.html">ALIAS</a> with the Library_procedure name.</li>
  <li>Library procedure is the actual procedure name used inside of the library or header file.</li>
</ul>

<h3 id="library-types">Library Types</h3>

<ul>
  <li><strong><a href="DECLARE-DYNAMIC-LIBRARY.html">DECLARE DYNAMIC LIBRARY</a></strong> links a program to functions in dynamically linkable libraries. At present, only .DLL files are supported</li>
  <li><strong>CUSTOMTYPE</strong> is already implied when using <a href="DECLARE-DYNAMIC-LIBRARY.html">DECLARE DYNAMIC LIBRARY</a>. This type of library just allows the same flexibility to apply when referencing STATIC libraries that are used to refer to dynamic libraries. Supports shared object (*.so) libraries.</li>
  <li><strong>STATIC</strong> is the same as <a href="DECLARE-LIBRARY.html">DECLARE LIBRARY</a> except that it prioritizes linking to static libraries (<em>.a/</em>.o) over shared object (*.so) libraries, if both exist. As Windows doesn’t use shared libraries (DLLs are different) this does not affect Windows users.</li>
</ul>

<h2 id="description">Description</h2>

<ul>
  <li>The declaration can be used with C++ sub-procedures, Windows API and QB64 SDL (versions prior to 1.000)/OpenGL (version 1.000 and up) Libraries.</li>
  <li><em>Library filename</em>s can be listed to combine more than one DLL or Header file name or path into one DECLARE LIBRARY block.</li>
  <li>C procedures can use a header file name. File code must be included with program code. Do not include the <em>.h</em> extension.</li>
  <li><em>Parameters</em> used by the Library procedure must be passed by value (<a href="BYVAL.html">BYVAL</a>) except for <a href="STRING.html">STRING</a> characters.</li>
  <li>
    <p>When using a procedure from an <strong>unsupported</strong> Dynamic Link Library (DLL file) use <a href="DECLARE-DYNAMIC-LIBRARY.html">DECLARE DYNAMIC LIBRARY</a>.</p>
  </li>
  <li>The <a href="_OFFSET.html">_OFFSET</a> in memory can be used in <strong>CUSTOMTYPE</strong>, <strong>STATIC</strong> and <strong>DYNAMIC LIBRARY</strong> declarations.</li>
  <li>Declarations can be made inside of <a href="SUB.html">SUB</a> or <a href="FUNCTION.html">FUNCTION</a> procedures. Declarations do not need to be at program start.</li>
  <li><strong>NOTE: It is up to the user to document and determine the suitability of all Libraries and procedures they choose to use! QB64 cannot guarantee that any procedure will work and cannot guarantee any troubleshooting help.</strong></li>
</ul>

<h2 id="examples">Example(s)</h2>

<p>Using an <strong>SDL</strong> library procedure as a program SUB procedure to move the mouse pointer to a coordinate (works in versions prior to 1.000):</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="n">SUB</span> <span class="n">SDL_WarpMouse</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">column</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">row</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span> <span class="c1">'SDL procedure name</span>
<span class="n">END</span> <span class="n">DECLARE</span>
<span class="n">SCREEN</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>  <span class="c1">'simulate screen 12 with 256 colors</span>
<span class="n">RANDOMIZE</span> <span class="n">TIMER</span>

<span class="n">DO</span>
  <span class="n">_DELAY</span> <span class="mi">1</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">RND</span> <span class="o">*</span> <span class="mi">640</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">RND</span> <span class="o">*</span> <span class="mi">480</span>
  <span class="n">LINE</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">STEP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">RND</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">32</span><span class="p">,</span> <span class="n">BF</span>
  <span class="n">MouseMove</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">5</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">LEN</span><span class="p">(</span><span class="n">INKEY</span><span class="err">$</span><span class="p">)</span>  <span class="c1">'any keypress quits</span>
<span class="n">END</span>

<span class="n">SUB</span> <span class="n">MouseMove</span> <span class="p">(</span><span class="n">x</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">y</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">SDL_WarpMouse</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>     <span class="c1">'call SDL library procedure</span>
<span class="n">END</span> <span class="n">SUB</span> 

</code></pre></div></div>

<blockquote>
  <p><em>Explanation:</em> The SDL Library is included and loaded with QB64 versions prior to 1.000, so these procedures are directly available for use.</p>
</blockquote>

<p><strong>Using <a href="ALIAS.html">ALIAS</a> to create a program SUB or FUNCTION</strong> using <strong>QB64 SDL ONLY</strong></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">SCREEN</span> <span class="mi">12</span>
<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="n">SUB</span> <span class="n">MouseMove</span> <span class="n">ALIAS</span> <span class="n">SDL_WarpMouse</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">column&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">row&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">_DELAY</span> <span class="mi">2</span>
<span class="n">MouseMove</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">_DELAY</span> <span class="mi">2</span>
<span class="n">MouseMove</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span> 

</code></pre></div></div>

<blockquote>
  <p><em>Explanation:</em> When a Library procedure is used to represent another procedure name use <a href="ALIAS.html">ALIAS</a> instead. Saves creating a SUB!</p>
</blockquote>

<p>Don’t know if a C function is defined by C++ or QB64? Try using empty quotes.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">LIBRARY</span> <span class="s">""</span>
    <span class="n">FUNCTION</span> <span class="n">addone&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">value&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span> 

</code></pre></div></div>

<blockquote>
  <p><em>Explanation:</em> The C function ‘addone’ exists in a library QB64 already links to, but it hasn’t been defined as a C function or a QB64 function. By using “” we are telling QB64 the function exists in a library which is already linked to and that it must define the C function before calling it, as well as allowing QB64 code to call it. Trying the above code without the “” will fail.</p>
</blockquote>

<blockquote>
  <p><strong>Note: Which libraries are or aren’t automatically used in the linking process is not formally defined, nor is it guaranteed to stay that way in future versions of QB64.</strong></p>
</blockquote>

<p><strong>QB64 version 1.000 and up produce standalone executables. External DLL files must be distributed with your program.</strong></p>

<h2 id="see-also">See Also</h2>

<ul>
  <li><a href="DECLARE-DYNAMIC-LIBRARY.html">DECLARE DYNAMIC LIBRARY</a></li>
  <li><a href="SUB.html">SUB</a>, <a href="FUNCTION.html">FUNCTION</a></li>
  <li><a href="BYVAL.html">BYVAL</a>, <a href="ALIAS.html">ALIAS</a></li>
  <li><a href="C-Libraries.html">C Libraries</a>, <a href="DLL-Libraries.html">DLL Libraries</a>, <a href="Windows-Libraries.html">Windows Libraries</a></li>
  <li><a href="Port-Access-Libraries.html">Port Access Libraries</a></li>
  <li><a href="SQL-Client.html">SQL Client</a></li>
</ul>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">QB64.com maintained by <a href="https://github.com/DualBrain">Cory Smith</a> on <a href="https://github.com/DualBrain/QB64">GitHub</a>.</p>
        
        <p>Published with <a href="https://pages.github.com/">GitHub Pages</a></p>
      </footer>
    </div>
  </body>

<!-- Mirrored from qb64.com/wiki/DECLARE-LIBRARY.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:43:32 GMT -->
</html>