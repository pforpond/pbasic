<!DOCTYPE html>
<html lang="en-US">

  
<!-- Mirrored from qb64.com/wiki/Windows-Libraries by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:43:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.html">
    <link rel="stylesheet" type="text/css" media="screen" href="../assets/css/style2443.css?v=eb9b8c9cad488bd1304035e1bfc5d2e89b0f78df">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>QB64.com | QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="QB64.com" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<meta property="og:description" content="QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS." />
<link rel="canonical" href="Windows-Libraries-2.html" />
<meta property="og:url" content="Windows-Libraries-2.html" />
<meta property="og:site_name" content="QB64.com" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="QB64.com" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.","headline":"QB64.com","url":"https://qb64.com/wiki/Windows-Libraries.html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
            <!--<a id="forkme_banner" href="https://github.com/DualBrain/QB64">View on GitHub</a>-->
          

          <h1 id="project_title">QB64.com</h1>
          <h2 id="project_tagline">QB64 is a modern extended BASIC programming language that retains QBasic/QuickBASIC 4.5 compatibility and compiles native binaries for Windows, Linux, and macOS.</h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>QB64 can support the <strong>specific Windows Operating System Libraries</strong> on your PC. They should be located in the <strong>System32</strong> folder. Use <a href="DECLARE-LIBRARY.html">DECLARE LIBRARY</a> with the appropriate <a href="ALIAS.html">ALIAS</a>. Loaded DLL files are NOT required to be named in the Declaration!</p>

<p><strong>Note: C++ Header files should be placed in the QB64 folder and are not required after a program is compiled.</strong></p>

<p><strong>Note: QB64 requires all DLL files to either be with the program or in the C:\WINDOWS\SYSTEM32 folder!</strong></p>

<p>Maximum Windows path: MAX_PATH = drive letter + “:" + 256 + CHR$(0) = 260 characters.</p>

<p><strong>Your code contribution using the Windows Libraries could end up here!</strong></p>

<p>## <strong>Table of Contents</strong></p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1 <a href="#Computer-datetime">Computer Date/Time</a></td>
      <td>10 <a href="#Focus">Focus</a></td>
      <td>19 <a href="#Open-another-Program">Open another Program</a></td>
      <td>28 <a href="#Window-Focus">Window Focus</a></td>
    </tr>
    <tr>
      <td>2 <a href="#Borderless-Window">Borderless Window</a></td>
      <td>11 <a href="#Folder-Dialog-Box">Folder Dialog Box</a></td>
      <td>20 <a href="#Play-WAV-Sounds">Play WAV Sounds</a></td>
      <td>29 <a href="#Windows-Menu">Windows Menu</a></td>
    </tr>
    <tr>
      <td>3 <a href="#Color-Dialog-Box">Color Dialog Box</a></td>
      <td>12 <a href="#Font-Dialog-Box">Font Dialog Box</a></td>
      <td>21 <a href="#Run-One-Instance">Run One Instance</a></td>
      <td>30 <a href="#Windows-Notification">Windows Notification</a></td>
    </tr>
    <tr>
      <td>4 <a href="#Desktop-Size">Desktop Size</a></td>
      <td>13 <a href="#Registered-Fonts">Registered Fonts</a></td>
      <td>22 <a href="#Send-Keys">Send Keys</a></td>
      <td>31 <a href="#Windows-Ports">Windows Ports</a></td>
    </tr>
    <tr>
      <td>5 <a href="#Directory-Environment">Directory Environment</a></td>
      <td>14 <a href="#Game-Pad">Game Pad</a></td>
      <td>23 <a href="#System-Metrics">System Metrics</a></td>
      <td>32 <a href="#Windows-Sounds">Windows Sounds</a></td>
    </tr>
    <tr>
      <td>6 <a href="#Disk-Drives">Disk Drives</a></td>
      <td>15 <a href="#Hot-Keys-maximize">Hot Keys (maximize)</a></td>
      <td>24 <a href="#Top-Most-Window">Top Most Window</a></td>
      <td>33 <a href="#Window-Transparency">Window Transparency</a></td>
    </tr>
    <tr>
      <td>7 <a href="#File-Attributes">File Attributes</a></td>
      <td>16 <a href="#Keyboard-Lock-Settings">Keyboard Lock Settings</a></td>
      <td>25 <a href="#Video-File-Player">Video File Player</a></td>
      <td>34 <a href="#Windows-User">Windows User</a></td>
    </tr>
    <tr>
      <td>8 <a href="#File-Open-and-Save-Dialog">File Open and Save Dialog</a></td>
      <td>17 <a href="#Message-Box">Message Box</a></td>
      <td>26 <a href="#Web-Page-Download">Web Page Download</a></td>
      <td>35 <a href="#Windows-Version">Windows -Version</a></td>
    </tr>
    <tr>
      <td>9 <a href="#File-Times">File Times</a></td>
      <td>18 <a href="#Mouse-Area">Mouse Area</a></td>
      <td>27 <a href="#Windows-API">Windows API</a></td>
      <td>36 <a href="#Reference">Reference</a></td>
    </tr>
  </tbody>
</table>

<h2 id="windows-api-data-structures"><strong>Windows API Data Structures</strong></h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Bits</th>
      <th>QB64 Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>bit</td>
      <td>8 bits in one byte</td>
      <td>1</td>
      <td><a href="_BIT.html">_BIT</a></td>
    </tr>
    <tr>
      <td>nybble</td>
      <td>2 nybbles in one byte</td>
      <td>4</td>
      <td><a href="_BIT.html">_BIT</a> * 4</td>
    </tr>
    <tr>
      <td>byte</td>
      <td>1 byte (2 nybbles)</td>
      <td>8</td>
      <td><a href="_BYTE.html">_BYTE</a></td>
    </tr>
    <tr>
      <td>Boolean</td>
      <td>1 byte (signed/unsigned)</td>
      <td>8</td>
      <td><a href="_BYTE.html">_BYTE</a></td>
    </tr>
    <tr>
      <td>CharA(FunctA)</td>
      <td><a href="ASCII.html">ASCII</a> character</td>
      <td>8 (<a href="LEN.html">LEN</a>(buffer))</td>
      <td><a href="_BYTE.html">_BYTE</a></td>
    </tr>
    <tr>
      <td>WORD</td>
      <td>2 bytes</td>
      <td>16</td>
      <td><a href="INTEGER.html">INTEGER</a></td>
    </tr>
    <tr>
      <td>CharW(FunctW)</td>
      <td><a href="Unicode.html">Unicode</a> wide character</td>
      <td>16 (<a href="LEN.html">LEN</a>(buffer)\2)</td>
      <td><a href="INTEGER.html">INTEGER</a></td>
    </tr>
    <tr>
      <td>DWORD</td>
      <td>4 bytes</td>
      <td>32</td>
      <td><a href="LONG.html">LONG</a></td>
    </tr>
    <tr>
      <td>QWORD</td>
      <td>8 bytes</td>
      <td>64</td>
      <td><a href="_INTEGER64.html">_INTEGER64</a></td>
    </tr>
    <tr>
      <td>LP or hwnd</td>
      <td>Short or Long Pointer</td>
      <td>ANY <a href="INTEGER.html">INTEGER</a></td>
      <td><a href="_OFFSET.html">_OFFSET</a></td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><strong>NOTE:</strong> ‘<em>Void</em> <em>*</em>’ in C code is also an <a href="_OFFSET.html">_OFFSET</a></p>
</blockquote>

<ul>
  <li>
    <p>See <a href="https://docs.microsoft.com/pt-pt/windows/win32/winprog/windows-data-types?redirectedfrom=MSDN">Windows Data Types</a></p>
  </li>
  <li>
    <p>See <a href="http://doc.pcsoft.fr/en-US/?6510001">Windows 32 API constant values</a></p>
  </li>
</ul>

<h2 id="computer-datetime">Computer Date/Time</h2>

<p><strong>NOTE: You might need to run this program as Administrator</strong></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'#### </span>
<span class="c1">'DATE&amp;TIME.BAS</span>
<span class="c1">'#### </span>

<span class="c1">'A DATE$ and TIME$ alternative.</span>
<span class="c1">'Gets &amp; Sets System DATE &amp; TIME using Windows API.</span>
<span class="c1">'Coded for QB64 by Dav FEB/2012</span>

<span class="c1">'#### #### #### #### #### #### #### #### #### #### #### #### #### #### #### =</span>
<span class="c1">'NOTE: THIS DEMO WILL ATTEMPT TO CHANGE YOUR SYSTEM DATE FOR 5 SECONDS.</span>
<span class="c1">'     AFTER 5 SECONDS IT WILL ATTEMPT TO RESTORE ORIGINAL DATE SETTING.</span>
<span class="c1">'#### #### #### #### #### #### #### #### #### #### #### #### #### #### #### =</span>

<span class="n">TYPE</span> <span class="n">SYSTEMTIME</span>
    <span class="n">wYear</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">wMonth</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">wDayOfWeek</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">wDay</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">wHour</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">wMinute</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">wSecond</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">wMilliseconds</span> <span class="n">AS</span> <span class="n">INTEGER</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"Kernel32"</span>
<span class="c1">'##  NOTE: SetSystemTime&amp; returns Zero if it Fails.</span>
<span class="c1">'##  NOTE: GetSystemTime does not return a value.</span>
    <span class="n">FUNCTION</span> <span class="n">SetSystemTime</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">lpSystemTime</span> <span class="n">AS</span> <span class="n">SYSTEMTIME</span><span class="p">)</span>
    <span class="n">SUB</span> <span class="n">GetSystemTime</span> <span class="p">(</span><span class="n">lpSystemTime</span> <span class="n">AS</span> <span class="n">SYSTEMTIME</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="c1">' Holds current values...</span>
<span class="n">DIM</span> <span class="n">CurrentTime</span> <span class="n">AS</span> <span class="n">SYSTEMTIME</span>

<span class="c1">' For the new values to set...</span>
<span class="n">DIM</span> <span class="n">NewTime</span> <span class="n">AS</span> <span class="n">SYSTEMTIME</span>

<span class="c1">' Get &amp; Show current System Date/Time</span>
<span class="n">GetSystemTime</span> <span class="n">CurrentTime</span>

<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"--------------------------------"</span>
<span class="n">PRINT</span> <span class="s">"Current System DATE &amp; TIME is..."</span>
<span class="n">PRINT</span> <span class="s">"DATE:"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wMonth</span><span class="err">;</span> <span class="s">"-"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wDay</span><span class="err">;</span> <span class="s">"-"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wYear</span>
<span class="n">PRINT</span> <span class="s">"TIME:"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wHour</span><span class="err">;</span> <span class="s">":"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wMinute</span><span class="err">;</span> <span class="s">":"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wSecond</span>
<span class="n">PRINT</span> <span class="s">"--------------------------------"</span>

<span class="c1">'###  Now Set new DATE only</span>
<span class="c1">'###  NOTICE we're using CurrentTime TIME value's '&lt;</span>

<span class="c1">'###  So we're just changing the DATE, not the TIME here...</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wYear</span> <span class="o">=</span> <span class="mi">2011</span>     <span class="c1">'move date back to prevent trial version expiration!</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wMonth</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wDayOfWeek</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wDay</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wHour</span> <span class="o">=</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wHour</span> <span class="c1">'&lt;</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wMinute</span> <span class="o">=</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wMinute</span> <span class="c1">'&lt;</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wSecond</span> <span class="o">=</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wSecond</span> <span class="c1">'&lt;</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wMilliseconds</span> <span class="o">=</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wMilliseconds</span> <span class="c1">'&lt;</span>


<span class="c1">' Set the new values</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SetSystemTime</span><span class="o">&amp;</span><span class="p">(</span><span class="n">NewTime</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Failed to change DATE/TIME!"</span><span class="p">:</span> <span class="n">END</span>

<span class="c1">' Grab new System DATE settings...</span>
<span class="c1">' Temporary holding space...for TIME...</span>
<span class="n">DIM</span> <span class="n">CurrentTime2</span> <span class="n">AS</span> <span class="n">SYSTEMTIME</span>

<span class="n">GetSystemTime</span> <span class="n">CurrentTime2</span>

<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"--------------------------------"</span>
<span class="n">PRINT</span> <span class="s">"Now the NEW System DATE is..."</span>
<span class="n">PRINT</span> <span class="s">"DATE:"</span><span class="err">;</span> <span class="n">CurrentTime2</span><span class="p">.</span><span class="n">wMonth</span><span class="err">;</span> <span class="s">"-"</span><span class="err">;</span> <span class="n">CurrentTime2</span><span class="p">.</span><span class="n">wDay</span><span class="err">;</span> <span class="s">"-"</span><span class="err">;</span> <span class="n">CurrentTime2</span><span class="p">.</span><span class="n">wYear</span>
<span class="n">PRINT</span> <span class="s">"--------------------------------"</span>
<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"Waiting 5 seconds! Check computer date in taskbar....."</span>


<span class="n">SLEEP</span> <span class="mi">5</span>

<span class="c1">'###  Now set everything back to what it was at the beginning.</span>
<span class="c1">'###  Using TIME values from CurrentTime2 so we don't lose any</span>
<span class="c1">'###  seconds from SLEEPing....</span>

<span class="c1">' Grab current values again, keeps the running TIME...</span>
<span class="n">GetSystemTime</span> <span class="n">CurrentTime2</span>

<span class="n">PRINT</span> <span class="s">"Resetting DATE back..."</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wYear</span> <span class="o">=</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wYear</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wMonth</span> <span class="o">=</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wMonth</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wDayOfWeek</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wDay</span> <span class="o">=</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wDay</span>
<span class="n">NewTime</span><span class="p">.</span><span class="n">wHour</span> <span class="o">=</span> <span class="n">CurrentTime2</span><span class="p">.</span><span class="n">wHour</span> <span class="c1">'&lt;</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wMinute</span> <span class="o">=</span> <span class="n">CurrentTime2</span><span class="p">.</span><span class="n">wMinute</span> <span class="c1">'&lt;</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wSecond</span> <span class="o">=</span> <span class="n">CurrentTime2</span><span class="p">.</span><span class="n">wSecond</span> <span class="c1">'&lt;</span>

<span class="n">NewTime</span><span class="p">.</span><span class="n">wMilliseconds</span> <span class="o">=</span> <span class="n">CurrentTime2</span><span class="p">.</span><span class="n">wMilliseconds</span> <span class="c1">'&lt;</span>


<span class="c1">' Set the DATE &amp; TIME values back</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">SetSystemTime</span><span class="o">&amp;</span><span class="p">(</span><span class="n">NewTime</span><span class="p">):</span>
<span class="n">IF</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Failed to change DATE/TIME!"</span><span class="p">:</span> <span class="n">END</span>

<span class="c1">' Now let's get &amp; show Current values, see if it worked...</span>

<span class="n">GetSystemTime</span> <span class="n">CurrentTime</span>

<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"--------------------------------"</span>
<span class="n">PRINT</span> <span class="s">"Now the System DATE &amp; TIME is..."</span>
<span class="n">PRINT</span> <span class="s">"DATE:"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wMonth</span><span class="err">;</span> <span class="s">"-"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wDay</span><span class="err">;</span> <span class="s">"-"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wYear</span>
<span class="n">PRINT</span> <span class="s">"TIME:"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wHour</span><span class="err">;</span> <span class="s">":"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wMinute</span><span class="err">;</span> <span class="s">":"</span><span class="err">;</span> <span class="n">CurrentTime</span><span class="p">.</span><span class="n">wSecond</span>
<span class="n">PRINT</span> <span class="s">"--------------------------------"</span>

<span class="n">END</span> 

</code></pre></div></div>
<p>Code by Dav</p>

<h2 id="borderless-window">Borderless Window</h2>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'### </span>
<span class="c1">'NOBORDER.BAS</span>
<span class="c1">'### </span>

<span class="n">DECLARE</span> <span class="n">CUSTOMTYPE</span> <span class="n">LIBRARY</span>
    <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"User32"</span>
    <span class="n">FUNCTION</span> <span class="n">GetWindowLongA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nIndex</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
    <span class="n">FUNCTION</span> <span class="n">SetWindowLongA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nIndex</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwNewLong</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
    <span class="n">FUNCTION</span> <span class="n">SetWindowPos</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">hWndInsertAfter</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">x</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">y</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cx</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cy</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">wFlags</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">GWL_STYLE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">16</span>
<span class="n">WS_BORDER</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H800000</span>

<span class="n">_TITLE</span> <span class="s">"No Border"</span>
<span class="n">hwnd&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "No Border" + CHR$(0))</span>

<span class="n">PRINT</span> <span class="s">"Press any key for no border..."</span><span class="p">:</span> <span class="n">A</span><span class="err">$</span> <span class="o">=</span> <span class="n">INPUT</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">winstyle&amp;</span> <span class="o">=</span> <span class="n">GetWindowLongA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">,</span> <span class="n">GWL_STYLE</span><span class="p">)</span>
<span class="n">a&amp;</span> <span class="o">=</span> <span class="n">SetWindowLongA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">,</span> <span class="n">GWL_STYLE</span><span class="p">,</span> <span class="n">winstyle&amp;</span> <span class="n">AND</span> <span class="n">NOT</span> <span class="n">WS_BORDER</span><span class="p">)</span>
<span class="n">a&amp;</span> <span class="o">=</span> <span class="n">SetWindowPos</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">39</span><span class="p">)</span>

<span class="n">PRINT</span> <span class="s">"Press any key to get back border..."</span><span class="p">:</span> <span class="n">SLEEP</span>

<span class="n">winstyle&amp;</span> <span class="o">=</span> <span class="n">GetWindowLongA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">,</span> <span class="n">GWL_STYLE</span><span class="p">)</span>
<span class="n">a&amp;</span> <span class="o">=</span> <span class="n">SetWindowLongA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">,</span> <span class="n">GWL_STYLE</span><span class="p">,</span> <span class="n">winstyle&amp;</span> <span class="n">OR</span> <span class="n">WS_BORDER</span><span class="p">)</span>
<span class="n">a&amp;</span> <span class="o">=</span> <span class="n">SetWindowPos</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">39</span><span class="p">)</span>

<span class="n">PRINT</span> <span class="s">"The end"</span> 

</code></pre></div></div>
<p>Code by Dav</p>

<h2 id="color-dialog-box">Color Dialog Box</h2>

<p>The Color Dialog Box can set custom colors and alpha saturation levels.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">' Color Dialog flag constants (use + or OR to use more than 1 flag)</span>
<span class="n">CONST</span> <span class="n">CC_RGBINIT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span><span class="o">&amp;</span> <span class="c1">'           Sets the initial color (don't know how to set it)</span>
<span class="n">CONST</span> <span class="n">CC_FULLOPEN</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span><span class="o">&amp;</span> <span class="c1">'          Opens all dialog sections such as the custom color selector</span>
<span class="n">CONST</span> <span class="n">CC_PREVENTFULLOPEN</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H4</span><span class="o">&amp;</span> <span class="c1">'   Prevents the user from opening the custom color selector</span>
<span class="n">CONST</span> <span class="n">CC_SHOWHELP</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8</span><span class="o">&amp;</span> <span class="c1">'          Shows the help button (USELESS!)</span>
<span class="c1">'----------------------------------------------------------------------------------------</span>
<span class="err">$</span><span class="n">IF</span> <span class="mi">32</span><span class="n">BIT</span> <span class="n">THEN</span> <span class="c1">'                Checking for 32 bit IDE</span>
<span class="n">TYPE</span> <span class="n">COLORDIALOGTYPE</span>
  <span class="n">lStructSize</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'         Length of this TYPE structure</span>
  <span class="n">hwndOwner</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'           Dialog owner's handle</span>
  <span class="n">hInstance</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'           ?</span>
  <span class="n">rgbResult</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'           The RGB color the user selected</span>
  <span class="n">lpCustColors</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'     Pointer to an array of 16 custom colors (will be changed by user)</span>
  <span class="n">flags</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'               Dialog flags</span>
  <span class="n">lCustData</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'           Custom data</span>
  <span class="n">lpfnHook</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'            Hook</span>
  <span class="n">lpTemplateName</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'   Custom template</span>
<span class="n">END</span> <span class="n">TYPE</span>
<span class="err">$</span><span class="n">ELSE</span> <span class="c1">'                         If the IDE is 64 bit then...</span>
<span class="n">TYPE</span> <span class="n">COLORDIALOGTYPE</span>
  <span class="n">lStructSize</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'   Length of this TYPE structure</span>
  <span class="n">hwndOwner</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'     Dialog owner's handle</span>
  <span class="n">hInstance</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'     ?</span>
  <span class="n">rgbResult</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'     The RGB color the user selected</span>
  <span class="n">lpCustColors</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'     Pointer to an array of 16 custom colors (will be changed by user)</span>
  <span class="n">flags</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'         Dialog flags</span>
  <span class="n">lCustData</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'     Custom data</span>
  <span class="n">lpfnHook</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'      Hook</span>
  <span class="n">lpTemplateName</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'   Custom template</span>
<span class="n">END</span> <span class="n">TYPE</span>
<span class="err">$</span><span class="n">END</span> <span class="n">IF</span>

<span class="n">DIM</span> <span class="n">ColorString</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">64</span>
<span class="n">ColorString</span> <span class="o">=</span> <span class="s">"FFFFFFFFFF"</span> <span class="c1">'not sure how this works?</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"comdlg32"</span>
  <span class="n">FUNCTION</span> <span class="n">ChooseColorA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">DIALOGPARAMS</span> <span class="n">AS</span> <span class="n">COLORDIALOGTYPE</span><span class="p">)</span> <span class="c1">'    Yet the also famous color dialog box</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span> <span class="c1">' To get hWnd handle, or use _WINDOWHANDLE</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">SCREEN</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="c1">'32 or 16 or 256 color screen modes</span>
<span class="n">_TITLE</span> <span class="s">"Color Common Dialog demo"</span> <span class="c1">'set Title of program</span>
<span class="n">hWnd&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "Color Common Dialog demo" + CHR$(0)) 'get window handle using _TITLE string</span>

<span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">ChooseColor</span><span class="o">&amp;</span><span class="p">(</span><span class="n">_RGB32</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ColorString</span><span class="err">$</span><span class="p">,</span> <span class="n">Cancel</span><span class="p">,</span> <span class="n">CC_FULLOPEN</span><span class="p">,</span> <span class="n">hWnd&amp;</span><span class="p">)</span>

<span class="n">CLS</span> <span class="p">,</span> <span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span> <span class="c1">'make background chosen color</span>
<span class="n">LOCATE</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">31</span>
<span class="n">IF</span> <span class="n">Cancel</span> <span class="o">&lt;&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="n">THEN</span>
  <span class="n">COLOR</span> <span class="n">_RGB</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="c1">'white text</span>
  <span class="n">PRINT</span> <span class="s">"Color:"</span><span class="err">;</span> <span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span><span class="err">;</span> <span class="s">"&amp;H"</span> <span class="o">+</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span><span class="p">)</span> <span class="c1">'  use last color chosen</span>
  <span class="n">PRINT</span> <span class="n">ColorString</span><span class="err">$</span> <span class="c1">'              display user custom color values chosen</span>
<span class="n">ELSE</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"No color was chosen!"</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span>

<span class="n">FUNCTION</span> <span class="n">ChooseColor</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">InitialColor</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">CustomColors</span><span class="err">$</span><span class="p">,</span> <span class="n">Cancel</span><span class="p">,</span> <span class="n">Flags</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">hWnd&amp;</span><span class="p">)</span>
<span class="c1">' Parameters:</span>
<span class="c1">'  InitialColor&amp;  - The initial color used, will take effect if CC_RGBINIT flag is specified</span>
<span class="c1">'  CustomColors$  - A 64-byte string where the user's custom colors will be stored (4 bytes per color in RGB0 format).</span>
<span class="c1">'  Cancel         - Variable where the cancel flag will be stored.</span>
<span class="c1">'  Flags&amp;         - Dialog flags</span>
<span class="c1">'  hWnd&amp;          - Your program's window handle that should be aquired by the FindWindow function.</span>

<span class="n">DIM</span> <span class="n">ColorCall</span> <span class="n">AS</span> <span class="n">COLORDIALOGTYPE</span>

<span class="n">ColorCall</span><span class="p">.</span><span class="n">rgbResult</span> <span class="o">=</span> <span class="n">_RGB32</span><span class="p">(</span><span class="n">_BLUE32</span><span class="p">(</span><span class="n">InitialColor</span><span class="o">&amp;</span><span class="p">),</span> <span class="n">_GREEN32</span><span class="p">(</span><span class="n">InitialColor</span><span class="o">&amp;</span><span class="p">),</span> <span class="n">_RED32</span><span class="p">(</span><span class="n">InitialColor</span><span class="o">&amp;</span><span class="p">))</span>
<span class="n">ColorCall</span><span class="p">.</span><span class="n">lStructSize</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">ColorCall</span><span class="p">)</span>
<span class="n">ColorCall</span><span class="p">.</span><span class="n">hwndOwner</span> <span class="o">=</span> <span class="n">hWnd&amp;</span>
<span class="n">ColorCall</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">Flags</span><span class="o">&amp;</span>
<span class="n">ColorCall</span><span class="p">.</span><span class="n">lpCustColors</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">CustomColors</span><span class="err">$</span><span class="p">)</span>

<span class="c1">' Do dialog call</span>
<span class="n">Result</span> <span class="o">=</span> <span class="n">ChooseColorA</span><span class="p">(</span><span class="n">ColorCall</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span>
  <span class="n">rgbResult&amp;</span> <span class="o">=</span> <span class="n">ColorCall</span><span class="p">.</span><span class="n">rgbResult</span>
  <span class="c1">' Swap RED and BLUE color intensity values using _RGB</span>
  <span class="n">ChooseColor</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">_RGB</span><span class="p">(</span><span class="n">_BLUE32</span><span class="p">(</span><span class="n">rgbResult&amp;</span><span class="p">),</span> <span class="n">_GREEN32</span><span class="p">(</span><span class="n">rgbResult&amp;</span><span class="p">),</span> <span class="n">_RED32</span><span class="p">(</span><span class="n">rgbResult&amp;</span><span class="p">))</span>
<span class="n">ELSE</span>
  <span class="n">Cancel</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>
<p>Adapted from code by Jobert14</p>

<blockquote>
  <p><em>Note:</em> The ChooseColor value is converted using <a href="_RGB32.html">_RGB32</a> with the Blue and Red values being swapped.</p>
</blockquote>

<p><strong>Converting 32 bit Dialog Box Color values for 4 or 8 BPP Screen modes</strong></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">SCREEN</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="c1">'change from screen 12 to 32 to see the difference</span>
<span class="n">rgbresult&amp;</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8080FF</span> <span class="c1">'Dialog box long color reverse HEX$ return value</span>
<span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">_RGB</span><span class="p">(</span><span class="n">_BLUE32</span><span class="p">(</span><span class="n">rgbresult&amp;</span><span class="p">),</span> <span class="n">_GREEN32</span><span class="p">(</span><span class="n">rgbresult&amp;</span><span class="p">),</span> <span class="n">_RED32</span><span class="p">(</span><span class="n">rgbresult&amp;</span><span class="p">))</span> <span class="c1">'swap red and blue</span>
<span class="n">COLOR</span> <span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">clr</span><span class="err">~</span><span class="o">&amp;</span><span class="p">)</span> <span class="c1">'_UNSIGNED LONG color values</span>

</code></pre></div></div>

<blockquote>
  <p><em>Note:</em> The <a href="_RGB.html">_RGB</a> value returned is full <a href="_ALPHA.html">_ALPHA</a>. Use _ALPHA or <a href="_RGBA.html">_RGBA</a> to set the transparency in a program.</p>
</blockquote>

<h2 id="desktop-size">Desktop Size</h2>

<blockquote>
  <p>Returns the Left, Top, Right and Bottom coordinates of the current desktop area.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
    <span class="n">FUNCTION</span> <span class="n">SystemParametersInfoW</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">uiAction</span><span class="err">~</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">uiParam</span><span class="err">~</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">pvParam%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">fWinlni</span><span class="err">~</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">CONST</span> <span class="n">SPI_GETWORKAREA</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H30</span>

<span class="n">TYPE</span> <span class="n">RECT</span>
    <span class="n">left</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">top</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">right</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">bottom</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>
<span class="n">DIM</span> <span class="n">Rec</span> <span class="n">AS</span> <span class="n">RECT</span>

<span class="n">IF</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">SystemParametersInfoW</span><span class="p">(</span><span class="n">SPI_GETWORKAREA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">Rec</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="c1">'function failed. You may call kernel32's GetLastError for more info.</span>
    <span class="n">PRINT</span> <span class="s">"failed."</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">PRINT</span> <span class="n">Rec</span><span class="p">.</span><span class="n">left</span>
<span class="n">PRINT</span> <span class="n">Rec</span><span class="p">.</span><span class="n">top</span>
<span class="n">PRINT</span> <span class="n">Rec</span><span class="p">.</span><span class="n">right</span>
<span class="n">PRINT</span> <span class="n">Rec</span><span class="p">.</span><span class="n">bottom</span>
<span class="n">PRINT</span>
<span class="n">scr&amp;</span> <span class="o">=</span> <span class="n">_SCREENIMAGE</span>
<span class="n">PRINT</span> <span class="n">_WIDTH</span><span class="p">(</span><span class="n">scr&amp;</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="n">_HEIGHT</span><span class="p">(</span><span class="n">scr&amp;</span><span class="p">)</span>
<span class="n">_FREEIMAGE</span> <span class="n">scr&amp;</span>

<span class="n">END</span> 

</code></pre></div></div>

<h2 id="directory-environment">Directory Environment</h2>

<blockquote>
  <p>Returns various system environment settings including the current program’s EXE name.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">LIBRARY</span>   <span class="c1">'Directory Information using KERNEL32 provided by Dav</span>
<span class="n">FUNCTION</span> <span class="n">WINDirectory</span> <span class="n">ALIAS</span> <span class="n">GetWindowsDirectoryA</span> <span class="p">(</span><span class="n">lpBuffer</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nSize</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">SYSDirectory</span> <span class="n">ALIAS</span> <span class="n">GetSystemDirectoryA</span> <span class="p">(</span><span class="n">lpBuffer</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nSize</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">CURDirectory</span> <span class="n">ALIAS</span> <span class="n">GetCurrentDirectoryA</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">nBufferLen</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">lpBuffer</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">TempPath</span> <span class="n">ALIAS</span> <span class="n">GetTempPathA</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">nBufferLen</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">lpBuffer</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">GetModuleFileNameA</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hModule</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">lpFileName</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nSize</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="c1">'###  SHOW WINDOWS DIRECTORY</span>
<span class="n">WinDir</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
<span class="n">Result</span> <span class="o">=</span> <span class="n">WINDirectory</span><span class="p">(</span><span class="n">WinDir</span><span class="err">$</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">WinDir</span><span class="err">$</span><span class="p">))</span>
<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"WINDOWS DIRECTORY: "</span><span class="err">;</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">WinDir</span><span class="err">$</span><span class="p">,</span> <span class="n">Result</span><span class="p">)</span>

<span class="c1">'###  SHOW SYSTEM DIRECTORY</span>
<span class="n">SysDir</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
<span class="n">Result</span> <span class="o">=</span> <span class="n">SYSDirectory</span><span class="p">(</span><span class="n">SysDir</span><span class="err">$</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">SysDir</span><span class="err">$</span><span class="p">))</span>
<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"SYSTEM DIRECTORY: "</span><span class="err">;</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">SysDir</span><span class="err">$</span><span class="p">,</span> <span class="n">Result</span><span class="p">)</span>

<span class="c1">'###  SHOW CURRENT DIRECTORY</span>
<span class="n">CurDir</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
<span class="n">Result</span> <span class="o">=</span> <span class="n">CURDirectory</span><span class="p">(</span><span class="n">LEN</span><span class="p">(</span><span class="n">CurDir</span><span class="err">$</span><span class="p">),</span> <span class="n">CurDir</span><span class="err">$</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"CURRENT DIRECTORY: "</span><span class="err">;</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">CurDir</span><span class="err">$</span><span class="p">,</span> <span class="n">Result</span><span class="p">)</span>

<span class="c1">'###  SHOW TEMP DIRECTORY</span>
<span class="n">TempDir</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">Result</span> <span class="o">=</span> <span class="n">TempPath</span><span class="p">(</span><span class="n">LEN</span><span class="p">(</span><span class="n">TempDir</span><span class="err">$</span><span class="p">),</span> <span class="n">TempDir</span><span class="err">$</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"TEMP DIRECTORY: "</span><span class="err">;</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">TempDir</span><span class="err">$</span><span class="p">,</span> <span class="n">Result</span><span class="p">)</span>

<span class="c1">'###  SHOW CURRENT PROGRAM</span>
<span class="n">FileName</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="n">Result</span> <span class="o">=</span> <span class="n">GetModuleFileNameA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">FileName</span><span class="err">$</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">FileName</span><span class="err">$</span><span class="p">))</span>
<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"CURRENT PROGRAM: "</span><span class="err">;</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">FileName</span><span class="err">$</span><span class="p">,</span> <span class="n">Result</span><span class="p">)</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Windows APIs courtesy of Dav</p>

<blockquote>
  <p>Returns the DOS 8.3 path and file name. The DLL used is in the QB64 folder.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">LIBRARY</span>   <span class="c1">'Directory Information using KERNEL32</span>
<span class="n">FUNCTION</span> <span class="n">GetShortPathNameA</span> <span class="p">(</span><span class="n">lpLongPath</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">lpShortPath</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cBufferLen</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="c1">'###  SHOW SHORT PATH NAME</span>
<span class="n">FileOrPath</span><span class="err">$</span> <span class="o">=</span> <span class="s">"c:\qb64\SDL_image.dll"</span>  <span class="c1">'&lt;&lt; change to a relevant path or file name on computer</span>
<span class="n">ShortPathName</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">260</span><span class="p">)</span>
<span class="n">Result</span> <span class="o">=</span> <span class="n">GetShortPathNameA</span><span class="p">(</span><span class="n">FileOrPath</span><span class="err">$</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">ShortPathName</span><span class="err">$</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">ShortPathName</span><span class="err">$</span><span class="p">))</span>
<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"SHORT PATH NAME: "</span> <span class="o">+</span> <span class="n">ShortPathName</span><span class="err">$</span> <span class="n">ELSE</span> <span class="n">PRINT</span> <span class="s">"NOT Found!"</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Courtesy of Dav</p>

<h2 id="disk-drives">Disk Drives</h2>

<p>Uses Kernel32 API to lists all available drives on system. Shows the drives type: HD/CD/DVD/RAM/NET/Removable/Unknown</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CONST</span> <span class="n">REMOVABLE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CONST</span> <span class="n">FIXED</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">CONST</span> <span class="n">REMOTE</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">CONST</span> <span class="n">CDROM</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">CONST</span> <span class="n">RAMDISK</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="n">FUNCTION</span> <span class="n">GetDriveTypeA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">nDrive</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">GetLogicalDriveStringsA</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">nBuff</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">lpbuff</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">DList</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">DL</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">i</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">typ</span> <span class="n">AS</span> <span class="n">LONG</span>

<span class="n">i</span> <span class="o">=</span> <span class="n">GetLogicalDriveStringsA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DList</span><span class="p">)</span> <span class="c1">'zero returns the drive string byte size</span>
<span class="n">DList</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1">'set drive string length. Each drive is followed by CHR$(0)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">GetLogicalDriveStringsA</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">DList</span><span class="p">)</span> <span class="c1">'the byte size returns a string that long</span>
<span class="n">PRINT</span> <span class="n">DList</span>

<span class="n">FOR</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">65</span> <span class="n">TO</span> <span class="mi">90</span>
  <span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">DList</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="n">THEN</span>
    <span class="n">DL</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s">":\"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">typ</span> <span class="o">=</span> <span class="n">GetDriveTypeA</span><span class="p">(</span><span class="n">DL</span><span class="p">)</span>
    <span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">typ</span>
      <span class="n">CASE</span> <span class="n">REMOVABLE</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">DL</span> <span class="o">+</span> <span class="s">"Removable"</span>
      <span class="n">CASE</span> <span class="n">FIXED</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">DL</span> <span class="o">+</span> <span class="s">"Fixed"</span>
      <span class="n">CASE</span> <span class="n">REMOTE</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">DL</span> <span class="o">+</span> <span class="s">"Remote"</span>
      <span class="n">CASE</span> <span class="n">CDROM</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">DL</span> <span class="o">+</span> <span class="s">"CDROM"</span>
      <span class="n">CASE</span> <span class="n">RAMDISK</span><span class="p">:</span> <span class="n">PRINT</span> <span class="n">DL</span> <span class="o">+</span> <span class="s">"RAM"</span>
    <span class="n">END</span> <span class="n">SELECT</span>
  <span class="n">END</span> <span class="n">IF</span>
<span class="n">NEXT</span> 

</code></pre></div></div>
<p>Adapted from code by Dav</p>

<blockquote>
  <p><em>Note:</em> The length of the string returned by <em>GetLogicalDriveStringsA</em> can be divided by 4 to tell the number of physical and ram drives.</p>
</blockquote>

<h2 id="file-attributes">File Attributes</h2>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">DECLARE</span> <span class="n">LIBRARY</span>
    <span class="n">FUNCTION</span> <span class="n">GetFileAttributes</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">f$</span><span class="p">)</span>
    <span class="n">FUNCTION</span> <span class="n">SetFileAttributes</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">f$</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">attrib&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">CONST</span> <span class="n">INVALID_FILE_ATTRIBUTES</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">CONST</span> <span class="n">FILE_ATTRIBUTE_READONLY</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">FILE_ATTRIBUTE_HIDDEN</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CONST</span> <span class="n">FILE_ATTRIBUTE_SYSTEM</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">CONST</span> <span class="n">FILE_ATTRIBUTE_DIRECTORY</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">CONST</span> <span class="n">FILE_ATTRIBUTE_ARCHIVE</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">file$</span> <span class="o">=</span> <span class="s">"temp.txt"</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">GetFileAttributes</span><span class="p">(</span><span class="n">file$</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="n">a</span> <span class="c1">'if no file, then you'll see a -1 here</span>

<span class="n">OPEN</span> <span class="n">file$</span> <span class="n">FOR</span> <span class="n">OUTPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="mi">1</span>
<span class="n">CLOSE</span> <span class="p">#</span><span class="mi">1</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">GetFileAttributes</span><span class="p">(</span><span class="n">file$</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="n">a</span> <span class="c1">'a new file, it prints 32 for me here</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">SetFileAttributes</span><span class="p">(</span><span class="n">file$</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">'set the read only flag</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">GetFileAttributes</span><span class="p">(</span><span class="n">file$</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="n">a</span> <span class="c1">'notice, it prints 1 here and not 32.  We didn't add a flag, we changed it completel</span>

</code></pre></div></div>

<h2 id="file-open-and-save-dialog">File Open and Save Dialog</h2>

<p><strong>Open and Save Dialog Boxes get file names</strong></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">' Dialog flag constants (use + or OR to use more than 1 flag value)</span>
<span class="n">CONST</span> <span class="n">OFN_ALLOWMULTISELECT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H200</span><span class="o">&amp;</span> <span class="c1">'  Allows the user to select more than one file, not recommended!</span>
<span class="n">CONST</span> <span class="n">OFN_CREATEPROMPT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2000</span><span class="o">&amp;</span> <span class="c1">'     Prompts if a file not found should be created(GetOpenFileName only).</span>
<span class="n">CONST</span> <span class="n">OFN_EXTENSIONDIFFERENT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H400</span><span class="o">&amp;</span> <span class="c1">'Allows user to specify file extension other than default extension.</span>
<span class="n">CONST</span> <span class="n">OFN_FILEMUSTEXIST</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1000</span><span class="o">&amp;</span> <span class="c1">'    Chechs File name exists(GetOpenFileName only).</span>
<span class="n">CONST</span> <span class="n">OFN_HIDEREADONLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H4</span><span class="o">&amp;</span> <span class="c1">'        Hides read-only checkbox(GetOpenFileName only)</span>
<span class="n">CONST</span> <span class="n">OFN_NOCHANGEDIR</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8</span><span class="o">&amp;</span> <span class="c1">'         Restores the current directory to original value if user changed</span>
<span class="n">CONST</span> <span class="n">OFN_NODEREFERENCELINKS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H100000</span><span class="o">&amp;</span> <span class="c1">'Returns path and file name of selected shortcut(.LNK) file instead of file referenced.</span>
<span class="n">CONST</span> <span class="n">OFN_NONETWORKBUTTON</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H20000</span><span class="o">&amp;</span> <span class="c1">' Hides and disables the Network button.</span>
<span class="n">CONST</span> <span class="n">OFN_NOREADONLYRETURN</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8000</span><span class="o">&amp;</span> <span class="c1">' Prevents selection of read-only files, or files in read-only subdirectory.</span>
<span class="n">CONST</span> <span class="n">OFN_NOVALIDATE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H100</span><span class="o">&amp;</span> <span class="c1">'        Allows invalid file name characters.</span>
<span class="n">CONST</span> <span class="n">OFN_OVERWRITEPROMPT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span><span class="o">&amp;</span> <span class="c1">'     Prompts if file already exists(GetSaveFileName only)</span>
<span class="n">CONST</span> <span class="n">OFN_PATHMUSTEXIST</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H800</span><span class="o">&amp;</span> <span class="c1">'     Checks Path name exists (set with OFN_FILEMUSTEXIST).</span>
<span class="n">CONST</span> <span class="n">OFN_READONLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span><span class="o">&amp;</span> <span class="c1">'            Checks read-only checkbox. Returns if checkbox is checked</span>
<span class="n">CONST</span> <span class="n">OFN_SHAREAWARE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H4000</span><span class="o">&amp;</span> <span class="c1">'       Ignores sharing violations in networking</span>
<span class="n">CONST</span> <span class="n">OFN_SHOWHELP</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10</span><span class="o">&amp;</span> <span class="c1">'           Shows the help button (useless!)</span>
<span class="c1">'--------------------------------------------------------------------------------------------</span>

<span class="n">DEFINT</span> <span class="n">A</span><span class="o">-</span><span class="n">Z</span> <span class="c1">'not recommended to use this statement in a final application!</span>

<span class="n">TYPE</span> <span class="n">FILEDIALOGTYPE</span>
<span class="err">$</span><span class="n">IF</span> <span class="mi">32</span><span class="n">BIT</span> <span class="n">THEN</span>
  <span class="n">lStructSize</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'        For the DLL call</span>
  <span class="n">hwndOwner</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'          Dialog will hide behind window when not set correctly</span>
  <span class="n">hInstance</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'          Handle to a module that contains a dialog box template.</span>
  <span class="n">lpstrFilter</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'     Pointer of the string of file filters</span>
  <span class="n">lpstrCustFilter</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">nMaxCustFilter</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">nFilterIndex</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'       One based starting filter index to use when dialog is called</span>
  <span class="n">lpstrFile</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'       String full of 0's for the selected file name</span>
  <span class="n">nMaxFile</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'           Maximum length of the string stuffed with 0's minus 1</span>
  <span class="n">lpstrFileTitle</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'  Same as lpstrFile</span>
  <span class="n">nMaxFileTitle</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'      Same as nMaxFile</span>
  <span class="n">lpstrInitialDir</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">' Starting directory</span>
  <span class="n">lpstrTitle</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'      Dialog title</span>
  <span class="n">flags</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'              Dialog flags</span>
  <span class="n">nFileOffset</span> <span class="n">AS</span> <span class="n">INTEGER</span> <span class="c1">'     Zero-based offset from path beginning to file name string pointed to by lpstrFile</span>
  <span class="n">nFileExtension</span> <span class="n">AS</span> <span class="n">INTEGER</span> <span class="c1">'  Zero-based offset from path beginning to file extension string pointed to by lpstrFile.</span>
  <span class="n">lpstrDefExt</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'     Default/selected file extension</span>
  <span class="n">lCustData</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">lpfnHook</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">lpTemplateName</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
<span class="err">$</span><span class="n">ELSE</span>
  <span class="n">lStructSize</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'      For the DLL call</span>
  <span class="n">hwndOwner</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'        Dialog will hide behind window when not set correctly</span>
  <span class="n">hInstance</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'        Handle to a module that contains a dialog box template.</span>
  <span class="n">lpstrFilter</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'      Pointer of the string of file filters</span>
  <span class="n">lpstrCustFilter</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">nMaxCustFilter</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">nFilterIndex</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'  One based starting filter index to use when dialog is called</span>
  <span class="n">lpstrFile</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'        String full of 0's for the selected file name</span>
  <span class="n">nMaxFile</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'         Maximum length of the string stuffed with 0's minus 1</span>
  <span class="n">lpstrFileTitle</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'   Same as lpstrFile</span>
  <span class="n">nMaxFileTitle</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'    Same as nMaxFile</span>
  <span class="n">lpstrInitialDir</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'  Starting directory</span>
  <span class="n">lpstrTitle</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'       Dialog title</span>
  <span class="n">flags</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'         Dialog flags</span>
  <span class="n">nFileOffset</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'   Zero-based offset from path beginning to file name string pointed to by lpstrFile</span>
  <span class="n">nFileExtension</span> <span class="n">AS</span> <span class="n">_INTEGER64</span> <span class="c1">'Zero-based offset from path beginning to file extension string pointed to by lpstrFile.</span>
  <span class="n">lpstrDefExt</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'      Default/selected file extension</span>
  <span class="n">lCustData</span> <span class="n">AS</span> <span class="n">_INTEGER64</span>
  <span class="n">lpfnHook</span> <span class="n">AS</span> <span class="n">_INTEGER64</span>
  <span class="n">lpTemplateName</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
<span class="err">$</span><span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"comdlg32"</span>    <span class="c1">' Library declarations using _OFFSET types</span>
  <span class="n">FUNCTION</span> <span class="n">GetOpenFileNameA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">DIALOGPARAMS</span> <span class="n">AS</span> <span class="n">FILEDIALOGTYPE</span><span class="p">)</span> <span class="c1">' The Open file dialog</span>
  <span class="n">FUNCTION</span> <span class="n">GetSaveFileNameA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">DIALOGPARAMS</span> <span class="n">AS</span> <span class="n">FILEDIALOGTYPE</span><span class="p">)</span> <span class="c1">' The Save file dialog</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span> <span class="c1">' To get hWnd handle</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">_TITLE</span> <span class="s">"FileOpen Common Dialog demo"</span>                           <span class="c1">'set Title of program</span>
<span class="n">hWnd&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "Open and Save Dialog demo" + CHR$(0)) 'get window handle using _TITLE string</span>

<span class="c1">' Do the Open File dialog call!</span>
<span class="n">Filter</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Batch files (*.bat)|*.BAT|JPEG images (*.jpg)|*.JPG|All files (*.*)|*.*"</span>
<span class="n">Flags</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">OFN_FILEMUSTEXIST</span> <span class="o">+</span> <span class="n">OFN_NOCHANGEDIR</span> <span class="o">+</span> <span class="n">OFN_READONLY</span>  <span class="c1">'    add flag constants here</span>
<span class="n">OFile</span><span class="err">$</span> <span class="o">=</span> <span class="n">GetOpenFileName</span><span class="err">$</span><span class="p">(</span><span class="s">"YEAH! Common Dialogs in QB64!!!"</span><span class="p">,</span> <span class="s">".\"</span><span class="p">,</span> <span class="n">Filter</span><span class="err">$</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Flags</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">hWnd&amp;</span><span class="p">)</span>

<span class="n">IF</span> <span class="n">OFile</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span> <span class="n">THEN</span>   <span class="c1">' Display Open dialog results</span>
  <span class="n">PRINT</span> <span class="s">"Shame on you! You didn't pick any file..."</span>
<span class="n">ELSE</span>
  <span class="n">PRINT</span> <span class="s">"You picked this file: "</span>
  <span class="n">PRINT</span> <span class="n">OFile</span><span class="err">$</span>
  <span class="n">IF</span> <span class="p">(</span><span class="n">Flags</span><span class="o">&amp;</span> <span class="n">AND</span> <span class="n">OFN_READONLY</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Read-only checkbox checked."</span> <span class="c1">'read-only value in return</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">_DELAY</span> <span class="mi">5</span> <span class="c1">' Do the Save File dialog call!</span>
<span class="n">Filter</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Basic files (*.bas)|*.BAS|All files (*.*)|*.*"</span>
<span class="n">Flags</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">OFN_OVERWRITEPROMPT</span> <span class="o">+</span> <span class="n">OFN_NOCHANGEDIR</span> <span class="c1">'   add flag constants here</span>
<span class="n">SFile</span><span class="err">$</span> <span class="o">=</span> <span class="n">GetSaveFileName</span><span class="err">$</span><span class="p">(</span><span class="s">"Save will not create a file!!!"</span><span class="p">,</span> <span class="s">".\"</span><span class="p">,</span> <span class="n">Filter</span><span class="err">$</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Flags</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">hWnd&amp;</span><span class="p">)</span>

<span class="n">IF</span> <span class="n">SFile</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span> <span class="n">THEN</span>     <span class="c1">' Display Save dialog results</span>
  <span class="n">PRINT</span> <span class="s">"You didn't save the file..."</span>
<span class="n">ELSE</span>
  <span class="n">PRINT</span> <span class="s">"You saved this file: "</span>
  <span class="n">PRINT</span> <span class="n">SFile</span><span class="err">$</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span>

<span class="n">FUNCTION</span> <span class="n">GetOpenFileName</span><span class="err">$</span> <span class="p">(</span><span class="n">Title</span><span class="err">$</span><span class="p">,</span> <span class="n">InitialDir</span><span class="err">$</span><span class="p">,</span> <span class="n">Filter</span><span class="err">$</span><span class="p">,</span> <span class="n">FilterIndex</span><span class="p">,</span> <span class="n">Flags</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">hWnd&amp;</span><span class="p">)</span>
<span class="c1">'  Title$      - The dialog title.</span>
<span class="c1">'  InitialDir$ - If this left blank, it will use the directory where the last opened file is</span>
<span class="c1">'  located. Specify ".\" if you want to always use the current directory.</span>
<span class="c1">'  Filter$     - File filters separated by pipes (|) in the same format as using VB6 common dialogs.</span>
<span class="c1">'  FilterIndex - The initial file filter to use. Will be altered by user during the call.</span>
<span class="c1">'  Flags&amp;      - Dialog flags. Will be altered by the user during the call.</span>
<span class="c1">'  hWnd&amp;       - Your program's window handle that should be aquired by the FindWindow function.</span>
<span class="c1">'</span>
<span class="c1">' Returns: Blank when cancel is clicked otherwise, the file name selected by the user.</span>
<span class="c1">' FilterIndex and Flags&amp; will be changed depending on the user's selections.</span>

<span class="n">DIM</span> <span class="n">OpenCall</span> <span class="n">AS</span> <span class="n">FILEDIALOGTYPE</span>  <span class="c1">' Needed for dialog call</span>

<span class="n">fFilter$</span> <span class="o">=</span> <span class="n">Filter</span><span class="err">$</span>
<span class="n">FOR</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">TO</span> <span class="n">LEN</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">)</span> <span class="c1">' Replace the pipes with character zero</span>
  <span class="n">IF</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"|"</span> <span class="n">THEN</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">NEXT</span> <span class="n">R</span>
<span class="n">fFilter$</span> <span class="o">=</span> <span class="n">fFilter$</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lpstrFile$</span> <span class="o">=</span> <span class="n">STRING</span><span class="err">$</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">' For the returned file name</span>
<span class="n">lpstrDefExt$</span> <span class="o">=</span> <span class="n">STRING</span><span class="err">$</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">' Extension will not be added when this is not specified</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">lStructSize</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">OpenCall</span><span class="p">)</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">hwndOwner</span> <span class="o">=</span> <span class="n">hWnd&amp;</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">lpstrFilter</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">)</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">nFilterIndex</span> <span class="o">=</span> <span class="n">FilterIndex</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">lpstrFile</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">)</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">nMaxFile</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">lpstrFileTitle</span> <span class="o">=</span> <span class="n">OpenCall</span><span class="p">.</span><span class="n">lpstrFile</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">nMaxFileTitle</span> <span class="o">=</span> <span class="n">OpenCall</span><span class="p">.</span><span class="n">nMaxFile</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">lpstrInitialDir</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">InitialDir</span><span class="err">$</span><span class="p">)</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">lpstrTitle</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">Title</span><span class="err">$</span><span class="p">)</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">lpstrDefExt</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">lpstrDefExt$</span><span class="p">)</span>
<span class="n">OpenCall</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">Flags</span><span class="o">&amp;</span>

<span class="n">Result</span> <span class="o">=</span> <span class="n">GetOpenFileNameA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">OpenCall</span><span class="p">)</span> <span class="c1">'            Do Open File dialog call!</span>

<span class="n">IF</span> <span class="n">Result</span> <span class="n">THEN</span>   <span class="c1">' Trim the remaining zeros</span>
  <span class="n">GetOpenFileName</span><span class="err">$</span> <span class="o">=</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">Flags</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">OpenCall</span><span class="p">.</span><span class="n">flags</span>
  <span class="n">FilterIndex</span> <span class="o">=</span> <span class="n">OpenCall</span><span class="p">.</span><span class="n">nFilterIndex</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">GetSaveFileName</span><span class="err">$</span> <span class="p">(</span><span class="n">Title</span><span class="err">$</span><span class="p">,</span> <span class="n">InitialDir</span><span class="err">$</span><span class="p">,</span> <span class="n">Filter</span><span class="err">$</span><span class="p">,</span> <span class="n">FilterIndex</span><span class="p">,</span> <span class="n">Flags</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">hWnd&amp;</span><span class="p">)</span>
<span class="c1">'  Title$      - The dialog title.</span>
<span class="c1">'  InitialDir$ - If this left blank, it will use the directory where the last opened file is</span>
<span class="c1">'     located. Specify ".\" if you want to always use the current directory.</span>
<span class="c1">'  Filter$     - File filters separated by pipes (|) in the same format as VB6 common dialogs.</span>
<span class="c1">'  FilterIndex - The initial file filter to use. Will be altered by user during the call.</span>
<span class="c1">'  Flags&amp;      - Dialog flags. Will be altered by the user during the call.</span>
<span class="c1">'  hWnd&amp;       - Your program's window handle that should be aquired by the FindWindow function.</span>

<span class="c1">' Returns: Blank when cancel is clicked otherwise, the file name entered by the user.</span>
<span class="c1">' FilterIndex and Flags&amp; will be changed depending on the user's selections.</span>

<span class="n">DIM</span> <span class="n">SaveCall</span> <span class="n">AS</span> <span class="n">FILEDIALOGTYPE</span>  <span class="c1">' Needed for dialog call</span>

<span class="n">fFilter$</span> <span class="o">=</span> <span class="n">Filter</span><span class="err">$</span>
<span class="n">FOR</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">TO</span> <span class="n">LEN</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">)</span>  <span class="c1">' Replace the pipes with zeros</span>
  <span class="n">IF</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"|"</span> <span class="n">THEN</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">NEXT</span> <span class="n">R</span>
<span class="n">fFilter$</span> <span class="o">=</span> <span class="n">fFilter$</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lpstrFile$</span> <span class="o">=</span> <span class="n">STRING</span><span class="err">$</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">' For the returned file name</span>
<span class="n">lpstrDefExt$</span> <span class="o">=</span> <span class="n">STRING</span><span class="err">$</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">' Extension will not be added when this is not specified</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">lStructSize</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">SaveCall</span><span class="p">)</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">hwndOwner</span> <span class="o">=</span> <span class="n">hWnd&amp;</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">lpstrFilter</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">fFilter$</span><span class="p">)</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">nFilterIndex</span> <span class="o">=</span> <span class="n">FilterIndex</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">lpstrFile</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">)</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">nMaxFile</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">lpstrFileTitle</span> <span class="o">=</span> <span class="n">SaveCall</span><span class="p">.</span><span class="n">lpstrFile</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">nMaxFileTitle</span> <span class="o">=</span> <span class="n">SaveCall</span><span class="p">.</span><span class="n">nMaxFile</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">lpstrInitialDir</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">InitialDir</span><span class="err">$</span><span class="p">)</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">lpstrTitle</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">Title</span><span class="err">$</span><span class="p">)</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">lpstrDefExt</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">lpstrDefExt$</span><span class="p">)</span>
<span class="n">SaveCall</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">Flags</span><span class="o">&amp;</span>

<span class="n">Result</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">GetSaveFileNameA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">SaveCall</span><span class="p">)</span> <span class="c1">' Do dialog call!</span>

<span class="n">IF</span> <span class="n">Result</span><span class="o">&amp;</span> <span class="n">THEN</span>  <span class="c1">' Trim the remaining zeros</span>
  <span class="n">GetSaveFileName</span><span class="err">$</span> <span class="o">=</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">lpstrFile$</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">Flags</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">SaveCall</span><span class="p">.</span><span class="n">flags</span>
  <span class="n">FilterIndex</span> <span class="o">=</span> <span class="n">SaveCall</span><span class="p">.</span><span class="n">nFilterIndex</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>
<p>Code courtesy of Jobert14</p>

<blockquote>
  <p><em>Note:</em> The Open and Save Dialog boxes get user selections and do not actually open or create a file! Your program must do that.</p>
</blockquote>

<blockquote>
  <p><strong><a href="http://msdn.microsoft.com/en-us/library/aa155724(v=office.10).aspx">Microsoft MSDN</a></strong></p>
</blockquote>

<blockquote>
  <p><strong><a href="http://msdn.microsoft.com/en-us/library/aa259317(v=vs.60).aspx">Common Dialog Flag Constants</a></strong></p>
</blockquote>

<blockquote>
  <p>In VB6, variable-length strings in user <a href="TYPE.html">TYPE</a>s are actually pointer <a href="_OFFSET.html">_OFFSET</a>s to those strings.</p>
</blockquote>

<h2 id="file-times">File Times</h2>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CONST</span> <span class="n">GENERIC_READ</span> <span class="o">=</span> <span class="o">-&amp;</span><span class="n">H80000000</span>
<span class="n">CONST</span> <span class="n">GENERIC_WRITE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H40000000</span>
<span class="n">CONST</span> <span class="n">FILE_SHARE_READ</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span>
<span class="n">CONST</span> <span class="n">FILE_SHARE_WRITE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span>
<span class="n">CONST</span> <span class="n">OPEN_EXISTING</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H3</span>
<span class="n">CONST</span> <span class="n">INVALID_HANDLE_VALUE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"kernel32"</span>
<span class="n">FUNCTION</span> <span class="n">CreateFileA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpFileName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwDesiredAccess</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">_</span>
<span class="n">BYVAL</span> <span class="n">dwShareMode</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpSecurityAttributes</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">_</span>
<span class="n">BYVAL</span> <span class="n">dwCreationDisposition</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwFlagsAndAttributes</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">_</span>
<span class="n">BYVAL</span> <span class="n">hTemplateFile</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">CloseHandle</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hObject</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">GetFileTime</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hFile</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpCreationTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpLastAccessTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpLastWriteTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">SetFileTime</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hFile</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpCreationTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpLastAccessTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpLastWriteTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">FileTimeToLocalFileTime</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpFileTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpLocalFileTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">LocalFileTimeToFileTime</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpLocalFileTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpFileTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">FileTimeToSystemTime</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpFileTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpSystemTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">SystemTimeToFileTime</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpSystemTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpFileTime</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">FUNCTION</span> <span class="n">GetLastError</span><span class="o">&amp;</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">TYPE</span> <span class="n">FILETIME</span>
  <span class="n">dwLowDateTime</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
  <span class="n">dwHighDateTime</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">TYPE</span> <span class="n">SYSTEMTIME</span>
  <span class="n">wYear</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
  <span class="n">wMonth</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
  <span class="n">wDayOfWeek</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
  <span class="n">wDay</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
  <span class="n">wHour</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
  <span class="n">wMinute</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
  <span class="n">wSecond</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
  <span class="n">wMilliseconds</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DIM</span> <span class="n">CreateDate</span> <span class="n">AS</span> <span class="n">FILETIME</span>
<span class="n">DIM</span> <span class="n">ModifyDate</span> <span class="n">AS</span> <span class="n">FILETIME</span>
<span class="n">DIM</span> <span class="n">AccessDate</span> <span class="n">AS</span> <span class="n">FILETIME</span>

<span class="n">DIM</span> <span class="n">systime</span> <span class="n">AS</span> <span class="n">SYSTEMTIME</span>

<span class="n">DIM</span> <span class="n">FileName</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">FileHandle</span> <span class="n">AS</span> <span class="n">_OFFSET</span>

<span class="n">FileName</span> <span class="o">=</span> <span class="s">"readme.txt"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">'&lt;&lt;&lt;&lt;&lt;&lt; Existing file in QB64 folder. Use existing file path!</span>

<span class="n">FileHandle</span> <span class="o">=</span> <span class="n">CreateFileA</span><span class="err">%</span><span class="o">&amp;</span><span class="p">(</span><span class="n">_OFFSET</span><span class="p">(</span><span class="n">FileName</span><span class="p">),</span> <span class="n">GENERIC_READ</span><span class="p">,</span> <span class="n">FILE_SHARE_READ</span> <span class="n">OR</span> <span class="n">FILE_SHARE_WRITE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">OPEN_EXISTING</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">FileHandle</span> <span class="o">&lt;&gt;</span> <span class="n">INVALID_HANDLE_VALUE</span> <span class="n">THEN</span>
  <span class="n">IF</span> <span class="n">GetFileTime</span><span class="o">&amp;</span><span class="p">(</span><span class="n">FileHandle</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">CreateDate</span><span class="p">),</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">ModifyDate</span><span class="p">),</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">AccessDate</span><span class="p">))</span> <span class="n">THEN</span>
    <span class="n">PRINT</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">CreateDate</span><span class="p">.</span><span class="n">dwLowDateTime</span><span class="p">)</span> <span class="o">+</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">CreateDate</span><span class="p">.</span><span class="n">dwHighDateTime</span><span class="p">)</span>
    <span class="n">PRINT</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">ModifyDate</span><span class="p">.</span><span class="n">dwLowDateTime</span><span class="p">)</span> <span class="o">+</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">ModifyDate</span><span class="p">.</span><span class="n">dwHighDateTime</span><span class="p">)</span>
    <span class="n">PRINT</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">AccessDate</span><span class="p">.</span><span class="n">dwLowDateTime</span><span class="p">)</span> <span class="o">+</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">AccessDate</span><span class="p">.</span><span class="n">dwHighDateTime</span><span class="p">)</span>
    <span class="n">PRINT</span>
    <span class="n">IF</span> <span class="n">FileTimeToSystemTime</span><span class="o">&amp;</span><span class="p">(</span><span class="n">_OFFSET</span><span class="p">(</span><span class="n">CreateDate</span><span class="p">),</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">systime</span><span class="p">))</span> <span class="n">THEN</span>
      <span class="n">PRINT</span> <span class="s">"Creation time, in GMT, in decimal:"</span>
      <span class="n">PRINT</span> <span class="s">"Year:"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wYear</span>
      <span class="n">PRINT</span> <span class="s">"Month:"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wMonth</span><span class="p">,</span> <span class="s">"("</span><span class="err">;</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="s">"JanFebMarAprMayJunJulAugSepOctNovDec"</span><span class="p">,</span> <span class="p">(</span><span class="n">systime</span><span class="p">.</span><span class="n">wMonth</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="err">;</span> <span class="s">")"</span>
      <span class="n">PRINT</span> <span class="s">"DayOfWeek:"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wDayOfWeek</span><span class="p">,</span> <span class="s">"("</span><span class="err">;</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="s">"SunMonTueWedThuFriSat"</span><span class="p">,</span> <span class="p">(</span><span class="n">systime</span><span class="p">.</span><span class="n">wDayOfWeek</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="err">;</span> <span class="s">")"</span>
      <span class="n">PRINT</span> <span class="s">"Day"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wDay</span>
      <span class="n">PRINT</span> <span class="s">"Hour"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wHour</span>
      <span class="n">PRINT</span> <span class="s">"Minute"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wMinute</span>
      <span class="n">PRINT</span> <span class="s">"Second"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wSecond</span>
      <span class="n">PRINT</span> <span class="s">"Milliseconds"</span><span class="err">;</span> <span class="n">systime</span><span class="p">.</span><span class="n">wMilliseconds</span>
    <span class="n">ELSE</span>
      <span class="n">PRINT</span> <span class="s">"FileTimeToSystemTime failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="o">&amp;</span><span class="p">))</span>
    <span class="n">END</span> <span class="n">IF</span>
  <span class="n">ELSE</span>
    <span class="n">PRINT</span> <span class="s">"GetFileTime failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="o">&amp;</span><span class="p">))</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">CloseHandle</span><span class="o">&amp;</span><span class="p">(</span><span class="n">FileHandle</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span>
    <span class="n">PRINT</span> <span class="s">"CloseHandle failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="o">&amp;</span><span class="p">))</span>
    <span class="n">END</span>
  <span class="n">END</span> <span class="n">IF</span>
<span class="n">ELSE</span>
  <span class="n">PRINT</span> <span class="s">"CreateFileA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="o">&amp;</span><span class="p">))</span>
  <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Code courtesy of Michael Calkins</p>

<p>Use your own existing file name and path in this procedure.</p>

<h2 id="focus">Focus</h2>

<blockquote>
  <p><strong>Sets Focus on program with <em>SetForegroundWindow</em> after maximizing a minimized program when Shift+A is pressed.</strong> (See <a href="Windows-Libraries.html">Windows Libraries</a>)</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'Uses GetKeyState Win API to monitor a Key state.</span>
<span class="c1">'This demo will maximize the window and focus on program when Shift+A is pressed.</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
  <span class="n">FUNCTION</span> <span class="n">FindWindowA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span> <span class="c1">'find process handle by title</span>
  <span class="n">FUNCTION</span> <span class="n">GetKeyState</span><span class="err">%</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">nVirtKey</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span> <span class="c1">'Windows virtual key presses</span>
  <span class="n">FUNCTION</span> <span class="n">ShowWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nCmdShow</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span> <span class="c1">'maximize process</span>
  <span class="n">FUNCTION</span> <span class="n">GetForegroundWindow</span><span class="err">%</span><span class="o">&amp;</span> <span class="c1">'find currently focused process handle</span>
  <span class="n">FUNCTION</span> <span class="n">SetForegroundWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span> <span class="c1">'set foreground window process(focus)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">title$</span> <span class="o">=</span> <span class="s">"Cheapo Hotkey (Shift+A)"</span> <span class="c1">'title of program window</span>
<span class="n">_TITLE</span> <span class="n">title$</span> <span class="c1">'set program title</span>
<span class="n">hwnd%</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindowA(0, title$ + CHR$(0)) 'find this program's process handle</span>

<span class="n">PRINT</span> <span class="s">"Minimize window, click another then Press Shift+A to bring it back up."</span>

<span class="c1">'###  below minimizes it for you</span>
<span class="n">_DELAY</span> <span class="mi">4</span>
<span class="n">x&amp;</span> <span class="o">=</span> <span class="n">ShowWindow</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">'#### #### #### #### ## </span>

<span class="n">DO</span>
  <span class="n">IF</span> <span class="n">GetKeyState</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="n">AND</span> <span class="n">GetKeyState</span><span class="p">(</span><span class="n">ASC</span><span class="p">(</span><span class="s">"A"</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="c1">'&lt;####  Shift+A</span>
    <span class="n">FGwin</span><span class="err">%</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">GetForegroundWindow</span><span class="err">%</span><span class="o">&amp;</span> <span class="c1">'get current process in focus</span>
    <span class="n">PRINT</span> <span class="s">"Program Handle:"</span><span class="err">;</span> <span class="n">hwnd%</span><span class="o">&amp;</span><span class="err">;</span> <span class="s">"Focus handle:"</span><span class="err">;</span> <span class="n">FGwin</span><span class="err">%</span><span class="o">&amp;</span>

    <span class="n">y&amp;</span> <span class="o">=</span> <span class="n">ShowWindow</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">'maximize minimized program</span>

    <span class="n">IF</span> <span class="n">FGwin</span><span class="err">%</span><span class="o">&amp;</span> <span class="o">&lt;&gt;</span> <span class="n">hwnd%</span><span class="o">&amp;</span> <span class="n">THEN</span> <span class="n">z&amp;</span> <span class="o">=</span> <span class="n">SetForegroundWindow</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">)</span> <span class="c1">'set focus when necessary</span>

    <span class="n">PRINT</span> <span class="s">"That is all. Return values:"</span><span class="err">;</span> <span class="n">x&amp;</span><span class="err">;</span> <span class="n">y&amp;</span><span class="err">;</span> <span class="n">z&amp;</span>

    <span class="c1">'PUT PROGRAM CODE OR SUB CALLS HERE!</span>
    <span class="c1">'###  below minimizes it for you again after code is done</span>
    <span class="c1">'_DELAY 4</span>
    <span class="c1">'x&amp; = ShowWindow&amp;(hwnd%&amp;, 2)</span>
    <span class="c1">'#### #### #### #### ## </span>



    <span class="n">_DELAY</span> <span class="mi">5</span><span class="p">:</span> <span class="n">END</span> <span class="c1">'delay allows user to not minimize the window</span>
  <span class="n">END</span> <span class="n">IF</span>

  <span class="n">_LIMIT</span> <span class="mi">30</span> <span class="c1">'save CPU usage while waiting for key press</span>

<span class="n">LOOP</span> 

</code></pre></div></div>
<p>Adapted by Ted Weissgerber from code by Dav</p>

<p>The <em><a href="Windows-Libraries.html">Windows Libraries</a></em> function finds the process currently in focus. See: <a href="Windows-Libraries.html">Windows Libraries</a></p>

<blockquote>
  <p><strong>Always brings unfocused or minimized program to the top with focus when Shift+A hotkey combination is pressed.</strong></p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'## </span>
<span class="c1">'HOTKEYS.BAS</span>
<span class="c1">'## </span>

<span class="c1">'Windows Hotkey example.</span>
<span class="c1">'This demo sets Shift+A hotkey to maximize the program window when minimized.</span>
<span class="c1">'Returns focus to the program.</span>
<span class="c1">'Coded by Dav JULY/2012</span>


<span class="n">DECLARE</span> <span class="n">CUSTOMTYPE</span> <span class="n">LIBRARY</span>
  <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">ShowWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nCmdShow</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
  <span class="n">FUNCTION</span> <span class="n">SendMessageA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">wMsg</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">wParam</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lParam</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">DefWindowProcA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">wMsg</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">wParam</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lParam</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">_TITLE</span> <span class="s">"My Focus Program"</span>
<span class="n">hwnd</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "My Focus Program" + CHR$(0)) 'get Windows program ID by title</span>

<span class="n">CONST</span> <span class="n">WM_SETHOTKEY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H32</span>
<span class="n">CONST</span> <span class="n">WM_SHOWWINDOW</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H18</span>
<span class="c1">'SendMessage function key combination values</span>
<span class="n">CONST</span> <span class="n">HK_SHIFT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H100</span> <span class="c1">'NOTE: Send Message values are different than HotKey</span>
<span class="n">CONST</span> <span class="n">HK_CTRL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H200</span>  <span class="c1">'All other keys are the same as the HotKey values.</span>
<span class="n">CONST</span> <span class="n">HK_ALT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H400</span>

<span class="n">PRINT</span> <span class="s">"Press Shift+A to maximize or bring this window to top..."</span>
<span class="n">_DELAY</span> <span class="mi">3</span>

<span class="c1">'###  Tell windows what hotkey you want to use.</span>
<span class="n">hot&amp;</span> <span class="o">=</span> <span class="n">SendMessageA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">WM_SETHOTKEY</span><span class="p">,</span> <span class="n">HK_SHIFT</span> <span class="o">+</span> <span class="n">ASC</span><span class="p">(</span><span class="s">"A"</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">'use uppercase second key</span>
<span class="n">PRINT</span> <span class="n">hot&amp;</span><span class="err">;</span>
<span class="c1">'###  See if hotkey set ok...</span>
<span class="n">IF</span> <span class="n">hot&amp;</span> <span class="o">&lt;&gt;</span> <span class="mi">1</span> <span class="n">THEN</span>
  <span class="n">PRINT</span> <span class="s">"Hotkey not set."</span> <span class="o">+</span> <span class="s">"Error: "</span><span class="err">;</span> <span class="n">hot&amp;</span>
  <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="c1">'###   minimize program with this</span>
<span class="c1">'a&amp; = ShowWindow&amp;(hwnd, 6)</span>

<span class="c1">'###  Below tells Windows what to do when hotkey is pressed.</span>
<span class="c1">'### (it maximizes the program window and returns focus over and over).</span>
<span class="n">top&amp;</span> <span class="o">=</span> <span class="n">DefWindowProcA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">WM_SHOWWINDOW</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">DO</span><span class="p">:</span> <span class="n">_LIMIT</span> <span class="mi">1</span>
  <span class="c1">'do your program stuff here....</span>
  <span class="n">PRINT</span> <span class="n">hot&amp;</span><span class="err">;</span> <span class="n">top&amp;</span><span class="err">;</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Adapted from code by Dav</p>

<blockquote>
  <p><strong>Note:</strong> The <em>SetHotKey</em> message tells the designated Windows program ID when to do <em>DefWondowProcA</em> to focus the window.</p>
</blockquote>

<p><strong>This can also focus on other program IDs! See also: <a href="Windows-Libraries.html">Windows Libraries</a></strong></p>

<p>Note: Minimized programs will always lose focus when minimized unless clicked in taskbar.</p>

<h2 id="folder-dialog-box">Folder Dialog Box</h2>

<blockquote>
  <p>The SHBrowseForFolder function receives information about the folder selected by the user in Windows XP to 7.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">CUSTOMTYPE</span> <span class="n">LIBRARY</span>
    <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">_TITLE</span> <span class="s">"Super Window"</span>
<span class="n">hwnd&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "Super Window" + CHR$(0))</span>

<span class="n">TYPE</span> <span class="n">BROWSEINFO</span>  <span class="c1">'typedef struct _browseinfo 'Microsoft MSDN</span>
  <span class="n">hwndOwner</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'              '  HWND</span>
  <span class="n">pidlRoot</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'             '  PCIDLIST_ABSOLUTE</span>
  <span class="n">pszDisplayName</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'      '  LPTSTR</span>
  <span class="n">lpszTitle</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'           '  LPCTSTR</span>
  <span class="n">ulFlags</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>        <span class="c1">'  UINT</span>
  <span class="n">lpfn</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'                '  BFFCALLBACK</span>
  <span class="n">lParam</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'              '  LPARAM</span>
  <span class="n">iImage</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'                 '  int</span>
<span class="n">END</span> <span class="n">TYPE</span>  <span class="c1">'BROWSEINFO, *PBROWSEINFO, *LPBROWSEINFO;</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"shell32"</span>
  <span class="n">FUNCTION</span> <span class="n">SHBrowseForFolder</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="n">AS</span> <span class="n">BROWSEINFO</span><span class="p">)</span> <span class="c1">'Microsoft MSDN</span>
  <span class="n">SUB</span> <span class="n">SHGetPathFromIDList</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpItem</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">szDir</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span> <span class="c1">'Microsoft MSDN</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">b</span> <span class="n">AS</span> <span class="n">BROWSEINFO</span>
<span class="n">b</span><span class="p">.</span><span class="n">hwndOwner</span> <span class="o">=</span> <span class="n">hwnd</span>
<span class="n">DIM</span> <span class="n">s</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">1024</span>
<span class="n">b</span><span class="p">.</span><span class="n">pszDisplayName</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">s$</span><span class="p">)</span>
<span class="n">a$</span> <span class="o">=</span> <span class="s">"Choose a folder!!!"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">b</span><span class="p">.</span><span class="n">lpszTitle</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">a$</span><span class="p">)</span>
<span class="n">DIM</span> <span class="n">o</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">SHBrowseForFolder</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">o</span> <span class="n">THEN</span>
    <span class="n">PRINT</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">s$</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">s$</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">DIM</span> <span class="n">s2</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">1024</span>
    <span class="n">SHGetPathFromIDList</span> <span class="n">o</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">s2$</span><span class="p">)</span>
    <span class="n">PRINT</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">s2$</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">s2$</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ELSE</span>
    <span class="n">PRINT</span> <span class="s">"Cancel?"</span>
<span class="n">END</span> <span class="n">IF</span> 

</code></pre></div></div>
<p>Code by Galleon</p>

<h2 id="font-dialog-box">Font Dialog Box</h2>

<p>This dialog box does not return the actual font file name. Refer to the <a href="Windows-Libraries.html">Windows Libraries</a> procedure below this one.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">' Constants assigned to Flags. A LONG numerical suffix defines those constants as LONG</span>
<span class="n">CONST</span> <span class="n">CF_APPLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H200</span><span class="o">&amp;</span> <span class="c1">'             Displays Apply button</span>
<span class="n">CONST</span> <span class="n">CF_ANSIONLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H400</span><span class="o">&amp;</span> <span class="c1">'          list ANSI fonts only</span>
<span class="n">CONST</span> <span class="n">CF_BOTH</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H3</span><span class="o">&amp;</span> <span class="c1">'                list both Screen and Printer fonts</span>
<span class="n">CONST</span> <span class="n">CF_EFFECTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H100</span><span class="o">&amp;</span>  <span class="c1">'          Display Underline and Strike Through boxes</span>
<span class="n">CONST</span> <span class="n">CF_ENABLEHOOK</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8</span><span class="o">&amp;</span> <span class="c1">'          set hook to custom template</span>
<span class="n">CONST</span> <span class="n">CF_ENABLETEMPLATE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10</span><span class="o">&amp;</span> <span class="c1">'     enable custom template</span>
<span class="n">CONST</span> <span class="n">CF_ENABLETEMPLATEHANDLE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H20</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">CF_FIXEDPITCHONLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H4000</span><span class="o">&amp;</span>  <span class="c1">'  list only fixed-pitch fonts</span>
<span class="n">CONST</span> <span class="n">CF_FORCEFONTEXIST</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10000</span><span class="o">&amp;</span> <span class="c1">'  indicate error when font not listed is chosen</span>
<span class="n">CONST</span> <span class="n">CF_INACTIVEFONTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2000000</span><span class="o">&amp;</span> <span class="c1">' display hidden fonts in Win 7 only</span>
<span class="n">CONST</span> <span class="n">CF_INITTOLOGFONTSTRUCT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H40</span><span class="o">&amp;</span> <span class="c1">'use the structure pointed to by the lpLogFont member</span>
<span class="n">CONST</span> <span class="n">CF_LIMITSIZE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2000</span><span class="o">&amp;</span> <span class="c1">'        select font sizes only within nSizeMin and nSizeMax members</span>
<span class="n">CONST</span> <span class="n">CF_NOOEMFONTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H800</span><span class="o">&amp;</span> <span class="c1">'        should not allow vector font selections</span>
<span class="n">CONST</span> <span class="n">CF_NOFACESEL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000</span><span class="o">&amp;</span> <span class="c1">'       prevent displaying initial selection in font name combo box.</span>
<span class="n">CONST</span> <span class="n">CF_NOSCRIPTSEL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H800000</span><span class="o">&amp;</span> <span class="c1">'    Disables the Script combo box</span>
<span class="n">CONST</span> <span class="n">CF_NOSIMULATIONS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1000</span><span class="o">&amp;</span> <span class="c1">'    Disables selection of font simulations</span>
<span class="n">CONST</span> <span class="n">CF_NOSIZESEL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H200000</span><span class="o">&amp;</span>  <span class="c1">'     Disables Point Size selection</span>
<span class="n">CONST</span> <span class="n">CF_NOSTYLESEL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H100000</span><span class="o">&amp;</span> <span class="c1">'     Disables Style selection</span>
<span class="n">CONST</span> <span class="n">CF_NOVECTORFONTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H800</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">CF_NOVERTFONTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1000000</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">CF_OEMTEXT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H7</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">CF_PRINTERFONTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span><span class="o">&amp;</span> <span class="c1">'        list fonts only supported by printer associated with the device</span>
<span class="n">CONST</span> <span class="n">CF_SCALABLEONLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H20000</span><span class="o">&amp;</span> <span class="c1">'    select only vector fonts, scalable printer fonts, and TrueType fonts</span>
<span class="n">CONST</span> <span class="n">CF_SCREENFONTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span><span class="o">&amp;</span>  <span class="c1">'        lists only the screen fonts supported by system</span>
<span class="n">CONST</span> <span class="n">CF_SCRIPTSONLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H400</span><span class="o">&amp;</span> <span class="c1">'       lists all non-OEM, Symbol and ANSI sets only</span>
<span class="n">CONST</span> <span class="n">CF_SELECTSCRIPT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H400000</span><span class="o">&amp;</span>  <span class="c1">'  can only use set specified in the Scripts combo box</span>
<span class="n">CONST</span> <span class="n">CF_SHOWHELP</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H4</span><span class="o">&amp;</span>  <span class="c1">'           displays Help button reference</span>
<span class="n">CONST</span> <span class="n">CF_TTONLY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H40000</span><span class="o">&amp;</span>  <span class="c1">'         True Type only</span>
<span class="n">CONST</span> <span class="n">CF_USESTYLE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80</span><span class="o">&amp;</span> <span class="c1">'           copies style data for the user's selection to lpszStyle buffer</span>
<span class="n">CONST</span> <span class="n">CF_WYSIWYG</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8000</span><span class="o">&amp;</span> <span class="c1">'          only list fonts available on both the printer and display</span>
<span class="c1">' Font Types returned by nFontType</span>
<span class="n">CONST</span> <span class="n">BOLD_FONTTYPE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H100</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">ITALIC_FONTTYPE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H200</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">PRINTER_FONTTYPE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H4000</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">REGULAR_FONTTYPE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H400</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">SCREEN_FONTTYPE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2000</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">SIMULATED_FONTTYPE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8000</span><span class="o">&amp;</span>
<span class="c1">' Font Weights assigned to lfWeight</span>
<span class="n">CONST</span> <span class="n">FW_DONTCARE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">FW_THIN</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">CONST</span> <span class="n">FW_ULTRALIGHT</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">CONST</span> <span class="n">FW_LIGHT</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">CONST</span> <span class="n">FW_REGULAR</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">CONST</span> <span class="n">FW_MEDIUM</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">CONST</span> <span class="n">FW_SEMIBOLD</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">CONST</span> <span class="n">FW_BOLD</span> <span class="o">=</span> <span class="mi">700</span>
<span class="n">CONST</span> <span class="n">FW_ULTRABOLD</span> <span class="o">=</span> <span class="mi">800</span>
<span class="n">CONST</span> <span class="n">FW_HEAVY</span> <span class="o">=</span> <span class="mi">900</span>

<span class="n">CONST</span> <span class="n">DEFAULT_CHARSET</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">LF_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">FF_ROMAN</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">CONST</span> <span class="n">LF_FACESIZE</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">CONST</span> <span class="n">GMEM_MOVEABLE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span>
<span class="n">CONST</span> <span class="n">GMEM_ZEROINIT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H40</span>
<span class="c1">'-------------------------------------------------------------------------------------------</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
  <span class="n">FUNCTION</span> <span class="n">FindWindowA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">WindowName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"comdlg32"</span>
  <span class="n">FUNCTION</span> <span class="n">ChooseFontA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpcf</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">CommDlgExtendedError</span><span class="o">&amp;</span> <span class="p">()</span> <span class="c1">'                'dialog box error checking procedure</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">TYPE</span> <span class="n">CHOOSEFONT</span>
  <span class="n">lStructSize</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
  <span class="n">hwndOwner</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">HDC</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">lpLogFont</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">iPointSize</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">Flags</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">rgbColors</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
  <span class="n">lCustData</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">lpfnHook</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">lpTemplateName</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">hInstance</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">lpszStyle</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
  <span class="n">nFontType</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'  if used as Unsigned Integer add Integer padder below</span>
  <span class="c1">'padder AS INTEGER ' use only when nFontType is designated as Unsigned Integer</span>
  <span class="n">nSizeMin</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">nSizeMax</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">TYPE</span> <span class="n">LOGFONT</span>
  <span class="n">lfHeight</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">lfWidth</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">lfEscapement</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">lfOrientation</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">lfWeight</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">lfItalic</span> <span class="n">AS</span> <span class="n">_BYTE</span> <span class="c1">'    not 0 when user selected</span>
  <span class="n">lfUnderline</span> <span class="n">AS</span> <span class="n">_BYTE</span> <span class="c1">' not 0 when user selected</span>
  <span class="n">lfStrikeOut</span> <span class="n">AS</span> <span class="n">_BYTE</span> <span class="c1">' not 0 when user selected</span>
  <span class="n">lfCharSet</span> <span class="n">AS</span> <span class="n">_BYTE</span>
  <span class="n">lfOutPrecision</span> <span class="n">AS</span> <span class="n">_BYTE</span>
  <span class="n">lfClipPrecision</span> <span class="n">AS</span> <span class="n">_BYTE</span>
  <span class="n">lfQuality</span> <span class="n">AS</span> <span class="n">_BYTE</span>
  <span class="n">lfPitchAndFamily</span> <span class="n">AS</span> <span class="n">_BYTE</span>
  <span class="n">lfFaceName</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">32</span> <span class="c1">'contains name listed in dialog</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DIM</span> <span class="n">hWnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span> <span class="c1">'must DIM or hWnd won't work</span>
<span class="n">DIM</span> <span class="n">Title</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="c1">'keeps Dialog with program window</span>

<span class="n">SCREEN</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="c1">'32 bit, 16 or 256 color screen modes</span>
<span class="n">Title</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Choose Font Dialog"</span>
<span class="n">_TITLE</span> <span class="n">Title</span><span class="err">$</span> <span class="c1">'set Title of program</span>
<span class="n">_DELAY</span> <span class="mi">1</span>
<span class="n">hWnd</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindowA%&amp;(0, _OFFSET(Title)) 'get window handle</span>

<span class="n">Font</span><span class="err">$</span> <span class="o">=</span> <span class="n">ShowFont</span><span class="err">$</span><span class="p">(</span><span class="n">hWnd</span><span class="p">)</span> <span class="c1">'           call Dialog Box and get the font selection</span>
<span class="n">PRINT</span> <span class="n">Font</span><span class="err">$</span><span class="p">,</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">FontColor</span><span class="o">&amp;</span><span class="p">),</span> <span class="n">FontType</span><span class="err">$;</span> <span class="n">FontEff</span><span class="err">$</span><span class="p">,</span> <span class="n">PointSize</span><span class="o">&amp;</span> <span class="c1">'other values SHARED by function</span>
<span class="n">COLOR</span> <span class="n">FontColor</span><span class="o">&amp;</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Font Color Selected"</span>
<span class="n">END</span>

<span class="n">FUNCTION</span> <span class="n">ShowFont</span><span class="err">$</span> <span class="p">(</span><span class="n">hWnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">DIM</span> <span class="n">cf</span> <span class="n">AS</span> <span class="n">CHOOSEFONT</span>
<span class="n">DIM</span> <span class="n">lfont</span> <span class="n">AS</span> <span class="n">LOGFONT</span>
<span class="n">SHARED</span> <span class="n">FontColor</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">FontType</span><span class="err">$</span><span class="p">,</span> <span class="n">FontEff</span><span class="err">$</span><span class="p">,</span> <span class="n">PointSize</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'shared with main program</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfHeight</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="c1">' determine default height '       set dailog box defaults</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfWidth</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="c1">' determine default width</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfEscapement</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="c1">' angle between baseline and escapement vector</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfOrientation</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="c1">' angle between baseline and orientation vector</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfWeight</span> <span class="o">=</span> <span class="n">FW_REGULAR</span> <span class="c1">' normal weight i.e. not bold</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfCharSet</span> <span class="o">=</span> <span class="n">DEFAULT_CHARSET</span> <span class="c1">' use default character set</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfOutPrecision</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="c1">' default precision mapping</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfClipPrecision</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="c1">' default clipping precision</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfQuality</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="c1">' default quality setting</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfPitchAndFamily</span> <span class="o">=</span> <span class="n">LF_DEFAULT</span> <span class="n">OR</span> <span class="n">FF_ROMAN</span> <span class="c1">' default pitch, proportional with serifs</span>
<span class="n">lfont</span><span class="p">.</span><span class="n">lfFaceName</span> <span class="o">=</span> <span class="s">"Times New Roman"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">' string must be null-terminated</span>
<span class="n">cf</span><span class="p">.</span><span class="n">lStructSize</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">cf</span><span class="p">)</span> <span class="c1">' size of structure</span>
<span class="n">cf</span><span class="p">.</span><span class="n">hwndOwner</span> <span class="o">=</span> <span class="n">hWnd</span> <span class="c1">' window opening the dialog box</span>
<span class="c1">'cf.HDC = Printer.hDC ' device context of default printer (using VB's mechanism)</span>
<span class="n">cf</span><span class="p">.</span><span class="n">lpLogFont</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">lfont</span><span class="p">)</span>
<span class="n">cf</span><span class="p">.</span><span class="n">iPointSize</span> <span class="o">=</span> <span class="mi">120</span> <span class="c1">' 12 point font (in units of 1/10 point)</span>
<span class="n">cf</span><span class="p">.</span><span class="n">Flags</span> <span class="o">=</span> <span class="n">CF_BOTH</span> <span class="n">OR</span> <span class="n">CF_EFFECTS</span> <span class="n">OR</span> <span class="n">CF_FORCEFONTEXIST</span> <span class="n">OR</span> <span class="n">CF_INITTOLOGFONTSTRUCT</span> <span class="n">OR</span> <span class="n">CF_LIMITSIZE</span>
<span class="n">cf</span><span class="p">.</span><span class="n">rgbColors</span> <span class="o">=</span> <span class="n">_RGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">' black</span>
<span class="n">cf</span><span class="p">.</span><span class="n">nFontType</span> <span class="o">=</span> <span class="n">REGULAR_FONTTYPE</span> <span class="c1">' regular font type i.e. not bold or anything</span>
<span class="n">cf</span><span class="p">.</span><span class="n">nSizeMin</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">' minimum point size</span>
<span class="n">cf</span><span class="p">.</span><span class="n">nSizeMax</span> <span class="o">=</span> <span class="mi">72</span> <span class="c1">' maximum point size</span>

<span class="n">IF</span> <span class="n">ChooseFontA</span><span class="o">&amp;</span><span class="p">(</span><span class="n">_OFFSET</span><span class="p">(</span><span class="n">cf</span><span class="p">))</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="c1">'    'Initiate Dialog and Read user selections</span>
  <span class="n">ShowFont</span> <span class="o">=</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">lfont</span><span class="p">.</span><span class="n">lfFaceName</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">lfont</span><span class="p">.</span><span class="n">lfFaceName</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="c1">'returns closest color attribute or 32 bit value and swaps red and blue color values</span>
  <span class="n">FontColor</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">_RGB</span><span class="p">(</span><span class="n">_BLUE32</span><span class="p">(</span><span class="n">cf</span><span class="p">.</span><span class="n">rgbColors</span><span class="p">),</span> <span class="n">_GREEN32</span><span class="p">(</span><span class="n">cf</span><span class="p">.</span><span class="n">rgbColors</span><span class="p">),</span> <span class="n">_RED32</span><span class="p">(</span><span class="n">cf</span><span class="p">.</span><span class="n">rgbColors</span><span class="p">))</span>
  <span class="n">IF</span> <span class="n">cf</span><span class="p">.</span><span class="n">nFontType</span> <span class="n">AND</span> <span class="n">BOLD_FONTTYPE</span> <span class="n">THEN</span> <span class="n">FontType</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Bold"</span>
  <span class="n">IF</span> <span class="n">cf</span><span class="p">.</span><span class="n">nFontType</span> <span class="n">AND</span> <span class="n">ITALIC_FONTTYPE</span> <span class="n">THEN</span> <span class="n">FontType</span><span class="err">$</span> <span class="o">=</span> <span class="n">FontType</span><span class="err">$</span> <span class="o">+</span> <span class="s">"Italic"</span>
  <span class="n">IF</span> <span class="n">cf</span><span class="p">.</span><span class="n">nFontType</span> <span class="n">AND</span> <span class="n">REGULAR_FONTTYPE</span> <span class="n">THEN</span> <span class="n">FontType</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Regular"</span>
  <span class="n">IF</span> <span class="n">lfont</span><span class="p">.</span><span class="n">lfUnderline</span> <span class="n">THEN</span> <span class="n">FontEff</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Underline"</span>
  <span class="n">IF</span> <span class="n">lfont</span><span class="p">.</span><span class="n">lfStrikeOut</span> <span class="n">THEN</span> <span class="n">FontEff</span><span class="err">$</span> <span class="o">=</span> <span class="n">FontStyle</span><span class="err">$</span> <span class="o">+</span> <span class="s">"Strikeout"</span>
  <span class="n">PointSize</span> <span class="o">=</span> <span class="n">cf</span><span class="p">.</span><span class="n">iPointSize</span> <span class="o">\</span> <span class="mi">10</span>
<span class="n">ELSE</span>
  <span class="n">IF</span> <span class="n">CommDlgExtendedError</span><span class="o">&amp;</span> <span class="n">THEN</span>
    <span class="n">PRINT</span> <span class="s">"ChooseFontA failed. Error: 0x"</span><span class="err">;</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">CommDlgExtendedError</span><span class="o">&amp;</span><span class="p">))</span>
  <span class="n">ELSE</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Entry was cancelled!"</span>
  <span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>
<p>Code by Michael Calkins and Ted Weissgerber</p>

<p><strong>Warning! This dialog box may error for no apparent reason! See [http://msdn.microsoft.com/en-us/library/windows/desktop/ms646916(v=vs.85).aspx CommDlgExtendedError] for more info!</strong></p>

<blockquote>
  <p><em>Snippet:</em> Shows how to compare a Font Dialog Box request with <a href="STRING.html">STRING</a> file data created by the <a href="Windows-Libraries.html">Windows Libraries</a> below:</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">' procedure assumes that all fonts have been loaded into an array as below:</span>
<span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Times New Roman (TrueType) = TIMES.TTF"</span> <span class="c1">'array simulates registry data from file</span>
<span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Times New Roman Bold (TrueType) = TIMESBD.TTF"</span>
<span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Times New Roman Bold Italic (TrueType) = TIMESBI.TTF"</span>
<span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Times New Roman Italic (TrueType) = TIMESI.TTF"</span>
<span class="n">Font</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Times New Roman Bold Italic"</span> <span class="c1">'font name returned by Font Dialog box</span>
<span class="n">File</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span>

<span class="n">FOR</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">TO</span> <span class="mi">4</span> <span class="c1">'numFiles% 'actual number of font file registry records</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="err">$</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">Font</span><span class="err">$</span><span class="p">)</span> <span class="n">THEN</span> <span class="c1">'check for match of Dialog Box font name "Times New Roman"</span>
  <span class="n">FontFile</span><span class="err">$</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"="</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>   <span class="c1">'get each file name value</span>
  <span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">FontType</span><span class="err">$</span>   <span class="c1">'check for user requested font type to get file name</span>
  <span class="n">CASE</span> <span class="s">"Bold"</span>
    <span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Bold"</span><span class="p">)</span> <span class="n">AND</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Italic"</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">File</span><span class="err">$</span> <span class="o">=</span> <span class="n">FontFile</span><span class="err">$</span>
  <span class="n">CASE</span> <span class="s">"Italic"</span>
    <span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Italic"</span><span class="p">)</span> <span class="n">AND</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Bold"</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">File</span><span class="err">$</span> <span class="o">=</span> <span class="n">FontFile</span><span class="err">$</span>
  <span class="n">CASE</span> <span class="s">"BoldItalic"</span>
    <span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Bold"</span><span class="p">)</span> <span class="n">AND</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Italic"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">File</span><span class="err">$</span> <span class="o">=</span> <span class="n">FontFile</span><span class="err">$</span>
  <span class="n">CASE</span> <span class="n">ELSE</span> <span class="c1">'regular font as default</span>
    <span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Bold"</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">AND</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">RegFont</span><span class="err">$</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s">"Italic"</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">File</span><span class="err">$</span> <span class="o">=</span> <span class="n">FontFile</span><span class="err">$</span>
  <span class="n">END</span> <span class="n">SELECT</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">IF</span> <span class="n">LEN</span><span class="p">(</span><span class="n">File</span><span class="err">$</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">EXIT</span> <span class="n">FOR</span>  <span class="c1">'quit searching</span>
<span class="n">NEXT</span> 

</code></pre></div></div>

<blockquote>
  <p><em>Note:</em> The Font Dialog name will not normally have descriptions such as Regular, Bold, Italics or (TrueType) so it ignores them.</p>
</blockquote>

<blockquote>
  <p><strong><a href="https://docs.microsoft.com/en-us/windows/win32/gdi/fonts-and-text">GDI Tools Font Guidlines</a></strong></p>
</blockquote>

<h2 id="registered-fonts">Registered Fonts</h2>

<blockquote>
  <p>The Registry lists the Font Names and associated TTF file names that are needed with the <a href="Windows-Libraries.html">Windows Libraries</a> in a program.</p>
</blockquote>

<blockquote>
  <p>The following program uses Registry functions from <em>advapi32.dll</em> to read the list of registered fonts and put them into a file.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">' winreg.h</span>
<span class="n">CONST</span> <span class="n">HKEY_CLASSES_ROOT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000000</span><span class="err">~</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">HKEY_CURRENT_USER</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000001</span><span class="err">~</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">HKEY_LOCAL_MACHINE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000002</span><span class="err">~</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">HKEY_USERS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000003</span><span class="err">~</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">HKEY_PERFORMANCE_DATA</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000004</span><span class="err">~</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">HKEY_CURRENT_CONFIG</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000005</span><span class="err">~</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">HKEY_DYN_DATA</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000006</span><span class="err">~</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">REG_OPTION_VOLATILE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">REG_OPTION_NON_VOLATILE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">REG_CREATED_NEW_KEY</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">REG_OPENED_EXISTING_KEY</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1">' **http://msdn.microsoft.com/en-us/library/ms724884(v=VS.85).aspx**</span>
<span class="n">CONST</span> <span class="n">REG_NONE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">REG_SZ</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">REG_EXPAND_SZ</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CONST</span> <span class="n">REG_BINARY</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">CONST</span> <span class="n">REG_DWORD_LITTLE_ENDIAN</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1">'   value is defined REG_DWORD in Windows header files</span>
<span class="n">CONST</span> <span class="n">REG_DWORD</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1">'                  32-bit number</span>
<span class="n">CONST</span> <span class="n">REG_DWORD_BIG_ENDIAN</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">'       some UNIX systems support big-endian architectures</span>
<span class="n">CONST</span> <span class="n">REG_LINK</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">CONST</span> <span class="n">REG_MULTI_SZ</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">CONST</span> <span class="n">REG_RESOURCE_LIST</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">CONST</span> <span class="n">REG_FULL_RESOURCE_DESCRIPTOR</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">CONST</span> <span class="n">REG_RESOURCE_REQUIREMENTS_LIST</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">CONST</span> <span class="n">REG_QWORD_LITTLE_ENDIAN</span> <span class="o">=</span> <span class="mi">11</span>  <span class="c1">'  64-bit number in little-endian format</span>
<span class="n">CONST</span> <span class="n">REG_QWORD</span> <span class="o">=</span> <span class="mi">11</span> <span class="c1">'                 64-bit number</span>
<span class="n">CONST</span> <span class="n">REG_NOTIFY_CHANGE_NAME</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">REG_NOTIFY_CHANGE_ATTRIBUTES</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CONST</span> <span class="n">REG_NOTIFY_CHANGE_LAST_SET</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">CONST</span> <span class="n">REG_NOTIFY_CHANGE_SECURITY</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1">' **http://msdn.microsoft.com/en-us/library/ms724878(v=VS.85).aspx**</span>
<span class="n">CONST</span> <span class="n">KEY_ALL_ACCESS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">HF003F</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_CREATE_LINK</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0020</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_CREATE_SUB_KEY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0004</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_ENUMERATE_SUB_KEYS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0008</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_EXECUTE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H20019</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_NOTIFY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0010</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_QUERY_VALUE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0001</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_READ</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H20019</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_SET_VALUE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0002</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_WOW64_32KEY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0200</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_WOW64_64KEY</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0100</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">KEY_WRITE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H20006</span><span class="o">&amp;</span>

<span class="c1">' winerror.h</span>
<span class="c1">' **http://msdn.microsoft.com/en-us/library/ms681382(v=VS.85).aspx**</span>
<span class="n">CONST</span> <span class="n">ERROR_SUCCESS</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">ERROR_FILE_NOT_FOUND</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">ERROR_INVALID_HANDLE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H6</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">ERROR_MORE_DATA</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">HEA</span><span class="o">&amp;</span>
<span class="n">CONST</span> <span class="n">ERROR_NO_MORE_ITEMS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H103</span><span class="o">&amp;</span>
<span class="c1">'---------------------------------------------------------------------------------------------</span>
<span class="c1">' REGSAM is an ACCESS_MASK (winreg.h), which is a DWORD (winnt.h)</span>

<span class="c1">'Note: All of these functions, except RegCloseKey, have both ANSI (ending in A)</span>
<span class="c1">'and Unicode (ending in W) versions. I am not aware of any reason why both</span>
<span class="c1">'versions could not be used in the same program. To add the Unicode version,</span>
<span class="c1">'duplicate the function declaration, but change the ending A to W. Be sure that</span>
<span class="c1">'you know how to use the Unicode version! ANSI versions tested, sort of:</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"advapi32"</span>

  <span class="c1">' **http://msdn.microsoft.com/en-us/library/ms724897(v=VS.85).aspx**</span>
  <span class="n">FUNCTION</span> <span class="n">RegOpenKeyExA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hKey</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpSubKey</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">ulOptions</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">samDesired</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">phkResult</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>

  <span class="c1">' **http://msdn.microsoft.com/en-us/library/ms724837(v=VS.85).aspx**</span>
  <span class="n">FUNCTION</span> <span class="n">RegCloseKey</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hKey</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>

  <span class="c1">' **http://msdn.microsoft.com/en-us/library/ms724865(v=VS.85).aspx**</span>
  <span class="n">FUNCTION</span> <span class="n">RegEnumValueA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hKey</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwIndex</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpValueName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span><span class="n">_</span>
 <span class="n">BYVAL</span> <span class="n">lpcchValueName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpReserved</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpType</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpData</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span><span class="n">_</span>
 <span class="n">BYVAL</span> <span class="n">lpcbData</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>

<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">hKey</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
<span class="n">DIM</span> <span class="n">Ky</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
<span class="n">DIM</span> <span class="n">SubKey</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">Value</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">bData</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">t</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">dwType</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">numBytes</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">numTchars</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">l</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">dwIndex</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>

<span class="n">OPEN</span> <span class="s">"F0NTList.INF"</span> <span class="n">FOR</span> <span class="n">OUTPUT</span> <span class="n">AS</span> <span class="p">#</span><span class="mi">1</span>  <span class="c1">'create a new file for font data</span>
<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"This key lists the registered fonts available to all users:"</span>
<span class="n">Ky</span> <span class="o">=</span> <span class="n">HKEY_LOCAL_MACHINE</span>
<span class="n">SubKey</span> <span class="o">=</span> <span class="s">"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Value</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">261</span><span class="p">)</span> <span class="c1">'ANSI Value name limit 260 chars + 1 null</span>
<span class="n">bData</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H7FFF</span><span class="p">)</span> <span class="c1">'arbitrary</span>

<span class="n">l</span> <span class="o">=</span> <span class="n">RegOpenKeyExA</span><span class="p">(</span><span class="n">Ky</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">SubKey</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEY_READ</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">hKey</span><span class="p">))</span>
<span class="n">IF</span> <span class="n">l</span> <span class="n">THEN</span>
  <span class="n">PRINT</span> <span class="s">"RegOpenKeyExA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="n">ELSE</span>
  <span class="n">PRINT</span> <span class="n">whatKey$</span><span class="p">(</span><span class="n">Ky</span><span class="p">)</span> <span class="o">+</span> <span class="s">"\"</span> <span class="o">+</span> <span class="n">SubKey</span>
  <span class="n">dwIndex</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">DO</span>
    <span class="n">_DELAY</span> <span class="p">.</span><span class="err">1</span>
    <span class="n">numBytes</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">bData</span><span class="p">)</span>
    <span class="n">numTchars</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">RegEnumValueA</span><span class="p">(</span><span class="n">hKey</span><span class="p">,</span> <span class="n">dwIndex</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">Value</span><span class="p">),</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">numTchars</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">dwType</span><span class="p">),</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">bData</span><span class="p">),</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">numBytes</span><span class="p">))</span>
    <span class="n">IF</span> <span class="n">l</span> <span class="n">THEN</span>
      <span class="n">IF</span> <span class="n">l</span> <span class="o">&lt;&gt;</span> <span class="n">ERROR_NO_MORE_ITEMS</span> <span class="n">THEN</span>
        <span class="n">PRINT</span> <span class="s">"RegEnumValueA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
      <span class="n">END</span> <span class="n">IF</span>
      <span class="n">EXIT</span> <span class="n">DO</span>
    <span class="n">ELSE</span>
      <span class="n">PRINT</span> <span class="n">whatType</span><span class="p">(</span><span class="n">dwType</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">numTchars</span><span class="p">)</span> <span class="o">+</span> <span class="s">" = "</span> <span class="o">+</span> <span class="n">formatData</span><span class="p">(</span><span class="n">dwType</span><span class="p">,</span> <span class="n">numBytes</span><span class="p">,</span> <span class="n">bData</span><span class="p">)</span>
      <span class="n">PRINT</span> <span class="p">#</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">numTchars</span><span class="p">)</span> <span class="o">+</span> <span class="s">" = "</span> <span class="o">+</span> <span class="n">formatData</span><span class="p">(</span><span class="n">dwType</span><span class="p">,</span> <span class="n">numBytes</span><span class="p">,</span> <span class="n">bData</span><span class="p">)</span>
    <span class="n">END</span> <span class="n">IF</span>
    <span class="n">dwIndex</span> <span class="o">=</span> <span class="n">dwIndex</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="n">LOOP</span>
  <span class="n">CLOSE</span> <span class="p">#</span><span class="mi">1</span>
  <span class="n">PRINT</span> <span class="n">dwIndex</span><span class="err">;</span> <span class="s">"Values."</span>
  <span class="n">l</span> <span class="o">=</span> <span class="n">RegCloseKey</span><span class="p">(</span><span class="n">hKey</span><span class="p">)</span>
  <span class="n">IF</span> <span class="n">l</span> <span class="n">THEN</span>
    <span class="n">PRINT</span> <span class="s">"RegCloseKey failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
    <span class="n">END</span>
  <span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">END</span>

<span class="n">FUNCTION</span> <span class="n">whatType$</span> <span class="p">(</span><span class="n">dwType</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">dwType</span>
  <span class="n">CASE</span> <span class="n">REG_SZ</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_SZ"</span>
  <span class="n">CASE</span> <span class="n">REG_EXPAND_SZ</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_EXPAND_SZ"</span>
  <span class="n">CASE</span> <span class="n">REG_BINARY</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_BINARY"</span>
  <span class="n">CASE</span> <span class="n">REG_DWORD</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_DWORD"</span>
  <span class="n">CASE</span> <span class="n">REG_DWORD_BIG_ENDIAN</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_DWORD_BIG_ENDIAN"</span>
  <span class="n">CASE</span> <span class="n">REG_LINK</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_LINK"</span>
  <span class="n">CASE</span> <span class="n">REG_MULTI_SZ</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_MULTI_SZ"</span>
  <span class="n">CASE</span> <span class="n">REG_RESOURCE_LIST</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_RESOURCE_LIST"</span>
  <span class="n">CASE</span> <span class="n">REG_FULL_RESOURCE_DESCRIPTOR</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_FULL_RESOURCE_DESCRIPTOR"</span>
  <span class="n">CASE</span> <span class="n">REG_RESOURCE_REQUIREMENTS_LIST</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_RESOURCE_REQUIREMENTS_LIST"</span>
  <span class="n">CASE</span> <span class="n">REG_QWORD</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"REG_QWORD"</span>
  <span class="n">CASE</span> <span class="n">ELSE</span><span class="p">:</span> <span class="n">whatType</span> <span class="o">=</span> <span class="s">"unknown"</span>
<span class="n">END</span> <span class="n">SELECT</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">whatKey$</span> <span class="p">(</span><span class="n">hKey</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">hKey</span>
  <span class="n">CASE</span> <span class="n">HKEY_CLASSES_ROOT</span><span class="p">:</span> <span class="n">whatKey</span> <span class="o">=</span> <span class="s">"HKEY_CLASSES_ROOT"</span>
  <span class="n">CASE</span> <span class="n">HKEY_CURRENT_USER</span><span class="p">:</span> <span class="n">whatKey</span> <span class="o">=</span> <span class="s">"HKEY_CURRENT_USER"</span>
  <span class="n">CASE</span> <span class="n">HKEY_LOCAL_MACHINE</span><span class="p">:</span> <span class="n">whatKey</span> <span class="o">=</span> <span class="s">"HKEY_LOCAL_MACHINE"</span>
  <span class="n">CASE</span> <span class="n">HKEY_USERS</span><span class="p">:</span> <span class="n">whatKey</span> <span class="o">=</span> <span class="s">"HKEY_USERS"</span>
  <span class="n">CASE</span> <span class="n">HKEY_PERFORMANCE_DATA</span><span class="p">:</span> <span class="n">whatKey</span> <span class="o">=</span> <span class="s">"HKEY_PERFORMANCE_DATA"</span>
  <span class="n">CASE</span> <span class="n">HKEY_CURRENT_CONFIG</span><span class="p">:</span> <span class="n">whatKey</span> <span class="o">=</span> <span class="s">"HKEY_CURRENT_CONFIG"</span>
  <span class="n">CASE</span> <span class="n">HKEY_DYN_DATA</span><span class="p">:</span> <span class="n">whatKey</span> <span class="o">=</span> <span class="s">"HKEY_DYN_DATA"</span>
<span class="n">END</span> <span class="n">SELECT</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">formatData$</span> <span class="p">(</span><span class="n">dwType</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">numBytes</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">bData</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">DIM</span> <span class="n">t</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">ul</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">b</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">_BYTE</span>
<span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">dwType</span>
  <span class="n">CASE</span> <span class="n">REG_SZ</span><span class="p">,</span> <span class="n">REG_EXPAND_SZ</span><span class="p">,</span> <span class="n">REG_MULTI_SZ</span>
    <span class="n">formatData</span> <span class="o">=</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">bData</span><span class="p">,</span> <span class="n">numBytes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">CASE</span> <span class="n">REG_DWORD</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">CVL</span><span class="p">(</span><span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">bData</span><span class="p">,</span> <span class="mi">4</span><span class="p">))))</span>
    <span class="n">formatData</span> <span class="o">=</span> <span class="s">"0x"</span> <span class="o">+</span> <span class="n">STRING</span><span class="err">$</span><span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">LEN</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">H30</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span>
  <span class="n">CASE</span> <span class="n">ELSE</span>
    <span class="n">IF</span> <span class="n">numBytes</span> <span class="n">THEN</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">ASC</span><span class="p">(</span><span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">bData</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
      <span class="n">IF</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="o">&amp;</span><span class="n">H10</span> <span class="n">THEN</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="s">"0"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
      <span class="n">ELSE</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
      <span class="n">END</span> <span class="n">IF</span>
    <span class="n">END</span> <span class="n">IF</span>
    <span class="n">FOR</span> <span class="n">ul</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">TO</span> <span class="n">numBytes</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">ASC</span><span class="p">(</span><span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">bData</span><span class="p">,</span> <span class="n">ul</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
      <span class="n">IF</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="o">&amp;</span><span class="n">H10</span> <span class="n">THEN</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="s">" 0"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
      <span class="n">ELSE</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
      <span class="n">END</span> <span class="n">IF</span>
    <span class="n">NEXT</span>
    <span class="n">formatData</span> <span class="o">=</span> <span class="n">t</span>
<span class="n">END</span> <span class="n">SELECT</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>
<p>Code courtesy of Michael Calkins</p>

<blockquote>
  <p><em>Note:</em> The names used in a Font Dialog Box and the actual file names are saved to the <em>F0NTList.INF</em>(name uses zero) file to be compared with user entries. To check for <em>Bold</em> and <em>Italics</em> or combined types of font requests see <a href="Windows-Libraries.html">Windows Libraries</a> above.</p>
</blockquote>

<p><strong>Note: The above procedure only reads the Registry. Edit or alter the Registry at your own peril!</strong></p>

<p><a href="Windows-Registry-Access.html">Windows Registry Access</a></p>

<h2 id="game-pad">Game Pad</h2>

<blockquote>
  <p>Function <em>joyGetPosEx</em> allows for more buttons and dual analog multiple sticks</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"winmm"</span>
    <span class="n">FUNCTION</span> <span class="n">joyGetNumDevs%</span> <span class="p">()</span> <span class="c1">' Number of joysticks supported on system</span>
    <span class="n">FUNCTION</span> <span class="n">joyGetPosEx&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">uJoyID</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">joyref</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">TYPE</span> <span class="n">JOYINFOEX</span>
    <span class="n">dwSize</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwFlags</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwXpos</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwYpos</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwZpos</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwRpos</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwUpos</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwVpos</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwButtons</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwButtonNumber</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwPOV</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwReserved1</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwReserved2</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DIM</span> <span class="n">Joy1</span> <span class="n">AS</span> <span class="n">JOYINFOEX</span>
<span class="n">Joy1</span><span class="p">.</span><span class="n">dwSize</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">Joy1</span><span class="p">)</span>

<span class="n">DO</span>
    <span class="n">x&amp;</span> <span class="o">=</span> <span class="n">joyGetPosEx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwSize</span><span class="p">)</span>

    <span class="n">LOCATE</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwSize</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwFlags</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwXpos</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwYpos</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwZpos</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwRpos</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwUpos</span>
    <span class="n">PRINT</span> <span class="n">Joy1</span><span class="p">.</span><span class="n">dwVpos</span>

<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> 

</code></pre></div></div>
<p>Code courtesy of Unseenmachine</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"winmm"</span>
    <span class="n">FUNCTION</span> <span class="n">joyGetNumDevs%</span> <span class="p">()</span> <span class="c1">' Number of joysticks supported on system</span>
    <span class="n">FUNCTION</span> <span class="n">joyGetPos&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">uJoyID</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">joyref</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">TYPE</span> <span class="n">JOYINFO</span>
    <span class="n">wXpos</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
    <span class="n">wYpos</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
    <span class="n">wZpos</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
    <span class="n">wButtons</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">TYPE</span> <span class="n">PadCalibration</span>
    <span class="n">IsAnalog</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">XMin</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">YMin</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">XMax</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">YMax</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">XNorm</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">YNorm</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">Button1</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">Button2</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">Button3</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">Button4</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">Button5</span> <span class="n">AS</span> <span class="n">INTEGER</span>
    <span class="n">Button6</span> <span class="n">AS</span> <span class="n">INTEGER</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DIM</span> <span class="n">MyJoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">,</span> <span class="n">MyJoy</span> <span class="n">AS</span> <span class="n">JOYINFO</span>

<span class="c1">'// Simple calibration.</span>

<span class="n">PRINT</span> <span class="s">"Press button 1 (A on XBox | X on PS3) "</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button1</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Press button 2 (B on XBox | Circle on PS3) "</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button2</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Press button 3 (X on XBox | Square on PS3) "</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button3</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Press button 4 (Y on XBox | Triangle on PS3) "</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button4</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Press button 5 (R1) "</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button5</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Press button 6 (L1) "</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button6</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Leave the joystick in its central position and press button 1"</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button1</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">XNorm</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wXpos</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Push the joystick as far left as possible and press button 1"</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button1</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">XMin</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wXpos</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Push the joystick as far right as possible and press button 1"</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button1</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">XMax</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wXpos</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Push the joystick as far up as possible and press button 1"</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button1</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">YMin</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wXpos</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">PRINT</span> <span class="s">"Push the joystick as far down as possible and press button 1"</span>
<span class="n">DO</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButtons</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">MyJoyCal</span><span class="p">.</span><span class="n">Button1</span>
<span class="n">MyJoyCal</span><span class="p">.</span><span class="n">YMax</span> <span class="o">=</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wXpos</span>
<span class="n">SLEEP</span> <span class="mi">1</span>

<span class="n">CLS</span>

<span class="c1">'//How to get the gamepads status.</span>

<span class="n">DO</span>
    <span class="n">a%</span> <span class="o">=</span> <span class="n">StickXPos</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">b%</span> <span class="o">=</span> <span class="n">StickYPos</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">c%</span> <span class="o">=</span> <span class="n">StickZPos</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">d%</span> <span class="o">=</span> <span class="n">JoyButton1</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">e%</span> <span class="o">=</span> <span class="n">JoyButton2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">f%</span> <span class="o">=</span> <span class="n">JoyButton3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">g%</span> <span class="o">=</span> <span class="n">JoyButton4</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">h%</span> <span class="o">=</span> <span class="n">JoyButton5</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>
    <span class="n">i%</span> <span class="o">=</span> <span class="n">JoyButton6</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">,</span> <span class="n">MyJoyCal</span><span class="p">)</span>

    <span class="n">LOCATE</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"X axis : "</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wXpos</span>
    <span class="n">PRINT</span> <span class="s">"Y axis : "</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wYpos</span>
    <span class="n">PRINT</span> <span class="s">"Z axis : "</span><span class="p">,</span> <span class="n">MyJoy</span><span class="p">.</span><span class="n">wZpos</span>
    <span class="n">PRINT</span> <span class="s">"Button 1 : "</span><span class="p">,</span> <span class="n">d%</span>
    <span class="n">PRINT</span> <span class="s">"Button 2 : "</span><span class="p">,</span> <span class="n">e%</span>
    <span class="n">PRINT</span> <span class="s">"Button 3 : "</span><span class="p">,</span> <span class="n">f%</span>
    <span class="n">PRINT</span> <span class="s">"Button 4 : "</span><span class="p">,</span> <span class="n">g%</span>
    <span class="n">PRINT</span> <span class="s">"Button 5 : "</span><span class="p">,</span> <span class="n">h%</span>
    <span class="n">PRINT</span> <span class="s">"Button 6 : "</span><span class="p">,</span> <span class="n">i%</span>

<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="s">""</span>


<span class="c1">'// Functions</span>

<span class="n">FUNCTION</span> <span class="n">StickXPos</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">StickXPos</span> <span class="o">=</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">StickYPos</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">StickYPos</span> <span class="o">=</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wYpos</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">StickZPos</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">StickZPos</span> <span class="o">=</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wZpos</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">JoyButtons</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">JoyButtons</span> <span class="o">=</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wButtons</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">JoyButton1</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">JoyCal</span><span class="p">.</span><span class="n">Button1</span> <span class="n">THEN</span>
    <span class="n">JoyButton1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ELSE</span>
    <span class="n">JoyButton1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">JoyButton2</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">JoyCal</span><span class="p">.</span><span class="n">Button2</span> <span class="n">THEN</span>
    <span class="n">JoyButton2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ELSE</span>
    <span class="n">JoyButton2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">JoyButton3</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">JoyCal</span><span class="p">.</span><span class="n">Button3</span> <span class="n">THEN</span>
    <span class="n">JoyButton3</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ELSE</span>
    <span class="n">JoyButton3</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">JoyButton4</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">JoyCal</span><span class="p">.</span><span class="n">Button4</span> <span class="n">THEN</span>
    <span class="n">JoyButton4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ELSE</span>
    <span class="n">JoyButton4</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">JoyButton5</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">JoyCal</span><span class="p">.</span><span class="n">Button5</span> <span class="n">THEN</span>
    <span class="n">JoyButton5</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ELSE</span>
    <span class="n">JoyButton5</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span>

<span class="n">FUNCTION</span> <span class="n">JoyButton6</span> <span class="p">(</span><span class="n">Index</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">Joyref</span> <span class="n">AS</span> <span class="n">JOYINFO</span><span class="p">,</span> <span class="n">JoyCal</span> <span class="n">AS</span> <span class="n">PadCalibration</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">joyGetPos</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wXpos</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">Joyref</span><span class="p">.</span><span class="n">wButtons</span> <span class="o">=</span> <span class="n">JoyCal</span><span class="p">.</span><span class="n">Button6</span> <span class="n">THEN</span>
    <span class="n">JoyButton6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">ELSE</span>
    <span class="n">JoyButton6</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>

<h2 id="hot-keys-maximize">Hot Keys (maximize)</h2>

<blockquote>
  <p><strong>Maximizing a minimized program window not in focus using Shift + A as read by the Windows <em>GetKeyState</em> function.</strong></p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'#### #### </span>
<span class="c1">'CHEAPO-HOTKEY.BAS</span>
<span class="c1">'#### #### </span>

<span class="c1">'Uses GetKeyState Win API to monitor a Key state.</span>
<span class="c1">'This demo will maximize the window when Shift+A is pressed at any time.</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
  <span class="n">FUNCTION</span> <span class="n">FindWindowA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span> <span class="c1">'handle by title</span>
  <span class="n">FUNCTION</span> <span class="n">GetKeyState</span><span class="err">%</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">nVirtKey</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span> <span class="c1">'reads Windows key presses independently</span>
  <span class="n">FUNCTION</span> <span class="n">ShowWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nCmdShow</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span> <span class="c1">'minimize or maximize</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">title$</span> <span class="o">=</span> <span class="s">"Cheapo Hotkey (Shift+A)"</span> <span class="c1">'string variable avoids title typo's</span>
<span class="n">_TITLE</span> <span class="n">title$</span>
<span class="n">hwnd&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindowA(0, title$ + CHR$(0))</span>

<span class="n">PRINT</span> <span class="s">"Minimize this window, then Press Shift+A to bring it back up."</span>

<span class="c1">'###  below minimizes it for you</span>
<span class="c1">'_DELAY 4</span>
<span class="c1">'x&amp; = ShowWindow&amp;(hwnd&amp;, 2)</span>
<span class="c1">'#### #### #### #### ## </span>

<span class="n">DO</span>
  <span class="n">IF</span> <span class="n">GetKeyState</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="n">AND</span> <span class="n">GetKeyState</span><span class="p">(</span><span class="n">ASC</span><span class="p">(</span><span class="s">"A"</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="c1">'&lt;####  Shift+A</span>
      <span class="n">y&amp;</span> <span class="o">=</span> <span class="n">ShowWindow</span><span class="o">&amp;</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">PRINT</span> <span class="s">"That is all. Hoped it worked."</span><span class="err">;</span> <span class="n">x&amp;</span><span class="err">;</span> <span class="n">y&amp;</span>
      <span class="n">END</span>
  <span class="n">END</span> <span class="n">IF</span>

  <span class="n">_LIMIT</span> <span class="mi">30</span> <span class="c1">'Don't be a hog</span>
<span class="n">LOOP</span> 

</code></pre></div></div>
<p>Code courtesy of Dav</p>

<blockquote>
  <p><strong>Note:</strong> Virtual Hot keys can be used when a QB64 program is <strong>not in focus</strong> too! See <strong><a href="Windows-Libraries.html">Windows Libraries</a></strong> to bring a QB64 program into focus.</p>
</blockquote>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
'                                  **Virtual KeyState Codes**
'
**' Esc  F1  F2  F3  F4  F5  F6  F7  F8  F9  F10  F11 F12   Sys ScL Pause**
' 27   112 113 114 115 116 117 118 119 120 121  122 123   44  145 19
**' `~  1!  2@  3#  4$  5%  6^  7&amp;  8* 9(  0) -_  =+  BkS   Ins Hme PUp   NumL  /   *    -**
' 192 49  50  51  52  53  54  55  56  57 48 189 187  8    45  36  33    144  111  106 109
**' Tab Q   W   E   R   T   Y   U   I   O   P  [{  ]}  \|   Del End PDn   7Hme 8/?  9PU  +**
'  9  81  87  69  82  84  89  85  73  79  80 219 221 120  46  35  34    103  104  105 107
**' CapL  A   S   D   F   G   H   J   K   L   ;:  '" Enter                4/?-  5   6/-? E**
'  20   65  83  68  70  71  72  74  75  76 186 222  13                  100  101  102  **n**
**' Shift  Z   X   C   V   B   N   M   ,&lt;  .&gt;  /?    Shift       ?        1End 2/?  3PD  t**
' 16/160 90  88  67  86  66  78  77 188  190 191   16/161      38       97   98   99   **e**
**' Ctrl   Win   Alt       Spacebar      Alt Win Menu Ctrl   ?-  ?   -?   0Ins     .Del  r**
' 17/162 91  18/164        32        18/165 92  93 17/163  37  40  39   96        110  13
'
'     Num Lock On values shown. Off values same as functions and arrows, 5 = code 12.
'
'  **Mouse click returns: LB = 1, RB = 2, MB = 4, etc. [http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx Special keys] may also work.**

</code></pre></div></div>

<blockquote>
  <p>NOTE: The above commented table can be copied and pasted directly into the QB64 IDE</p>
</blockquote>

<blockquote>
  <p>**Invisible key and mouse logger that does not require program focus. Press ESCape key to view the logged activity. **</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="err">$</span><span class="n">CONSOLE</span>
<span class="n">_DEST</span> <span class="n">_CONSOLE</span> <span class="c1">' for demonstration only</span>
<span class="n">PRINT</span> <span class="s">"The actual program is hiding. Type some stuff!"</span>
<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"Press ESC to quit logging keys and see results."</span><span class="p">:</span>
<span class="n">_DEST</span> <span class="mi">0</span>
<span class="c1">'#### #### #### #### #### ##  End Demo Console Code #### #### #### #### #### ## </span>

<span class="n">DO</span> <span class="p">:</span> <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">_SCREENEXISTS</span> <span class="c1">'to prevent unexpected freezing</span>
<span class="n">_SCREENHIDE</span> <span class="c1">'makes the program invisible to the user. Escape key displays log!</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>  <span class="c1">'function is already used by QB64 so "User32" is not required</span>
  <span class="n">FUNCTION</span> <span class="n">GetAsyncKeyState</span><span class="err">%</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">vkey</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">theitem$</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">DO</span><span class="p">:</span> <span class="n">_LIMIT</span> <span class="mi">100</span>
  <span class="n">FOR</span> <span class="n">thekey</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H30</span> <span class="n">TO</span> <span class="o">&amp;</span><span class="n">H5A</span>
    <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="n">thekey</span><span class="p">)</span> <span class="n">THEN</span>
      <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="n">thekey</span><span class="p">)</span>
      <span class="n">DO</span>
      <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="n">thekey</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">END</span> <span class="n">IF</span>
  <span class="n">NEXT</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="s">"{MOUSE LEFT}"</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="s">"{MOUSE RIGHT}"</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="s">"{MOUSE MIDDLE}"</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s">"{BS}"</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s">"{TAB}"</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HD</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="s">"{ENTER}"</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HD</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H14</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s">"{CAPS LOCK}"</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H14</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H20</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span>
    <span class="n">DO</span>
    <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H20</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">END</span> <span class="n">IF</span>
  <span class="n">IF</span> <span class="n">GetAsyncKeyState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H1B</span><span class="p">)</span> <span class="n">THEN</span>
    <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">theitem$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="s">"{ESC}"</span>
    <span class="n">EXIT</span> <span class="n">DO</span> <span class="c1">'ESC key exits loop and prints logged key presses</span>
  <span class="n">END</span> <span class="n">IF</span>
<span class="n">LOOP</span>

<span class="n">_SCREENSHOW</span> <span class="c1">'makes program visible with ESC key press</span>
<span class="n">FOR</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">TO</span> <span class="n">a</span>
  <span class="n">PRINT</span> <span class="n">theitem$</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
  <span class="n">IF</span> <span class="n">b</span> <span class="n">MOD</span> <span class="mi">20</span> <span class="o">=</span> <span class="mi">19</span> <span class="n">THEN</span> <span class="n">COLOR</span> <span class="mi">12</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"press any key"</span><span class="p">:</span> <span class="n">SLEEP</span><span class="p">:</span> <span class="n">COLOR</span> <span class="mi">7</span>
<span class="n">NEXT</span> 

</code></pre></div></div>
<p>Code by Cyperium</p>

<blockquote>
  <p><em>Note:</em> The program will run invisibly without a program icon appearing in the task bar until the ESC key is pressed and the log will be displayed.</p>
</blockquote>

<h2 id="keyboard-lock-settings">Keyboard Lock Settings</h2>

<p>Change Cap Lock, Scroll Lock and Number Lock settings and respective lights or onscreen indicators.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'public domain, 2012 april, michael calkins</span>
<span class="n">CONST</span> <span class="n">INPUT_KEYBOARD</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">KEYEVENTF_KEYDOWN</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">KEYEVENTF_KEYUP</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span>

<span class="n">CONST</span> <span class="n">VK_CAPITAL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H14</span>
<span class="n">CONST</span> <span class="n">VK_NUMLOCK</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H90</span>
<span class="n">CONST</span> <span class="n">VK_SCROLL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H91</span>

<span class="n">CONST</span> <span class="n">scCapital</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H3A</span>
<span class="n">CONST</span> <span class="n">scNumlock</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H45</span>
<span class="n">CONST</span> <span class="n">scScroll</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H46</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"kernel32"</span>
 <span class="n">FUNCTION</span> <span class="n">GetLastError</span><span class="err">~</span><span class="o">&amp;</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
 <span class="n">FUNCTION</span> <span class="n">SendInput</span><span class="err">~</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">nInputs</span><span class="err">~</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">pInputs%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cbSize&amp;</span><span class="p">)</span>
 <span class="n">FUNCTION</span> <span class="n">GetMessageExtraInfo</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">TYPE</span> <span class="n">KeyInputStruc</span>
 <span class="n">type</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">wVk</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
 <span class="n">wScan</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">INTEGER</span>
 <span class="n">dwFlags</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">time</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">dwExtraInfo</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
 <span class="n">pad0</span> <span class="n">AS</span> <span class="n">LONG</span> <span class="c1">'to accomodate the size of a MOUSEINPUT</span>
 <span class="n">pad1</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DIM</span> <span class="n">ki</span><span class="p">(</span><span class="mi">0</span> <span class="n">TO</span> <span class="mi">1</span><span class="p">)</span> <span class="n">AS</span> <span class="n">KeyInputStruc</span> <span class="c1">'2 index array will be zero initialized</span>

<span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">type</span> <span class="o">=</span> <span class="n">INPUT_KEYBOARD</span>
<span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">type</span> <span class="o">=</span> <span class="n">INPUT_KEYBOARD</span>
<span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">dwFlags</span> <span class="o">=</span> <span class="n">KEYEVENTF_KEYDOWN</span>
<span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">dwFlags</span> <span class="o">=</span> <span class="n">KEYEVENTF_KEYUP</span>
<span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">dwExtraInfo</span> <span class="o">=</span> <span class="n">GetMessageExtraInfo</span> <span class="c1">'read function value</span>
<span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">dwExtraInfo</span> <span class="o">=</span> <span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">dwExtraInfo</span>   <span class="c1">'assign same value</span>

<span class="n">RANDOMIZE</span> <span class="n">TIMER</span>
<span class="n">DO</span> <span class="n">UNTIL</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H1B</span><span class="p">)</span>
 <span class="n">_DELAY</span> <span class="mi">2</span>
 <span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">INT</span><span class="p">(</span><span class="n">RND</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
  <span class="n">CASE</span> <span class="mi">0</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">wVk</span> <span class="o">=</span> <span class="n">VK_NUMLOCK</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">wVk</span> <span class="o">=</span> <span class="n">VK_NUMLOCK</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">wScan</span> <span class="o">=</span> <span class="n">scNumlock</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">wScan</span> <span class="o">=</span> <span class="n">scNumlock</span>
   <span class="n">PRINT</span> <span class="s">"Num lock..."</span>
  <span class="n">CASE</span> <span class="mi">1</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">wVk</span> <span class="o">=</span> <span class="n">VK_CAPITAL</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">wVk</span> <span class="o">=</span> <span class="n">VK_CAPITAL</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">wScan</span> <span class="o">=</span> <span class="n">scCapital</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">wScan</span> <span class="o">=</span> <span class="n">scCapital</span>
   <span class="n">PRINT</span> <span class="s">"Caps lock..."</span>
  <span class="n">CASE</span> <span class="mi">2</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">wVk</span> <span class="o">=</span> <span class="n">VK_SCROLL</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">wVk</span> <span class="o">=</span> <span class="n">VK_SCROLL</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">wScan</span> <span class="o">=</span> <span class="n">scScroll</span>
   <span class="n">ki</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">wScan</span> <span class="o">=</span> <span class="n">scScroll</span>
   <span class="n">PRINT</span> <span class="s">"Scroll lock..."</span>
 <span class="n">END</span> <span class="n">SELECT</span>
 <span class="n">l</span> <span class="o">=</span> <span class="n">SendInput</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">LEN</span><span class="p">(</span><span class="n">ki</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span> <span class="c1">'2 tells function to read two indices(0 and 1)</span>
 <span class="n">IF</span> <span class="n">l</span> <span class="o">&lt;&gt;</span> <span class="mi">2</span> <span class="n">THEN</span>
  <span class="n">PRINT</span> <span class="n">l</span>
  <span class="n">PRINT</span> <span class="s">"0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
 <span class="n">END</span> <span class="n">IF</span>
<span class="n">LOOP</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Code by Michael Calkins</p>

<blockquote>
  <p><em>Note:</em> In QB64 the number pad lock does not affect the <a href="INP.html">INP</a>(&amp;H60) release code returns of the <a href="extended-keys.html">extended keys</a> like it did in QBasic.</p>
</blockquote>

<h2 id="message-box">Message Box</h2>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'Message Box Constant values as defined by Microsoft (MBType)</span>
<span class="n">CONST</span> <span class="n">MB_OK</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c1">'OK button only</span>
<span class="n">CONST</span> <span class="n">MB_OKCANCEL</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">1</span>          <span class="c1">'OK &amp; Cancel</span>
<span class="n">CONST</span> <span class="n">MB_ABORTRETRYIGNORE</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1">'Abort, Retry &amp; Ignore</span>
<span class="n">CONST</span> <span class="n">MB_YESNOCANCEL</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">3</span>       <span class="c1">'Yes, No &amp; Cancel</span>
<span class="n">CONST</span> <span class="n">MB_YESNO</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">4</span>             <span class="c1">'Yes &amp; No</span>
<span class="n">CONST</span> <span class="n">MB_RETRYCANCEL</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">5</span>       <span class="c1">'Retry &amp; Cancel</span>
<span class="n">CONST</span> <span class="n">MB_CANCELTRYCONTINUE</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1">'Cancel, Try Again &amp; Continue</span>
<span class="n">CONST</span> <span class="n">MB_ICONSTOP</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">16</span>         <span class="c1">'Error stop sign icon</span>
<span class="n">CONST</span> <span class="n">MB_ICONQUESTION</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">32</span>     <span class="c1">'Question-mark icon</span>
<span class="n">CONST</span> <span class="n">MB_ICONEXCLAMATION</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">48</span>  <span class="c1">'Exclamation-point icon</span>
<span class="n">CONST</span> <span class="n">MB_ICONINFORMATION</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">64</span>  <span class="c1">'Letter i in a circle icon</span>
<span class="n">CONST</span> <span class="n">MB_DEFBUTTON1</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1">'1st button default(left)</span>
<span class="n">CONST</span> <span class="n">MB_DEFBUTTON2</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">256</span>      <span class="c1">'2nd button default</span>
<span class="n">CONST</span> <span class="n">MB_DEFBUTTON3</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">512</span>      <span class="c1">'3rd button default(right)</span>
<span class="n">CONST</span> <span class="n">MB_APPLMODAL</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">0</span>         <span class="c1">'Message box applies to application only</span>
<span class="n">CONST</span> <span class="n">MB_SYSTEMMODAL</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">4096</span>    <span class="c1">'Message box on top of all other windows</span>
<span class="n">CONST</span> <span class="n">MB_SETFOCUS</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">65536</span>      <span class="c1">'Set message box as focus</span>
<span class="n">CONST</span> <span class="n">IDOK</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">1</span>                 <span class="c1">'OK button pressed</span>
<span class="n">CONST</span> <span class="n">IDCANCEL</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">2</span>             <span class="c1">'Cancel button pressed</span>
<span class="n">CONST</span> <span class="n">IDABORT</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">3</span>              <span class="c1">'Abort button pressed</span>
<span class="n">CONST</span> <span class="n">IDRETRY</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">4</span>              <span class="c1">'Retry button pressed</span>
<span class="n">CONST</span> <span class="n">IDIGNORE</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">5</span>             <span class="c1">'Ignore button pressed</span>
<span class="n">CONST</span> <span class="n">IDYES</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">6</span>                <span class="c1">'Yes button pressed</span>
<span class="n">CONST</span> <span class="n">IDNO</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">7</span>                 <span class="c1">'No button pressed</span>
<span class="n">CONST</span> <span class="n">IDTRYAGAIN</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">10</span>          <span class="c1">'Try again button pressed</span>
<span class="n">CONST</span> <span class="n">IDCONTINUE</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">1</span>           <span class="c1">'Continue button pressed</span>
<span class="c1">'----------------------------------------------------------------------------------------</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
<span class="n">FUNCTION</span> <span class="n">MessageBox</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">Zer0</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">Message</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">Title</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">MBType</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DO</span>
  <span class="n">msg&amp;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">icon&amp;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">DB</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">INPUT</span> <span class="s">"Enter Message Box type(0 to 6 other Quits): "</span><span class="p">,</span> <span class="n">BOX</span><span class="o">&amp;</span>
  <span class="n">IF</span> <span class="n">BOX</span><span class="o">&amp;</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="n">OR</span> <span class="n">BOX</span><span class="o">&amp;</span> <span class="o">&gt;</span> <span class="mi">6</span> <span class="n">THEN</span> <span class="n">EXIT</span> <span class="n">DO</span>

  <span class="n">INPUT</span> <span class="s">"Enter Icon&amp;(0=none, 1=stop, 2=?, 3=!, 4=info): "</span><span class="p">,</span> <span class="n">Icon</span><span class="o">&amp;</span>

  <span class="n">IF</span> <span class="n">BOX</span><span class="o">&amp;</span> <span class="n">THEN</span> <span class="n">INPUT</span> <span class="s">"Enter Default Button(1st, 2nd or 3rd): "</span><span class="p">,</span> <span class="n">DB</span><span class="o">&amp;</span>
  <span class="n">IF</span> <span class="n">DB</span><span class="o">&amp;</span> <span class="n">THEN</span> <span class="n">DB</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">DB</span><span class="o">&amp;</span> <span class="o">-</span> <span class="mi">1</span>     <span class="c1">'adjust value to 0, 1, or 2</span>
  <span class="n">msg&amp;</span> <span class="o">=</span> <span class="n">MsgBox</span><span class="o">&amp;</span><span class="p">(</span><span class="s">"Box Title"</span><span class="p">,</span> <span class="s">"Box text message"</span><span class="p">,</span> <span class="n">BOX</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">Icon</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">DB</span><span class="o">&amp;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span> <span class="c1">'on top of all windows</span>

  <span class="n">PRINT</span> <span class="s">"Button ="</span><span class="err">;</span> <span class="n">msg&amp;</span>
<span class="n">LOOP</span>
<span class="n">END</span>

<span class="n">FUNCTION</span> <span class="n">MsgBox</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">Title</span><span class="err">$</span><span class="p">,</span> <span class="n">Message</span><span class="err">$</span><span class="p">,</span> <span class="n">BoxType</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">Icon</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">DBtn</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">Mode</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">Icon</span><span class="o">&amp;</span>
  <span class="n">CASE</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">MB_ICONSTOP</span><span class="o">&amp;</span>          <span class="c1">'warning X-sign icon</span>
  <span class="n">CASE</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">MB_ICONQUESTION</span><span class="o">&amp;</span>      <span class="c1">'question-mark icon</span>
  <span class="n">CASE</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">MB_ICONEXCLAMATION</span><span class="o">&amp;</span>   <span class="c1">'exclamation-point icon</span>
  <span class="n">CASE</span> <span class="mi">4</span><span class="p">:</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">MB_ICONINFORMATION</span><span class="o">&amp;</span>   <span class="c1">'lowercase letter i in circle</span>
  <span class="n">CASE</span> <span class="n">ELSE</span><span class="p">:</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">'no icon</span>
<span class="n">END</span> <span class="n">SELECT</span>
<span class="n">IF</span> <span class="n">BoxType</span><span class="o">&amp;</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">AND</span> <span class="n">DBtn</span><span class="o">&amp;</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="c1">'set default button as 2nd(256) or 3rd(512)</span>
  <span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">BoxType</span><span class="o">&amp;</span>
    <span class="n">CASE</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span>
     <span class="n">IF</span> <span class="n">DBtn</span><span class="o">&amp;</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">THEN</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">+</span> <span class="n">MB_DEFBUTTON3</span><span class="o">&amp;</span> <span class="n">ELSE</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">+</span> <span class="n">MB_DEFBUTTON2</span><span class="o">&amp;</span> <span class="c1">'3 button</span>
    <span class="n">CASE</span> <span class="n">ELSE</span><span class="p">:</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">+</span> <span class="n">MB_DEFBUTTON2</span><span class="o">&amp;</span> <span class="c1">'2nd button default</span>
  <span class="n">END</span> <span class="n">SELECT</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">Focus</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">MB_SetFocus</span><span class="o">&amp;</span>
<span class="n">MsgBox</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">MessageBox</span><span class="o">&amp;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Message</span><span class="err">$</span><span class="p">,</span> <span class="n">Title</span><span class="err">$</span><span class="p">,</span> <span class="n">BoxType</span><span class="o">&amp;</span> <span class="o">+</span> <span class="n">Icon</span><span class="o">&amp;</span> <span class="o">+</span> <span class="n">Mode</span><span class="o">&amp;</span> <span class="o">+</span> <span class="n">Focus</span><span class="o">&amp;</span><span class="p">)</span> <span class="c1">'focus on button</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>

<blockquote>
  <p><strong>Note:</strong> The demo above can show all of the possible message box options. The actual code necessary is quite simple.</p>
</blockquote>

<h2 id="mouse-area">Mouse Area</h2>

<blockquote>
  <p>Program limits the mouse to a box portion of the Windows desktop using the Rectangle <a href="TYPE.html">TYPE</a> to define the mouse area.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">TYPE</span> <span class="n">Rectangle</span>
  <span class="n">left</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">top</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">right</span> <span class="n">AS</span> <span class="n">LONG</span>
  <span class="n">bottom</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>
<span class="n">DIM</span> <span class="n">Rec</span> <span class="n">AS</span> <span class="n">Rectangle</span>


<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"User32"</span>
  <span class="n">FUNCTION</span> <span class="n">ClipCursor</span><span class="err">%%</span> <span class="p">(</span><span class="n">Rect</span> <span class="n">AS</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="c1">'sets mouse box work area on desktop</span>
  <span class="n">SUB</span> <span class="n">SetCursorPos</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">x</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">y</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span> <span class="c1">'move cursor position</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">SCREEN</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">SetCursorPos</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">36</span>  <span class="c1">'move cursor to left side of desktop</span>

<span class="n">PRINT</span> <span class="s">"Press a key and the mouse is boxed in!"</span>
<span class="n">K</span><span class="err">$</span> <span class="o">=</span> <span class="n">INPUT</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">Rec</span><span class="p">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">Rec</span><span class="p">.</span><span class="n">top</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">Rec</span><span class="p">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">700</span>
<span class="n">Rec</span><span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="mi">800</span>
<span class="n">work%</span><span class="err">%</span> <span class="o">=</span> <span class="n">ClipCursor</span><span class="p">(</span><span class="n">Rec</span><span class="p">)</span>

<span class="n">CLS</span>
<span class="n">PRINT</span> <span class="n">work%</span><span class="err">%</span>
<span class="n">PRINT</span> <span class="s">"Click the mouse and window to quit!"</span>
<span class="n">DO</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">_MOUSEINPUT</span>

<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">_MOUSEBUTTON</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">OR</span> <span class="n">_MOUSEBUTTON</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">SetCursorPos</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">36</span> <span class="c1">'attempts to move mouse to left</span>

<span class="n">SYSTEM</span> 

</code></pre></div></div>

<blockquote>
  <p><em>Note:</em> The left and top positions must be less than the bottom and right pixel position values. Click mouse to exit box area. Click program window to quit.</p>
</blockquote>

<h2 id="open-another-program">Open another Program</h2>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'Uses Kernel32 WinAPI to execute a program in a QB64 program.  Coded by Dav</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="k">Function</span> <span class="nf">WinExec</span> <span class="p">(</span><span class="n">lpCmdLine</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nCmdShow</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">Winmode</span><span class="err">%</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">'0 = Hides the window and activates another window.</span>
<span class="c1">'1 = Activates and displays a normal sized window.</span>
<span class="c1">'2 = Activates the window and minimized to taskbar.</span>
<span class="c1">'3 = Activates the window and displays it as a maximized window.</span>

<span class="c1">'NOTE: If you do 0 (hide), you'll have to Kill the process using your TaskManager!!!</span>

<span class="c1">'###  Open notepad and load samples.txt in the QB64 directory</span>

<span class="n">Filename</span><span class="err">$</span> <span class="o">=</span> <span class="s">"notepad.exe samples.txt"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">'NOTE: EXE filename must be a NULL terminates..CHR$(0)...</span>

<span class="n">Result</span> <span class="o">=</span> <span class="n">WinExec</span><span class="p">(</span><span class="n">Filename</span><span class="err">$</span><span class="p">,</span> <span class="n">Winmode</span><span class="err">%</span><span class="p">)</span>

<span class="c1">'###  Show results ...</span>

<span class="n">SELECT</span> <span class="n">CASE</span> <span class="n">Result</span>
   <span class="n">CASE</span> <span class="mi">0</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"System out of memory or resources."</span>
   <span class="n">CASE</span> <span class="mi">2</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"The specified file was not found."</span>
   <span class="n">CASE</span> <span class="mi">3</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"The specified path was not found."</span>
   <span class="n">CASE</span> <span class="mi">11</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"The file is invalid (non-Win32 .EXE or error in .EXE image)."</span>
   <span class="n">CASE</span> <span class="n">IS</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Program opened normally."</span>
   <span class="n">CASE</span> <span class="n">ELSE</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Unknown error: "</span><span class="err">;</span> <span class="n">Result</span>
<span class="n">END</span> <span class="n">SELECT</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Code by Dav</p>

<blockquote>
  <p><em>Note:</em> The Library file can only run valid Windows executable programs. Not DOS console EXE programs!</p>
</blockquote>

<h2 id="play-wav-sounds">Play WAV Sounds</h2>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CONST</span> <span class="n">SND_SYNC</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">'Windows controlled</span>
<span class="n">CONST</span> <span class="n">SND_ASYNC</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">'user controlled</span>
<span class="n">CONST</span> <span class="n">SND_NODEFAULT</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">'only plays sound file requested</span>
<span class="n">CONST</span> <span class="n">SND_LOOP</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1">'loops the sound. Use ASYNC also to stop later</span>
<span class="n">CONST</span> <span class="n">SND_NOSTOP</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10</span> <span class="c1">'does not allow a sound to be stopped</span>
<span class="n">CONST</span> <span class="n">SND_NOWAIT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2000</span> <span class="c1">'will not play sound if driver is busy</span>
<span class="n">CONST</span> <span class="n">SND_PURGE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H40</span> <span class="c1">'stop any sound playing</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"winmm"</span>
  <span class="n">FUNCTION</span> <span class="n">PlaySound</span><span class="err">%</span> <span class="n">ALIAS</span> <span class="n">PlaySoundA</span> <span class="p">(</span><span class="n">lpszName</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">hModule</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwFlags</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">LINE</span> <span class="n">INPUT</span> <span class="s">"Enter WAV sound file name: "</span><span class="p">,</span> <span class="n">FileName</span><span class="err">$</span>
<span class="n">PRINT</span> <span class="s">"Play asynchronously?(Y/N) "</span><span class="err">;</span>
<span class="n">K</span><span class="err">$</span> <span class="o">=</span> <span class="n">UCASE</span><span class="err">$</span><span class="p">(</span><span class="n">INPUT</span><span class="err">$</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">PRINT</span> <span class="n">K</span><span class="err">$</span>
<span class="n">IF</span> <span class="n">K</span><span class="err">$</span> <span class="o">=</span> <span class="s">"Y"</span> <span class="n">THEN</span> <span class="n">Synch</span> <span class="o">=</span> <span class="n">SND_ASYNC</span> <span class="n">ELSE</span> <span class="n">Synch</span> <span class="o">=</span> <span class="n">SND_SYNC</span>

<span class="n">retval%</span> <span class="o">=</span> <span class="n">PlaySound</span><span class="p">(</span><span class="n">FileName</span><span class="err">$</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Synch</span><span class="p">)</span> 

</code></pre></div></div>
<p>Code by Ted Weissgerber</p>

<blockquote>
  <p><em>Note:</em> ASYNC allows the program to stop the sound by sending a null file name. Flag constants can be added so loop and ASYNC would total 9.</p>
</blockquote>

<p><strong><a href="http://msdn.microsoft.com/en-us/library/ms712636">WINMM.DLL Functions</a></strong></p>

<h2 id="run-one-instance">Run One Instance</h2>

<p>Program catches another instance of the program descriptor label running and closes it</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CONST</span> <span class="n">ERROR_ALREADY_EXISTS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">HB7</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"kernel32"</span>
 <span class="n">FUNCTION</span> <span class="n">CreateMutexA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpMutexAttributes%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">bInitialOwner&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpName%</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="n">FUNCTION</span> <span class="n">GetLastError</span><span class="err">~</span><span class="o">&amp;</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">t</span> <span class="n">AS</span> <span class="n">STRING</span>

<span class="n">t</span> <span class="o">=</span> <span class="s">"Global\Some name unique to your program"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">' see: http://msdn.microsoft.com/en-us/library/ms682411(v=vs.85)</span>

<span class="n">IF</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">CreateMutexA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"CreateMutexA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
 <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="n">IF</span> <span class="n">ERROR_ALREADY_EXISTS</span> <span class="o">=</span> <span class="n">GetLastError</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"Sorry. There can be only one."</span>
 <span class="n">SLEEP</span> <span class="mi">2</span>
 <span class="n">SYSTEM</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">PRINT</span> <span class="s">"But the most wonderful thing about tiggers is I'm the only one."</span>
<span class="n">DO</span> <span class="n">UNTIL</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H1B</span><span class="p">)</span>
<span class="n">LOOP</span>
<span class="n">SYSTEM</span>

</code></pre></div></div>
<p>Code courtesy of Michael Calkins</p>

<blockquote>
  <p><em>Explanation:</em> The same identification string is used in both instances of the running program. Compile example, run the EXE and try to compile and run another instance. ‘Sorry. There can be only one.’ will be printed to the screen and then it will close.</p>
</blockquote>

<h2 id="send-keys">Send Keys</h2>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'### </span>
<span class="c1">'SENDKEYS.BAS</span>
<span class="c1">'### </span>

<span class="c1">'A kind of SENDKEYS clone for QB64. Sends keystrokes to active application.</span>
<span class="c1">'Coded for QB64 by Dav, JAN/2013</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
    <span class="n">SUB</span> <span class="n">SENDKEYS</span> <span class="n">ALIAS</span> <span class="n">keybd_event</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">bVk</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">bScan</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwFlags</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwExtraInfo</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">CONST</span> <span class="n">KEYEVENTF_KEYUP</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span>
<span class="n">CONST</span> <span class="n">VK_SNAPSHOT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2C</span> <span class="c1">'PrtScn key</span>
<span class="n">CONST</span> <span class="n">VK_MENU</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H12</span> <span class="c1">'Alt key</span>
<span class="n">CONST</span> <span class="n">VK_SHIFT</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10</span> <span class="c1">'Shift key</span>
<span class="n">CONST</span> <span class="n">VK_LWIN</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H5B</span>

<span class="n">PRINT</span> <span class="s">""</span>
<span class="n">PRINT</span> <span class="s">"SENDKEYS clone example.  Press ENTER to begin..."</span>
<span class="n">PRINT</span>

<span class="n">WHILE</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span> <span class="n">WEND</span>

<span class="c1">'###  Capture Active window to Clipoard as image (Like Alt+PrtSc)</span>
<span class="n">SENDKEYS</span> <span class="n">VK_MENU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="n">VK_SNAPSHOT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="n">VK_SNAPSHOT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="n">VK_MENU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span>

<span class="n">PRINT</span> <span class="s">"SENDKEYS just sent a Alt+PrtSc keyboard press."</span>
<span class="n">PRINT</span> <span class="s">"A screen-cap of this EXE WINDOW was just sent to your clipboard."</span>
<span class="n">PRINT</span> <span class="s">"Go ahead, check it now, then come back here and press ENTER..."</span>

<span class="n">WHILE</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span> <span class="n">WEND</span>

<span class="c1">'###  Capture Desktop screen to Clipoard as image (Like Shift+PrtSc)</span>
<span class="n">SENDKEYS</span> <span class="n">VK_SHIFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="n">VK_SNAPSHOT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="n">VK_SNAPSHOT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="n">VK_SHIFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span>

<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"Now SENDKEYS just sent a Shift+PrtSc keyboard press."</span>
<span class="n">PRINT</span> <span class="s">"A screen-cap of your DESKTOP was just sent to your clipboard."</span>
<span class="n">PRINT</span> <span class="s">"Go ahead, check it now, then come back here and press ENTER..."</span>
<span class="n">PRINT</span>

<span class="n">WHILE</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span> <span class="n">WEND</span>

<span class="n">PRINT</span> <span class="s">"Now 'Notepad.exe' will open and SENDKEYS will send text to it."</span>
<span class="n">PRINT</span> <span class="s">"Press ENTER to do that now, then close notepad, come back here,"</span>
<span class="n">PRINT</span> <span class="s">"and press ENTER to continue..."</span>

<span class="n">WHILE</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span> <span class="n">WEND</span>

<span class="n">SHELL</span> <span class="n">_DONTWAIT</span> <span class="s">"notepad.exe"</span>

<span class="n">SLEEP</span> <span class="mi">1</span> <span class="c1">'give time to make notepad the active window...</span>

<span class="c1">'###  Say Hi...</span>
<span class="n">SENDKEYS</span> <span class="o">&amp;</span><span class="n">H48</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="n">SENDKEYS</span> <span class="o">&amp;</span><span class="n">H48</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span> <span class="c1">'H</span>
<span class="n">SENDKEYS</span> <span class="o">&amp;</span><span class="n">H49</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="n">SENDKEYS</span> <span class="o">&amp;</span><span class="n">H49</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span> <span class="c1">'i</span>

<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="s">"Now press ENTER for SENDKEYS to Minimize all your windows..."</span>
<span class="n">PRINT</span>

<span class="n">WHILE</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span> <span class="n">WEND</span>

<span class="c1">'###  Minimize windows shortcut</span>
<span class="n">SENDKEYS</span> <span class="n">VK_LWIN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="o">&amp;</span><span class="n">H4D</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">SENDKEYS</span> <span class="n">VK_LWIN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span>

<span class="n">PRINT</span> <span class="s">"That's all. have a nice day."</span>

<span class="n">END</span> 

</code></pre></div></div>
<p>Code courtesy of Dav</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
'                                  **Virtual KeyState Codes**
'
**' Esc  F1  F2  F3  F4  F5  F6  F7  F8  F9  F10  F11 F12   Sys ScL Pause**
' 27   112 113 114 115 116 117 118 119 120 121  122 123   44  145 19
**' `~  1!  2@  3#  4$  5%  6^  7&amp;  8* 9(  0) -_  =+  BkS   Ins Hme PUp   NumL  /   *    -**
' 192 49  50  51  52  53  54  55  56  57 48 189 187  8    45  36  33    144  111  106 109
**' Tab Q   W   E   R   T   Y   U   I   O   P  [{  ]}  \|   Del End PDn   7Hme 8/?  9PU  +**
'  9  81  87  69  82  84  89  85  73  79  80 219 221 120  46  35  34    103  104  105 107
**' CapL  A   S   D   F   G   H   J   K   L   ;:  '" Enter                4/?-  5   6/-? E**
'  20   65  83  68  70  71  72  74  75  76 186 222  13                  100  101  102  **n**
**' Shift  Z   X   C   V   B   N   M   ,&lt;  .&gt;  /?    Shift       ?        1End 2/?  3PD  t**
' 16/160 90  88  67  86  66  78  77 188  190 191   16/161      38       97   98   99   **e**
**' Ctrl   Win   Alt       Spacebar      Alt Win Menu Ctrl   ?-  ?   -?   0Ins     .Del  r**
' 17/162 91  18/164        32        18/165 92  93 17/163  37  40  39   96        110  13
'
'     Num Lock On values shown. Off values same as functions and arrows, 5 = code 12.
'
'  **Mouse click returns: LB = 1, RB = 2, MB = 4, etc. [http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx Special keys] may also work.**

</code></pre></div></div>

<blockquote>
  <p>NOTE: The above commented table can be copied and pasted directly into the QB64 IDE</p>
</blockquote>

<h2 id="system-metrics">System Metrics</h2>

<blockquote>
  <p>Returns the dimensions of the current user’s desktop. Can be used to get various Windows settings.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CONST</span> <span class="n">SM_CXSCREEN</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">'Width of user desktop</span>
<span class="n">CONST</span> <span class="n">SM_CYSCREEN</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">'Height of user desktop</span>
<span class="n">CONST</span> <span class="n">SM_CXFULLSCREEN</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1">' Width of window client area</span>
<span class="n">CONST</span> <span class="n">SM_CYFULLSCREEN</span> <span class="o">=</span> <span class="mi">17</span> <span class="c1">' Height of window client area</span>
<span class="n">CONST</span> <span class="n">SM_CYMENU</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1">' Height of menu</span>
<span class="n">CONST</span> <span class="n">SM_CYCAPTION</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1">' Height of caption or title</span>
<span class="n">CONST</span> <span class="n">SM_CXFRAME</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1">' Width of window frame</span>
<span class="n">CONST</span> <span class="n">SM_CYFRAME</span> <span class="o">=</span> <span class="mi">33</span> <span class="c1">' Height of window frame</span>
<span class="n">CONST</span> <span class="n">SM_CXHSCROLL</span> <span class="o">=</span> <span class="mi">21</span> <span class="c1">' Width of arrow bitmap on horizontal scroll bar</span>
<span class="n">CONST</span> <span class="n">SM_CYHSCROLL</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">' Height of arrow bitmap on horizontal scroll bar</span>
<span class="n">CONST</span> <span class="n">SM_CXVSCROLL</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">' Width of arrow bitmap on vertical scroll bar</span>
<span class="n">CONST</span> <span class="n">SM_CYVSCROLL</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1">' Height of arrow bitmap on vertical scroll bar</span>
<span class="n">CONST</span> <span class="n">SM_CXSIZE</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1">' Width of bitmaps in title bar</span>
<span class="n">CONST</span> <span class="n">SM_CYSIZE</span> <span class="o">=</span> <span class="mi">31</span> <span class="c1">' Height of bitmaps in title bar</span>
<span class="n">CONST</span> <span class="n">SM_CXCURSOR</span> <span class="o">=</span> <span class="mi">13</span> <span class="c1">' Width of cursor</span>
<span class="n">CONST</span> <span class="n">SM_CYCURSOR</span> <span class="o">=</span> <span class="mi">14</span> <span class="c1">' Height of cursor</span>
<span class="n">CONST</span> <span class="n">SM_CXBORDER</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">' Width of window frame that cannot be sized</span>
<span class="n">CONST</span> <span class="n">SM_CYBORDER</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1">' Height of window frame that cannot be sized</span>
<span class="n">CONST</span> <span class="n">SM_CXDOUBLECLICK</span> <span class="o">=</span> <span class="mi">36</span> <span class="c1">' Width of rectangle around the location of the first click.</span>
<span class="n">CONST</span> <span class="n">SM_CYDOUBLECLICK</span> <span class="o">=</span> <span class="mi">37</span> <span class="c1">' Height of rectangle around the location of the first click.</span>
<span class="n">CONST</span> <span class="n">SM_CXDLGFRAME</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1">' Width of dialog frame window</span>
<span class="n">CONST</span> <span class="n">SM_CYDLGFRAME</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1">' Height of dialog frame window</span>
<span class="n">CONST</span> <span class="n">SM_CXICON</span> <span class="o">=</span> <span class="mi">11</span> <span class="c1">' Width of icon</span>
<span class="n">CONST</span> <span class="n">SM_CYICON</span> <span class="o">=</span> <span class="mi">12</span> <span class="c1">' Height of icon</span>
<span class="n">CONST</span> <span class="n">SM_CXICONSPACING</span> <span class="o">=</span> <span class="mi">38</span> <span class="c1">' Width of rectangles the system uses to position tiled icons</span>
<span class="n">CONST</span> <span class="n">SM_CYICONSPACING</span> <span class="o">=</span> <span class="mi">39</span> <span class="c1">' Height of rectangles the system uses to position tiled icons</span>
<span class="n">CONST</span> <span class="n">SM_CXMIN</span> <span class="o">=</span> <span class="mi">28</span> <span class="c1">' Minimum width of window</span>
<span class="n">CONST</span> <span class="n">SM_CYMIN</span> <span class="o">=</span> <span class="mi">29</span> <span class="c1">' Minimum height of window</span>
<span class="n">CONST</span> <span class="n">SM_CXMINTRACK</span> <span class="o">=</span> <span class="mi">34</span> <span class="c1">' Minimum tracking width of window</span>
<span class="n">CONST</span> <span class="n">SM_CYMINTRACK</span> <span class="o">=</span> <span class="mi">35</span> <span class="c1">' Minimum tracking height of window</span>
<span class="n">CONST</span> <span class="n">SM_CXHTHUMB</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">' Width of scroll box (thumb) on horizontal scroll bar</span>
<span class="n">CONST</span> <span class="n">SM_CYVTHUMB</span> <span class="o">=</span> <span class="mi">9</span> <span class="c1">' Width of scroll box (thumb) on vertical scroll bar</span>
<span class="n">CONST</span> <span class="n">SM_DBCSENABLED</span> <span class="o">=</span> <span class="mi">42</span> <span class="c1">' Returns a non-zero if the current Windows version uses double-byte characters, otherwise zero</span>
<span class="n">CONST</span> <span class="n">SM_DEBUG</span> <span class="o">=</span> <span class="mi">22</span> <span class="c1">' Returns non-zero if the Windows version is a debugging version</span>
<span class="n">CONST</span> <span class="n">SM_MENUDROPALIGNMENT</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1">'Alignment of pop-up menus.</span>
<span class="n">CONST</span> <span class="n">SM_MOUSEPRESENT</span> <span class="o">=</span> <span class="mi">19</span> <span class="c1">' Non-zero if mouse hardware is installed</span>
<span class="n">CONST</span> <span class="n">SM_PENWINDOWS</span> <span class="o">=</span> <span class="mi">41</span> <span class="c1">' Handle of Pen Windows dynamic link library if Pen Windows is installed</span>
<span class="n">CONST</span> <span class="n">SM_SWAPBUTTON</span> <span class="o">=</span> <span class="mi">23</span> <span class="c1">' Non-zero if the left and right mouse buttons are swapped</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
    <span class="n">FUNCTION</span> <span class="n">GetSystemMetrics</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">n</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">PRINT</span> <span class="n">trimstr$</span><span class="p">(</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">SM_CXSCREEN</span><span class="p">))</span><span class="err">;</span> <span class="s">"x"</span><span class="err">;</span> <span class="n">trimstr$</span><span class="p">(</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">SM_CYSCREEN</span><span class="p">))</span>

<span class="n">s&amp;</span> <span class="o">=</span> <span class="n">_SCREENIMAGE</span>
<span class="n">PRINT</span> <span class="n">_WIDTH</span><span class="p">(</span><span class="n">s&amp;</span><span class="p">)</span><span class="err">;</span> <span class="s">"X"</span><span class="err">;</span> <span class="n">_HEIGHT</span><span class="p">(</span><span class="n">s&amp;</span><span class="p">)</span>

<span class="n">END</span> <span class="mi">3</span>

<span class="n">FUNCTION</span> <span class="n">trimstr$</span> <span class="p">(</span><span class="n">whatever</span><span class="p">)</span>
<span class="n">trimstr</span> <span class="o">=</span> <span class="n">LTRIM</span><span class="err">$</span><span class="p">(</span><span class="n">RTRIM</span><span class="err">$</span><span class="p">(</span><span class="n">STR</span><span class="err">$</span><span class="p">(</span><span class="n">whatever</span><span class="p">)))</span>
<span class="n">END</span> <span class="n">FUNCTION</span> 

</code></pre></div></div>

<h2 id="top-most-window">Top Most Window</h2>

<blockquote>
  <p>This Windows only procedure will make the program window always stay on top of other windows, but not always in focus. (See <a href="Windows-Libraries.html">Windows Libraries</a>)</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'public domain</span>

<span class="n">CONST</span> <span class="n">SWP_NOSIZE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0001</span>      <span class="c1">'ignores cx and cy size parameters</span>
<span class="n">CONST</span> <span class="n">SWP_NOMOVE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0002</span>      <span class="c1">'ignores x and y position parameters</span>
<span class="n">CONST</span> <span class="n">SWP_NOZORDER</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0004</span>    <span class="c1">'keeps z order and ignores hWndInsertAfter parameter</span>
<span class="n">CONST</span> <span class="n">SWP_NOREDRAW</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0008</span>    <span class="c1">'does not redraw window changes</span>
<span class="n">CONST</span> <span class="n">SWP_NOACTIVATE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0010</span>  <span class="c1">'does not activate window</span>
<span class="n">CONST</span> <span class="n">SWP_FRAMECHANGED</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0020</span>
<span class="n">CONST</span> <span class="n">SWP_SHOWWINDOW</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0040</span>
<span class="n">CONST</span> <span class="n">SWP_HIDEWINDOW</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0080</span>
<span class="n">CONST</span> <span class="n">SWP_NOCOPYBITS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0100</span>
<span class="n">CONST</span> <span class="n">SWP_NOOWNERZORDER</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0200</span>
<span class="n">CONST</span> <span class="n">SWP_NOSENDCHANGING</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0400</span>
<span class="n">CONST</span> <span class="n">SWP_DRAWFRAME</span> <span class="o">=</span> <span class="n">SWP_FRAMECHANGED</span>
<span class="n">CONST</span> <span class="n">SWP_NOREPOSITION</span> <span class="o">=</span> <span class="n">SWP_NOOWNERZORDER</span>
<span class="n">CONST</span> <span class="n">SWP_DEFERERASE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2000</span>
<span class="n">CONST</span> <span class="n">SWP_ASYNCWINDOWPOS</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H4000</span>
<span class="n">CONST</span> <span class="n">HWND_TOP</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1">'window at top of z order no focus</span>
<span class="n">CONST</span> <span class="n">HWND_BOTTOM</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1">'window at bottom of z order no focus</span>
<span class="n">CONST</span> <span class="n">HWND_TOPMOST</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>   <span class="c1">'window above all others no focus unless active</span>
<span class="n">CONST</span> <span class="n">HWND_NOTOPMOST</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="c1">'window below active no focus</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
 <span class="n">FUNCTION</span> <span class="n">FindWindowA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpClassName%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpWindowName%</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="n">FUNCTION</span> <span class="n">SetWindowPos</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hWnd%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">hWndInsertAfter%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">X</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">Y</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cx&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cy&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">uFlags</span><span class="err">~</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="n">FUNCTION</span> <span class="n">GetForegroundWindow</span><span class="err">%</span><span class="o">&amp;</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"kernel32"</span>
 <span class="n">FUNCTION</span> <span class="n">GetLastError</span><span class="err">~</span><span class="o">&amp;</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">t</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">hWnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span>

<span class="n">RANDOMIZE</span> <span class="n">TIMER</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">RND</span> <span class="o">*</span> <span class="o">&amp;</span><span class="n">H1000000</span><span class="p">)</span> <span class="c1">'random title for FindWindowA</span>
<span class="n">_TITLE</span> <span class="n">t</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">hWnd</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindowA(0, _OFFSET(t))</span>
<span class="n">_TITLE</span> <span class="s">"This Window will always be on Top"</span> <span class="c1">'any title</span>

<span class="n">_DELAY</span> <span class="mi">4</span> <span class="c1">'delay allows user to click focus on other windows</span>

<span class="c1">'set as topmost window and move without sizing or activation</span>
<span class="n">IF</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">SetWindowPos</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">HWND_TOPMOST</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SWP_NOSIZE</span> <span class="n">OR</span> <span class="n">SWP_NOACTIVATE</span><span class="p">)</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"SetWindowPos failed. 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">x%</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">GetForegroundWindow</span><span class="err">%</span><span class="o">&amp;</span> <span class="c1">'find currently focused process handle</span>

<span class="n">PRINT</span> <span class="s">"Program handle:"</span><span class="err">;</span> <span class="n">hWnd</span><span class="err">;</span> <span class="s">"Focus handle:"</span><span class="err">;</span> <span class="n">x%</span><span class="o">&amp;</span>
<span class="n">IF</span> <span class="n">hWnd</span> <span class="o">&lt;&gt;</span> <span class="n">x%</span><span class="o">&amp;</span> <span class="n">THEN</span> <span class="n">_SCREENCLICK</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">240</span> <span class="c1">'add 40 to x and y to focus on positioned window</span>

<span class="n">END</span> 

</code></pre></div></div>
<p>Adapted from code by Michael Calkins</p>

<blockquote>
  <p><em>Explanation:</em> When other windows are clicked on, this program window will stay on top. Click it to return focus.</p>
</blockquote>

<blockquote>
  <p><em>SetWindowPos</em> can also move the window’s TLC corner position and re-size the window when not flagged.</p>
</blockquote>

<blockquote>
  <p>When the window is moved to a position, <a href="_SCREENCLICK.html">_SCREENCLICK</a> can be used to focus on the program window.</p>
</blockquote>

<p><strong><em><a href="Windows-Libraries.html">Windows Libraries</a></em> will not work with the <em>SetWindowPos</em>!</strong></p>

<p>[http://msdn.microsoft.com/en-us/library/ms633545(v=vs.85) http://msdn.microsoft.com/en-us/library/ms633545(v=vs.85)]</p>

<h2 id="video-file-player">Video File Player</h2>

<p>Video player for MPG or AVI video files:</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"WINMM"</span>
    <span class="n">FUNCTION</span> <span class="n">mciSendStringA%</span> <span class="p">(</span><span class="n">lpstrCommand</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">lpstrReturnString</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">uReturnLength</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">hwndCallback</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">)</span>
    <span class="c1">' mciSendStringA function plays media files and returns the following:</span>
    <span class="c1">' 0 = command sucessful</span>
    <span class="c1">' - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
    <span class="c1">' lpstrCommand is the MCI command string (and optional flags) to send.</span>
    <span class="c1">' lpstrReturnString is a string that holds any return information.</span>
    <span class="c1">' uReturnLength is the length of the lpstrReturnString string passed.</span>
    <span class="c1">' NOTE: If lpstrCommand given doesn't retun a value then lpstrReturnString</span>
    <span class="c1">'       can be empty and uReturnLength can be set to 0.</span>
    <span class="c1">' hwndCallback contains a callback window handle (only if the Notify flag used in lpstrCommand)</span>
    <span class="c1">'#### #### #### #### #### #### #### #### #### #### #### #### #### #### ### </span>



    <span class="n">FUNCTION</span> <span class="n">mciGetErrorStringA%</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">dwError</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">lpstrBuffer</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">uLength</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">)</span>
    <span class="c1">' mciGetErrorStringA returns error info if the mciSendStringA failed.</span>
    <span class="c1">' dwError is the return value from the mciSendString function.</span>
    <span class="c1">' lpstrBuffer string holds the error information returned by the function.</span>
    <span class="c1">' uLength is the length of the lpstrBuffer string buffer.</span>
    <span class="c1">'#### #### #### #### #### #### #### #### #### #### #### #### #### #### ### </span>

<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">CUSTOMTYPE</span> <span class="n">LIBRARY</span>
    <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">handle&amp;</span> <span class="o">=</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">SCREEN</span> <span class="n">handle&amp;</span>

<span class="n">_TITLE</span> <span class="s">"QB64 Video"</span>
<span class="n">hwnd&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "QB64 Video" + CHR$(0))</span>

<span class="n">ReturnString</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
<span class="n">ErrorString</span><span class="err">$</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
<span class="n">filename$</span> <span class="o">=</span> <span class="s">"c:\DavPiano.mpg"</span> <span class="c1">'&lt;#### #### ##  video file to play</span>

<span class="n">a%</span> <span class="o">=</span> <span class="n">mciSendStringA%</span><span class="p">(</span><span class="s">"open "</span> <span class="o">+</span> <span class="n">filename$</span> <span class="o">+</span> <span class="s">" style popup"</span><span class="p">,</span> <span class="n">ReturnString</span><span class="err">$</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">ReturnString</span><span class="err">$</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">IF</span> <span class="n">a%</span> <span class="n">THEN</span>
    <span class="n">x%</span> <span class="o">=</span> <span class="n">mciGetErrorStringA%</span><span class="p">(</span><span class="n">a%</span><span class="p">,</span> <span class="n">ErrorString</span><span class="err">$</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">ErrorString</span><span class="err">$</span><span class="p">))</span>
    <span class="n">PRINT</span> <span class="n">ErrorString</span><span class="err">$</span>
    <span class="n">END</span>
<span class="n">ELSE</span>
    <span class="n">a2%</span> <span class="o">=</span> <span class="n">mciSendStringA%</span><span class="p">(</span><span class="s">"window "</span> <span class="o">+</span> <span class="n">filename$</span> <span class="o">+</span> <span class="s">" handle "</span> <span class="o">+</span> <span class="n">STR</span><span class="err">$</span><span class="p">(</span><span class="n">hwnd&amp;</span><span class="p">),</span> <span class="n">ReturnString</span><span class="err">$</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">ReturnString</span><span class="err">$</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">b%</span> <span class="o">=</span> <span class="n">mciSendStringA%</span><span class="p">(</span><span class="s">"play "</span> <span class="o">+</span> <span class="n">filename$</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">_SCREENMOVE</span> <span class="n">_MIDDLE</span>
    <span class="c1">'###  Play video...</span>
    <span class="n">DO</span><span class="p">:</span> <span class="n">_LIMIT</span> <span class="mi">30</span><span class="p">:</span> <span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">&lt;&gt;</span> <span class="s">""</span>

    <span class="n">x%</span> <span class="o">=</span> <span class="n">mciSendStringA%</span><span class="p">(</span><span class="s">"stop "</span> <span class="o">+</span> <span class="n">filename$</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">x%</span> <span class="o">=</span> <span class="n">mciSendStringA%</span><span class="p">(</span><span class="s">"close "</span> <span class="o">+</span> <span class="n">filename$</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">END</span> <span class="n">IF</span>

</code></pre></div></div>
<p>Code courtesy of Dav</p>

<h2 id="web-page-download">Web Page Download</h2>

<blockquote>
  <p>Downloads the contents of a web page as an HTML or text file. Text can be edited for page information.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"urlmon"</span>
  <span class="n">FUNCTION</span> <span class="n">URLDownloadToFileA</span><span class="err">%</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">pCaller</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">szURL</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">szFileName</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwReserved</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpfnCB</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="c1">'###  URL to grab (page or a file)</span>
<span class="n">URL</span><span class="err">$</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="s">"http://www.qbasicnews.com/dav/"</span><span class="o">&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
<span class="c1">'###  File to save URL as</span>
<span class="n">URLfile</span><span class="err">$</span> <span class="o">=</span> <span class="s">"DavsIndex.html"</span>

<span class="c1">'###  Download it.  Returns 0 if succeeded</span>
<span class="n">a%</span> <span class="o">=</span> <span class="n">URLDownloadToFileA</span><span class="err">%</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">URL</span><span class="err">$</span><span class="p">,</span> <span class="n">URLfile</span><span class="err">$</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">PRINT</span> <span class="s">"Grabbing : "</span><span class="err">;</span> <span class="n">URL</span><span class="err">$</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Saving as: "</span><span class="err">;</span> <span class="n">URLfile</span><span class="err">$</span>
<span class="n">PRINT</span> <span class="s">"Sleeping 7 secs to do the deed..."</span>
<span class="n">SLEEP</span> <span class="mi">7</span>
<span class="n">PRINT</span> <span class="n">a%</span> 

</code></pre></div></div>
<p>Code courtesy of Dav</p>

<h2 id="windows-api">Windows API</h2>

<blockquote>
  <p>Program finds the window handle by the <a href="_TITLE.html">_TITLE</a> and then does various things with the window using that handle <a href="_OFFSET.html">_OFFSET</a> value.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CONST</span> <span class="n">HWND_BOTTOM</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1">'places the window at the bottom of the Z order</span>
<span class="n">CONST</span> <span class="n">HWND_TOP</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1">'places the window at the top of the Z order</span>
<span class="n">CONST</span> <span class="n">HWND_TOPMOST</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>   <span class="c1">'places the window above all non-topmost windows</span>
<span class="n">CONST</span> <span class="n">HWND_NOTOPMOST</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="c1">'places the window behind all topmost windows</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
  <span class="n">FUNCTION</span> <span class="n">FindWindowA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">class</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">Title</span><span class="err">$</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">CloseWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">OpenIcon</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">SetWindowTextA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">NewTitle</span><span class="err">$</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">GetWindowThreadProcessId</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">null</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">SetWindowPos</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">Zorder</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">X</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">Y</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cx&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">cy&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">flag&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">_TITLE</span> <span class="s">"Windows Test"</span>

<span class="c1">'// Get the window handle (as a long)</span>
<span class="n">hwnd%</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindowA(0, "Windows Test" + CHR$(0))</span>
<span class="n">PRINT</span> <span class="s">"Handle:"</span><span class="err">;</span> <span class="n">hwnd%</span><span class="o">&amp;</span>
<span class="n">_DELAY</span> <span class="mi">3</span>

<span class="c1">'// Minimize the window - places program on the task bar</span>
<span class="n">ret&amp;</span> <span class="o">=</span> <span class="n">CloseWindow</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="s">"Minimize"</span><span class="err">;</span> <span class="n">ret&amp;</span>
<span class="n">_DELAY</span> <span class="mi">3</span> <span class="c1">'// wait a few seconds</span>

<span class="c1">'// Restore the window</span>
<span class="n">ret&amp;</span> <span class="o">=</span> <span class="n">OpenIcon</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="s">"Restore"</span><span class="err">;</span> <span class="n">ret&amp;</span>
<span class="n">_DELAY</span> <span class="mi">3</span>

<span class="c1">'// Sets window priority as TOPMOST and moves the window position column 200, row 0</span>
<span class="n">ret&amp;</span> <span class="o">=</span> <span class="n">SetWindowPos</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">HWND_TOPMOST</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="s">"Position"</span><span class="err">;</span> <span class="n">ret&amp;</span>
<span class="n">_DELAY</span> <span class="mi">3</span>

<span class="c1">'// Change the title of window header to new name</span>
<span class="n">ret&amp;</span> <span class="o">=</span> <span class="n">SetWindowTextA</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">,</span> <span class="s">"Windows API Test"</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="s">"Title"</span><span class="err">;</span> <span class="n">ret&amp;</span>

<span class="c1">'// Get and display the process id for the window using new title name</span>
<span class="n">PID</span><span class="o">&amp;</span> <span class="o">=</span> <span class="n">GetWindowThreadProcessId</span><span class="p">(</span><span class="n">hwnd%</span><span class="o">&amp;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="s">"Process ID:"</span><span class="err">;</span> <span class="n">PID</span><span class="o">&amp;</span>

<span class="n">END</span> 

</code></pre></div></div>
<p>Adapted from header code by Cyperium and Unseenmachine</p>

<blockquote>
  <p><em>Note:</em> <em>SetWindowPos&amp;</em> function sets the pixel location on the desktop and the window dimensions. It can also set the window’s Z order priority.</p>
</blockquote>

<p><strong>The window handle value and process ID never change! Even when the title is changed.</strong></p>

<h2 id="window-focus">Window Focus</h2>

<p>Windows API routine can tell a program when it has lost focus by the user clicking on a different program window or the desktop.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
    <span class="n">FUNCTION</span> <span class="n">GetForegroundWindow</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">()</span>
    <span class="n">FUNCTION</span> <span class="n">FindWindowA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpClassName%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpWindowName%</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">title</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">hWnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span>

<span class="n">title</span> <span class="o">=</span> <span class="s">"Whatever you actually want the title to be"</span>
<span class="n">_TITLE</span> <span class="n">title</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">'always add character zero to FindWindowA string parameter</span>
<span class="n">hWnd</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindowA(0, _OFFSET(title))</span>

<span class="n">DO</span> <span class="n">UNTIL</span> <span class="n">LEN</span><span class="p">(</span><span class="n">INKEY</span><span class="err">$</span><span class="p">)</span>
    <span class="n">IF</span> <span class="n">hWnd</span> <span class="o">=</span> <span class="n">GetForegroundWindow</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"foreground"</span> <span class="n">ELSE</span> <span class="n">PRINT</span> <span class="s">"not foreground"</span>
    <span class="n">SLEEP</span> <span class="mi">1</span>
<span class="n">LOOP</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Adapted from code by Michael Calkins</p>

<blockquote>
  <p><em>Note:</em> <a href="CHR%24.html">CHR$</a>(0) could actually be added to the original title string and it wouldn’t hurt anything. Compared values are <a href="_OFFSET.html">_OFFSET</a>s.</p>
</blockquote>

<p><strong>See <a href="Windows-Libraries.html">Windows Libraries</a> on program.</strong></p>

<h2 id="windows-menu">Windows Menu</h2>

<p><strong>Creates a menu bar in the program window with a name that can be clicked on to execute a procedure.</strong></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DEFLNG</span> <span class="n">A</span><span class="o">-</span><span class="n">Z</span>

<span class="n">CONST</span> <span class="n">MIIM_STATE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span>
<span class="n">CONST</span> <span class="n">MIIM_ID</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span>
<span class="n">CONST</span> <span class="n">MIIM_TYPE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10</span>
<span class="n">CONST</span> <span class="n">MFT_SEPARATOR</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H800</span>
<span class="n">CONST</span> <span class="n">MFT_STRING</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0</span>
<span class="n">CONST</span> <span class="n">MFS_ENABLED</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H0</span>
<span class="n">CONST</span> <span class="n">MFS_CHECKED</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8</span>

<span class="n">CONST</span> <span class="n">HWND_TOPMOST</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">CONST</span> <span class="n">HWND_NOTOPMOST</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">CONST</span> <span class="n">SWP_NOMOVE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span>
<span class="n">CONST</span> <span class="n">SWP_NOSIZE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span>
<span class="c1">'-----------------------------------------------------------------------------------</span>

<span class="n">TYPE</span> <span class="n">MENUITEMINFO</span>
    <span class="n">cbSize</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">fMask</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">fType</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">fState</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">wID</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">hSubMenu</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">hbmpChecked</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">hbmpUnchecked</span> <span class="n">AS</span> <span class="n">LONG</span>
    <span class="n">dwItemData</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
    <span class="n">dwTypeData</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
    <span class="n">cch</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
    <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span> <span class="c1">' To get hWnd handle</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
  <span class="n">FUNCTION</span> <span class="n">CreateMenu</span><span class="o">&amp;</span> <span class="p">()</span>
  <span class="n">FUNCTION</span> <span class="n">DrawMenuBar</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hWnd&amp;</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">SetMenu</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hWnd&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">hMenu&amp;</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">InsertMenuItemA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hMenu&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">uItem&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">fByPosition&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpmii</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">GetMenuItemCount</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hMenu&amp;</span><span class="p">)</span>
  <span class="n">FUNCTION</span> <span class="n">GetMenuItemInfoA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hMenu&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">uItem&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">fByPosition&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpmii</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">hWnd</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">hMenu</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">MenuItem</span> <span class="n">AS</span> <span class="n">MENUITEMINFO</span><span class="p">,</span> <span class="n">BlankMenuItem</span> <span class="n">AS</span> <span class="n">MENUITEMINFO</span>
<span class="n">DIM</span> <span class="n">TypeData</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="n">_TITLE</span> <span class="s">"Menu bar API demo"</span>
<span class="n">hWnd</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "Menu bar API demo" + CHR$(0))</span>

<span class="n">hMenu</span> <span class="o">=</span> <span class="n">CreateMenu</span><span class="p">:</span> <span class="n">BlankMenuItem</span><span class="p">.</span><span class="n">cbSize</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">BlankMenuItem</span><span class="p">)</span>

<span class="n">COLOR</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">CLS</span>

<span class="c1">'Add a separator bar</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">GetMenuItemCount</span><span class="p">(</span><span class="n">hMenu</span><span class="p">):</span> <span class="n">PRINT</span> <span class="s">"MenuItemCount:"</span><span class="err">;</span> <span class="n">count</span>
<span class="n">MenuItem</span> <span class="o">=</span> <span class="n">BlankMenuItem</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">fMask</span> <span class="o">=</span> <span class="n">MIIM_ID</span> <span class="n">OR</span> <span class="n">MIIM_TYPE</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">fType</span> <span class="o">=</span> <span class="n">MFT_SEPARATOR</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">wID</span> <span class="o">=</span> <span class="n">count</span>
<span class="n">IF</span> <span class="n">InsertMenuItemA</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">MenuItem</span><span class="p">))</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Successfully added menu item!"</span> <span class="n">ELSE</span> <span class="n">PRINT</span> <span class="s">"Failed to add menu item!"</span><span class="p">:</span> <span class="n">END</span>

<span class="c1">'Add a button</span>
<span class="n">MenuItem</span> <span class="o">=</span> <span class="n">BlankMenuItem</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">GetMenuItemCount</span><span class="p">(</span><span class="n">hMenu</span><span class="p">):</span> <span class="n">PRINT</span> <span class="s">"MenuItemCount:"</span><span class="err">;</span> <span class="n">count</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">fMask</span> <span class="o">=</span> <span class="n">MIIM_STATE</span> <span class="n">OR</span> <span class="n">MIIM_ID</span> <span class="n">OR</span> <span class="n">MIIM_TYPE</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">fType</span> <span class="o">=</span> <span class="n">MFT_STRING</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">fState</span> <span class="o">=</span> <span class="n">MFS_ENABLED</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">wID</span> <span class="o">=</span> <span class="n">count</span>
<span class="n">TypeData</span> <span class="o">=</span> <span class="s">"&amp;Fire Laser!"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">dwTypeData</span> <span class="o">=</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">TypeData</span><span class="p">)</span>
<span class="n">MenuItem</span><span class="p">.</span><span class="n">cch</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">MenuItem</span><span class="p">.</span><span class="n">dwTypeData</span><span class="p">)</span>
<span class="n">MyButton</span> <span class="o">=</span> <span class="n">MenuItem</span><span class="p">.</span><span class="n">wID</span>
<span class="n">IF</span> <span class="n">InsertMenuItemA</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">MenuItem</span><span class="p">))</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Successfully added menu item!"</span> <span class="n">ELSE</span> <span class="n">PRINT</span> <span class="s">"Failed to add menu item!"</span><span class="p">:</span> <span class="n">END</span>

<span class="n">IF</span> <span class="n">SetMenu</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">hMenu</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Successfully set menu!"</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Menu handle is:"</span><span class="err">;</span> <span class="n">hMenu</span> <span class="n">ELSE</span> <span class="n">PRINT</span> <span class="s">"Failed to set menu!"</span><span class="p">:</span> <span class="n">END</span>

<span class="n">DO</span><span class="p">:</span> <span class="n">_LIMIT</span> <span class="mi">70</span>
    <span class="n">prev_state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="n">GetMenuItemInfoA</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">MyButton</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">MenuItem</span><span class="p">))</span>
    <span class="n">new_state</span> <span class="o">=</span> <span class="n">MenuItem</span><span class="p">.</span><span class="n">fState</span> <span class="n">AND</span> <span class="mi">128</span>
    <span class="n">IF</span> <span class="n">prev_state</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">AND</span> <span class="n">new_state</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Ouch! "</span><span class="err">;</span>
<span class="n">LOOP</span> <span class="n">WHILE</span> <span class="n">INKEY</span><span class="err">$</span> <span class="o">=</span> <span class="s">""</span> 

</code></pre></div></div>
<p>Code by Galleon</p>

<blockquote>
  <p>Links/References: 
  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms647980(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms647980(v=vs.85).aspx</a></p>
</blockquote>

<h2 id="windows-notification">Windows Notification</h2>

<p>The following code creates a pop-up notification balloon in the Windows task bar or from the Windows 10 side bar.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'public domain, 2012 feb, michael calkins</span>

<span class="n">CONST</span> <span class="n">NIM_ADD</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">NIM_MODIFY</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">NIM_DELETE</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">CONST</span> <span class="n">NIF_ICON</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CONST</span> <span class="n">NIF_TIP</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">CONST</span> <span class="n">NIF_INFO</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10</span>

<span class="n">CONST</span> <span class="n">NIIF_NONE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CONST</span> <span class="n">NIIF_INFO</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CONST</span> <span class="n">NIIF_WARNING</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CONST</span> <span class="n">NIIF_ERROR</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">CONST</span> <span class="n">NIIF_USER</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">CONST</span> <span class="n">IDI_APPLICATION</span> <span class="o">=</span> <span class="mi">32512</span>
<span class="n">CONST</span> <span class="n">IDI_HAND</span> <span class="o">=</span> <span class="mi">32513</span>
<span class="n">CONST</span> <span class="n">IDI_QUESTION</span> <span class="o">=</span> <span class="mi">32514</span>
<span class="n">CONST</span> <span class="n">IDI_EXCLAMATION</span> <span class="o">=</span> <span class="mi">32515</span>
<span class="n">CONST</span> <span class="n">IDI_ASTERISK</span> <span class="o">=</span> <span class="mi">32516</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"kernel32"</span>
 <span class="n">FUNCTION</span> <span class="n">GetLastError</span><span class="err">~</span><span class="o">&amp;</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
 <span class="n">FUNCTION</span> <span class="n">FindWindowA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpClassName%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpWindowName%</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="n">FUNCTION</span> <span class="n">LoadIconA</span><span class="err">%</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hInstance%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpIconName%</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"shell32"</span>
 <span class="n">FUNCTION</span> <span class="n">Shell_NotifyIconA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">dwMessage</span><span class="err">~</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpdata%</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">TYPE</span> <span class="n">NOTIFYICONDATA</span>
 <span class="n">cbSize</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">hWnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
 <span class="n">uID</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">uFlags</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">uCallbackMessage</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">hIcon</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
 <span class="n">szTip</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">128</span>
 <span class="n">dwState</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">dwStateMask</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">szInfo</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">256</span>
 <span class="n">uTimeout</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
 <span class="n">szInfoTitle</span> <span class="n">AS</span> <span class="n">STRING</span> <span class="o">*</span> <span class="mi">64</span>
 <span class="n">dwInfoFlags</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">END</span> <span class="n">TYPE</span>

<span class="n">DIM</span> <span class="n">hWnd</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
<span class="n">DIM</span> <span class="n">hIcon</span> <span class="n">AS</span> <span class="n">_OFFSET</span>
<span class="n">DIM</span> <span class="n">t</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">notifydata</span> <span class="n">AS</span> <span class="n">NOTIFYICONDATA</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">cbSize</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="n">notifydata</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="s">"qb64 notification test"</span>
<span class="n">_TITLE</span> <span class="n">t</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">hWnd</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindowA(0, _OFFSET(t)) 'find window ID</span>
<span class="n">IF</span> <span class="n">hWnd</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"FindWindowA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
 <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">hIcon</span> <span class="o">=</span> <span class="n">LoadIconA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">IDI_ASTERISK</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">hIcon</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"LoadIconA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="c1">'first notification</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">hWnd</span> <span class="o">=</span> <span class="n">hWnd</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">uID</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">uFlags</span> <span class="o">=</span> <span class="n">NIF_ICON</span> <span class="n">OR</span> <span class="n">NIF_TIP</span> <span class="n">OR</span> <span class="n">NIF_INFO</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">hIcon</span> <span class="o">=</span> <span class="n">hIcon</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">szTip</span> <span class="o">=</span> <span class="s">"Connect charger!"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">'tool tip</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">szInfo</span> <span class="o">=</span> <span class="s">"Recharge"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">'information</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">uTimeout</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1">'milliseconds</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">szInfoTitle</span> <span class="o">=</span> <span class="s">"Low Battery"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">'balloon title FALSE LOW BATTERY warning</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">dwInfoFlags</span> <span class="o">=</span> <span class="n">NIIF_INFO</span>

<span class="n">IF</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">Shell_NotifyIconA</span><span class="p">(</span><span class="n">NIM_ADD</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">notifydata</span><span class="p">))</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"Shell_NotifyIconA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
 <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">PRINT</span> <span class="s">"Press any key to modify it."</span>
<span class="n">SLEEP</span><span class="p">:</span> <span class="n">DO</span> <span class="n">WHILE</span> <span class="n">LEN</span><span class="p">(</span><span class="n">INKEY</span><span class="err">$</span><span class="p">):</span> <span class="n">LOOP</span>

<span class="n">hIcon</span> <span class="o">=</span> <span class="n">LoadIconA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">IDI_HAND</span><span class="p">)</span>
<span class="n">IF</span> <span class="n">hIcon</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"LoadIconA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
<span class="n">END</span> <span class="n">IF</span>
<span class="c1">'second notification</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">uFlags</span> <span class="o">=</span> <span class="n">NIF_ICON</span> <span class="n">OR</span> <span class="n">NIF_TIP</span> <span class="n">OR</span> <span class="n">NIF_INFO</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">hIcon</span> <span class="o">=</span> <span class="n">hIcon</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">szTip</span> <span class="o">=</span> <span class="s">"hahaha"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">szInfo</span> <span class="o">=</span> <span class="s">":-)"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">uTimeout</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1">'milliseconds</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">szInfoTitle</span> <span class="o">=</span> <span class="s">"Howdy."</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">notifydata</span><span class="p">.</span><span class="n">dwInfoFlags</span> <span class="o">=</span> <span class="n">NIIF_WARNING</span>

<span class="n">IF</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">Shell_NotifyIconA</span><span class="p">(</span><span class="n">NIM_MODIFY</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">notifydata</span><span class="p">))</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"Shell_NotifyIconA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
 <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>


<span class="n">PRINT</span> <span class="s">"Press any key to delete the notification icon."</span>
<span class="n">SLEEP</span><span class="p">:</span> <span class="n">DO</span> <span class="n">WHILE</span> <span class="n">LEN</span><span class="p">(</span><span class="n">INKEY</span><span class="err">$</span><span class="p">):</span> <span class="n">LOOP</span>

<span class="n">IF</span> <span class="mi">0</span> <span class="o">=</span> <span class="n">Shell_NotifyIconA</span><span class="p">(</span><span class="n">NIM_DELETE</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">notifydata</span><span class="p">))</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"Shell_NotifyIconA failed. Error: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">GetLastError</span><span class="p">))</span>
 <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">END</span> 

</code></pre></div></div>
<p>Adapted from code by Michael Calkins</p>

<p>**NOTE: The program emulates a FALSE Low Battery warning!</p>

<blockquote>
  <p><em>MSDN References:</em>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499(v=vs.85).aspx</a></p>
</blockquote>

<p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms648072(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms648072(v=vs.85).aspx</a></p>

<p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb762159(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/bb762159(v=vs.85).aspx</a></p>

<p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb773352(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/bb773352(v=vs.85).aspx</a></p>

<h2 id="windows-ports">Windows Ports</h2>

<blockquote>
  <p>The following library uses QueryDosDeviceA to find the COM or LPT ports on a Windows computer only.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'this example uses QueryDosDeviceA to enumerate COM ports.</span>
<span class="c1">'public domain, sept 2011, michael calkins</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"kernel32"</span>
 <span class="n">FUNCTION</span> <span class="n">QueryDosDeviceA</span><span class="err">~</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">lpDeviceName</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">lpTargetPath</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">ucchMax</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">)</span>
 <span class="n">FUNCTION</span> <span class="n">GetLastError</span><span class="err">~</span><span class="o">&amp;</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">sizeofbuffer</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">buffer</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">i</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">x</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">n</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span>
<span class="n">sizeofbuffer</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">buffer</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="n">sizeofbuffer</span><span class="p">)</span>

<span class="n">DO</span>
 <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
 <span class="n">IF</span> <span class="n">QueryDosDeviceA</span><span class="err">~</span><span class="o">&amp;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">sizeofbuffer</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">GetLastError</span><span class="err">~</span><span class="o">&amp;</span>
  <span class="n">IF</span> <span class="n">x</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H7A</span> <span class="n">THEN</span>
   <span class="n">sizeofbuffer</span> <span class="o">=</span> <span class="n">sizeofbuffer</span> <span class="o">+</span> <span class="mi">1024</span>
   <span class="n">buffer</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="n">sizeofbuffer</span><span class="p">)</span>
  <span class="n">ELSE</span>
   <span class="n">PRINT</span> <span class="s">"Error: 0x"</span><span class="err">;</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
   <span class="n">END</span>
  <span class="n">END</span> <span class="n">IF</span>
 <span class="n">END</span> <span class="n">IF</span>
<span class="n">LOOP</span> <span class="n">WHILE</span> <span class="n">x</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H7A</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">DO</span> <span class="n">WHILE</span> <span class="n">ASC</span><span class="p">(</span><span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
 <span class="n">x</span> <span class="o">=</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
 <span class="n">PRINT</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
 <span class="n">IF</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s">"COM"</span> <span class="n">THEN</span> <span class="c1">'change to "LPT" for parallel ports</span>
  <span class="n">REDIM</span> <span class="n">_PRESERVE</span> <span class="n">comports</span><span class="p">(</span><span class="mi">0</span> <span class="n">TO</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">AS</span> <span class="n">STRING</span>
  <span class="n">comports</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">MID</span><span class="err">$</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
 <span class="n">END</span> <span class="n">IF</span>
 <span class="n">i</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">LOOP</span>

<span class="n">PRINT</span>
<span class="n">PRINT</span> <span class="n">n</span><span class="err">;</span> <span class="s">"COM ports:"</span>
<span class="n">IF</span> <span class="n">n</span> <span class="n">THEN</span>
 <span class="n">FOR</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">TO</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
  <span class="n">DO</span>
   <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">IF</span> <span class="n">QueryDosDeviceA</span><span class="err">~</span><span class="o">&amp;</span><span class="p">(</span><span class="n">_OFFSET</span><span class="p">(</span><span class="n">comports</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">sizeofbuffer</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">GetLastError</span><span class="err">~</span><span class="o">&amp;</span>
    <span class="n">IF</span> <span class="n">x</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H7A</span> <span class="n">THEN</span>
     <span class="n">sizeofbuffer</span> <span class="o">=</span> <span class="n">sizeofbuffer</span> <span class="o">+</span> <span class="mi">1024</span>
     <span class="n">buffer</span> <span class="o">=</span> <span class="n">SPACE</span><span class="err">$</span><span class="p">(</span><span class="n">sizeofbuffer</span><span class="p">)</span>
    <span class="n">ELSE</span>
     <span class="n">PRINT</span> <span class="s">"Error: 0x"</span><span class="err">;</span> <span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
     <span class="n">END</span>
    <span class="n">END</span> <span class="n">IF</span>
   <span class="n">END</span> <span class="n">IF</span>
  <span class="n">LOOP</span> <span class="n">WHILE</span> <span class="n">x</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H7A</span>
  <span class="n">comports</span><span class="p">((</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">comports</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">comports</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">),</span> <span class="n">LEN</span><span class="p">(</span><span class="n">comports</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">PRINT</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H22</span><span class="p">)</span><span class="err">;</span> <span class="n">comports</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="err">;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H22</span><span class="p">)</span><span class="err">;</span> <span class="s">" is mapped to: "</span><span class="err">;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H22</span><span class="p">)</span><span class="err">;</span> <span class="n">comports</span><span class="p">((</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="err">;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H22</span><span class="p">)</span>
 <span class="n">NEXT</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">buffer</span> <span class="o">=</span> <span class="s">""</span>

<span class="n">END</span> 

</code></pre></div></div>
<p>Code courtesy of Michael Calkins</p>

<h2 id="windows-sounds">Windows Sounds</h2>

<blockquote>
  <p>MessageBeep plays Windows alert sound files located in the <em>C:\windows\media</em> folder. Some may not be set!</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">CONST</span> <span class="n">MB_OK</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">'beep</span>
<span class="n">CONST</span> <span class="n">MB_ICONERROR</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H10</span>
<span class="n">CONST</span> <span class="n">MB_ICONQUESTION</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H20</span>
<span class="n">CONST</span> <span class="n">MB_ICONWARNING</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H30</span>
<span class="n">CONST</span> <span class="n">MB_ICONASTERISK</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H40</span>

<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="n">SUB</span> <span class="n">MessageBeep</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">alert</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">PRINT</span> <span class="s">"OK"</span>
<span class="n">MessageBeep</span> <span class="n">MB_OK</span>

<span class="n">SLEEP</span> <span class="mi">2</span>
<span class="n">PRINT</span> <span class="s">"Error"</span>
<span class="n">MessageBeep</span> <span class="n">MB_ICONERROR</span>

<span class="n">SLEEP</span> <span class="mi">2</span>
<span class="n">PRINT</span> <span class="s">"?"</span>
<span class="n">MessageBeep</span> <span class="n">MB_ICONQUESTION</span>

<span class="n">SLEEP</span> <span class="mi">2</span>
<span class="n">PRINT</span> <span class="s">"Warning"</span>
<span class="n">MessageBeep</span> <span class="n">MB_ICONWARNING</span>

<span class="n">SLEEP</span> <span class="mi">2</span>
<span class="n">PRINT</span> <span class="s">"Asterisk"</span>
<span class="n">MessageBeep</span> <span class="n">MB_ICONASTERISK</span>

</code></pre></div></div>
<p>Code by Ted Weissgerber</p>

<blockquote>
  <p><em>Note:</em> The sounds can be set in <em>Control Panel: Sounds and Audio Devices/Sounds</em> settings tab if not already assigned.</p>
</blockquote>

<blockquote>
  <p>PlaySound plays Windows System sounds on most PC’s:</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'SDL-SPECIFIC CHANGES! GL only needs DECLARE LIBRARY without DLL name</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"Winmm"</span>
    <span class="n">FUNCTION</span> <span class="n">PlaySound</span> <span class="p">(</span><span class="n">pszSound</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">hmod</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">fdwSound</span> <span class="n">AS</span> <span class="n">INTEGER</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>
<span class="n">CONST</span> <span class="n">SND_ALIAS</span> <span class="o">=</span> <span class="mi">65536</span>
<span class="n">CONST</span> <span class="n">SND_ASYNC</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">PlaySound</span><span class="p">(</span><span class="s">"SystemExclamation"</span> <span class="o">+</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_ALIAS</span> <span class="o">+</span> <span class="n">SND_ASYNC</span><span class="p">)</span>

</code></pre></div></div>

<blockquote>
  <p>Use “SystemDefault”, “SystemExclamation”, “SystemExit”, “SystemHand”, “SystemQuestion”, “SystemStart” or “SystemWelcome”</p>
</blockquote>

<h2 id="window-transparency">Window Transparency</h2>

<blockquote>
  <p>Program changes transparency of the window. Plus key increases visibility while minus key can make it completely invisible.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DEFINT</span> <span class="n">A</span><span class="o">-</span><span class="n">Z</span>

<span class="c1">' Declare windows API functions</span>
<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"user32"</span>
   <span class="n">FUNCTION</span> <span class="n">SetLayeredWindowAttributes</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">crKey</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">bAlpha</span> <span class="n">AS</span> <span class="n">_UNSIGNED</span> <span class="n">_BYTE</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwFlags</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
   <span class="n">FUNCTION</span> <span class="n">GetWindowLong</span><span class="o">&amp;</span> <span class="n">ALIAS</span> <span class="s">"GetWindowLongA"</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nIndex</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
   <span class="n">FUNCTION</span> <span class="n">SetWindowLong</span><span class="o">&amp;</span> <span class="n">ALIAS</span> <span class="s">"SetWindowLongA"</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nIndex</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwNewLong</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="c1">' Needed for acquiring the hWnd of the window</span>
<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
   <span class="n">FUNCTION</span> <span class="n">FindWindow</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">ClassName</span> <span class="n">AS</span> <span class="n">_OFFSET</span><span class="p">,</span> <span class="n">WindowName</span><span class="err">$</span><span class="p">)</span> <span class="c1">' To get hWnd handle</span>
<span class="n">END</span> <span class="n">DECLARE</span>


<span class="n">DIM</span> <span class="n">MyHwnd</span> <span class="n">AS</span> <span class="n">LONG</span>

<span class="c1">' Get hWnd value</span>
<span class="n">_TITLE</span> <span class="s">"Translucent window test"</span>
<span class="n">MyHwnd</span> <span class="o">=</span> <span class="n">_WINDOWHANDLE</span> <span class="c1">'FindWindow(0, "Translucent window test" + CHR$(0))</span>


<span class="c1">' Set screen and draw a simple fractal which looks cooler than a black translucent window</span>
<span class="n">SCREEN</span> <span class="n">_NEWIMAGE</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">FOR</span> <span class="n">Py</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">TO</span> <span class="mi">479</span>
   <span class="n">FOR</span> <span class="n">Px</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">TO</span> <span class="mi">639</span>
      <span class="n">PSET</span> <span class="p">(</span><span class="n">Px</span><span class="p">,</span> <span class="n">Py</span><span class="p">),</span> <span class="n">_RGB32</span><span class="p">((</span><span class="n">Px</span> <span class="n">OR</span> <span class="n">Py</span><span class="p">)</span> <span class="n">MOD</span> <span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="n">Px</span> <span class="o">+</span> <span class="n">Py</span><span class="p">)</span> <span class="n">MOD</span> <span class="mi">256</span><span class="p">,</span> <span class="n">Py</span> <span class="n">MOD</span> <span class="mi">256</span><span class="p">)</span>
   <span class="n">NEXT</span> <span class="n">Px</span>
<span class="n">NEXT</span> <span class="n">Py</span>


<span class="c1">' Main loop</span>
<span class="n">PRINT</span> <span class="s">"Press +/- to change opacity"</span>

<span class="n">Level</span> <span class="o">=</span> <span class="mi">127</span>
<span class="n">SetWindowOpacity</span> <span class="n">MyHwnd</span><span class="p">,</span> <span class="n">Level</span>
<span class="n">DO</span>
   <span class="n">Press</span><span class="err">$</span> <span class="o">=</span> <span class="n">INKEY</span><span class="err">$</span>
   <span class="n">LOCATE</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">PRINT</span> <span class="s">"Opacity:"</span><span class="err">;</span> <span class="n">Level</span>

   <span class="c1">' Change window opacity whenever +/- are pressed</span>
   <span class="n">IF</span> <span class="n">Press</span><span class="err">$</span> <span class="o">=</span> <span class="s">"+"</span> <span class="n">AND</span> <span class="n">Level</span> <span class="o">&lt;</span> <span class="mi">255</span> <span class="n">THEN</span> <span class="n">Level</span> <span class="o">=</span> <span class="n">Level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">SetWindowOpacity</span> <span class="n">MyHwnd</span><span class="p">,</span> <span class="n">Level</span>
   <span class="n">IF</span> <span class="n">Press</span><span class="err">$</span> <span class="o">=</span> <span class="s">"-"</span> <span class="n">AND</span> <span class="n">Level</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="n">Level</span> <span class="o">=</span> <span class="n">Level</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">SetWindowOpacity</span> <span class="n">MyHwnd</span><span class="p">,</span> <span class="n">Level</span>

   <span class="n">_LIMIT</span> <span class="mi">60</span>

<span class="n">LOOP</span> <span class="n">UNTIL</span> <span class="n">Press</span><span class="err">$</span> <span class="o">=</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="n">SYSTEM</span>


<span class="c1">'#### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### \</span>
<span class="n">SUB</span> <span class="n">SetWindowOpacity</span> <span class="p">(</span><span class="n">hWnd</span> <span class="n">AS</span> <span class="n">LONG</span><span class="p">,</span> <span class="n">Level</span><span class="p">)</span>
<span class="n">DIM</span> <span class="n">Msg</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">CONST</span> <span class="n">G</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
<span class="n">CONST</span> <span class="n">LWA_ALPHA</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H2</span>
<span class="n">CONST</span> <span class="n">WS_EX_LAYERED</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80000</span>

<span class="n">Msg</span> <span class="o">=</span> <span class="n">GetWindowLong</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="n">Msg</span> <span class="o">=</span> <span class="n">Msg</span> <span class="n">OR</span> <span class="n">WS_EX_LAYERED</span>
<span class="n">Crap</span> <span class="o">=</span> <span class="n">SetWindowLong</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">Msg</span><span class="p">)</span>
<span class="n">Crap</span> <span class="o">=</span> <span class="n">SetLayeredWindowAttributes</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Level</span><span class="p">,</span> <span class="n">LWA_ALPHA</span><span class="p">)</span>

<span class="n">END</span> <span class="n">SUB</span> 

</code></pre></div></div>
<p>Code by Jobert</p>

<h2 id="windows-user">Windows User</h2>

<blockquote>
  <p>Finds the current user’s <em>My Documents</em> folder as a <a href="STRING.html">STRING</a> value. Other environmental constants are listed below code.</p>
</blockquote>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">'public domain</span>

<span class="n">CONST</span> <span class="n">MAX_PATH</span> <span class="o">=</span> <span class="mi">260</span>             <span class="c1">'maximum length of path string</span>
<span class="n">CONST</span> <span class="n">CSIDL_PERSONAL</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H5</span>       <span class="c1">'User's My Documents path. See environmental constants below</span>
<span class="n">CONST</span> <span class="n">SHGFP_TYPE_CURRENT</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">CONST</span> <span class="n">S_OK</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1">'environmental value found</span>
<span class="n">CONST</span> <span class="n">S_FALSE</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span>              <span class="c1">'folder does not exist</span>
<span class="n">CONST</span> <span class="n">E_FAILED</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80004005</span><span class="o">&amp;</span>     <span class="c1">'folder does not exist</span>
<span class="n">CONST</span> <span class="n">E_INVALIDARG</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H80070057</span><span class="o">&amp;</span> <span class="c1">'invalid argument parameter</span>

<span class="n">DECLARE</span> <span class="n">DYNAMIC</span> <span class="n">LIBRARY</span> <span class="s">"shell32"</span>
 <span class="n">FUNCTION</span> <span class="n">SHGetFolderPathA</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">BYVAL</span> <span class="n">hwndOwner%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">nFolder&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">hToken%</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">dwFlags</span><span class="err">~</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">BYVAL</span> <span class="n">pszPath%</span><span class="o">&amp;</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="n">DIM</span> <span class="n">path</span> <span class="n">AS</span> <span class="n">STRING</span>
<span class="n">DIM</span> <span class="n">hr</span> <span class="n">AS</span> <span class="n">LONG</span>
<span class="n">DIM</span> <span class="n">n</span> <span class="n">AS</span> <span class="n">LONG</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">STRING</span><span class="err">$</span><span class="p">(</span><span class="n">MAX_PATH</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">'enlarge the string to MAX_PATH</span>

<span class="n">hr</span> <span class="o">=</span> <span class="n">SHGetFolderPathA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">CSIDL_PERSONAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SHGFP_TYPE_CURRENT</span><span class="p">,</span> <span class="n">_OFFSET</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<span class="n">IF</span> <span class="n">hr</span> <span class="n">THEN</span>
 <span class="n">PRINT</span> <span class="s">"hresult: 0x"</span> <span class="o">+</span> <span class="n">LCASE</span><span class="err">$</span><span class="p">(</span><span class="n">HEX</span><span class="err">$</span><span class="p">(</span><span class="n">hr</span><span class="p">))</span> <span class="c1">'function returns non-zero error code</span>
 <span class="n">END</span>
<span class="n">END</span> <span class="n">IF</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">INSTR</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1">'find terminating null</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">LEFT</span><span class="err">$</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">'shrink the string (probably creates a temp string)</span>
<span class="n">PRINT</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H22</span><span class="p">)</span><span class="err">;</span> <span class="n">path</span><span class="err">;</span> <span class="n">CHR</span><span class="err">$</span><span class="p">(</span><span class="o">&amp;</span><span class="n">H22</span><span class="p">)</span>
<span class="n">END</span> 

</code></pre></div></div>
<p>Code courtesy of Michael Calkins</p>

<blockquote>
  <p><em>Note:</em> When the SHGetFolderPathA&amp; function returns a non-zero value, the 0x hexadecimal error number is printed instead.</p>
</blockquote>

<p><strong><a href="http://msdn.microsoft.com/en-us/library/bb776911(v=vs.85)">Vista and newer versions of Windows can also use SHGetKnownFolderPath and similar Constant values</a></strong></p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                              **Windows CSIDL Environmental [LONG](LONG) Constants**

 CONST CSIDL_DESKTOP = &amp;H0                  '&lt;user name&gt;\desktop
 CONST CSIDL_INTERNET = &amp;H1                 'Internet Explorer(icon on desktop)
 CONST CSIDL_PROGRAMS = &amp;H2                 '&lt;user name&gt;\Start Menu\Programs
 CONST CSIDL_CONTROLS = &amp;H3                 'My Computer\Control Panel icon group
 CONST CSIDL_PRINTERS = &amp;H4                 'My Computer\Printers (installed)
 CONST CSIDL_PERSONAL = &amp;H5                 '&lt;user name&gt;\My Documents
 CONST CSIDL_FAVORITES = &amp;H6                '&lt;user name&gt;\Favorites
 CONST CSIDL_STARTUP = &amp;H7                  '&lt;user name&gt;\Start Menu\Programs\Startup
 CONST CSIDL_RECENT = &amp;H8                   '&lt;user name&gt;\Recent
 CONST CSIDL_SENDTO = &amp;H9                   '&lt;user name&gt;\SendTo
 CONST CSIDL_BITBUCKET = &amp;HA                '&lt;user desktop&gt;\Recycle Bin
 CONST CSIDL_STARTMENU = &amp;HB                '&lt;user name&gt;\Start Menu
 CONST CSIDL_MYDOCUMENTS = &amp;HC              'logical "My Documents" desktop icon
 CONST CSIDL_MYMUSIC = &amp;HD                  '&lt;user name&gt;\My Documents\My Music folder
 CONST CSIDL_MYVIDEO = &amp;HE                  '&lt;user name&gt;\My Documents\My Videos folder
 CONST CSIDL_DESKTOPDIRECTORY = &amp;H10        '&lt;user name&gt;\Desktop
 CONST CSIDL_DRIVES = &amp;H11                  'My Computer
 CONST CSIDL_NETWORK = &amp;H12                 'Network Neighborhood (My Network Places)
 CONST CSIDL_NETHOOD = &amp;H13                 '&lt;user name&gt;\nethood
 CONST CSIDL_FONTS = &amp;H14                   'windows\fonts
 CONST CSIDL_TEMPLATES = &amp;H15               'templates
 CONST CSIDL_COMMON_STARTMENU = &amp;H16        'All Users\Start Menu
 CONST CSIDL_COMMON_PROGRAMS = &amp;H17         'All Users\Start Menu\Programs
 CONST CSIDL_COMMON_STARTUP = &amp;H18          'All Users\Startup
 CONST CSIDL_COMMON_DESKTOPDIRECTORY = &amp;H19 'All Users\Startup
 CONST CSIDL_APPDATA = &amp;H1A                 '&lt;user name&gt;\Application Data
 CONST CSIDL_PRINTHOOD = &amp;H1B               '&lt;user name&gt;\PrintHood
 CONST CSIDL_LOCAL_APPDATA = &amp;H1C           '&lt;user name&gt;\Local Settings\Application Data
 CONST CSIDL_ALTSTARTUP = &amp;H1D              'non-localized startup(Vista only)
 CONST CSIDL_COMMON_ALTSTARTUP = &amp;H1E       'common startup
 CONST CSIDL_COMMON_FAVORITES = &amp;H1F        'common startup
 CONST CSIDL_INTERNET_CACHE = &amp;H20          'common startup
 CONST CSIDL_COOKIES = &amp;H21                 'common startup
 CONST CSIDL_HISTORY = &amp;H22                 'common startup
 CONST CSIDL_COMMON_APPDATA = &amp;H23          'All Users\Application Data
 CONST CSIDL_WINDOWS = &amp;H24                 'GetWindowsDirectory()
 CONST CSIDL_SYSTEM = &amp;H25                  'GetSystemDirectory()
 CONST CSIDL_PROGRAM_FILES = &amp;H26           'C:\Program Files
 CONST CSIDL_MYPICTURES = &amp;H27              '&lt;user name&gt;\My Documents\My Pictures
 CONST CSIDL_PROFILE = &amp;H28                 'USERPROFILE
 CONST CSIDL_SYSTEMX86 = &amp;H29               'x86 C:\Windows\System32 or [SysWOW64](SysWOW64)(64 bit PC)
 CONST CSIDL_PROGRAM_FILESX86 = &amp;H2A        'x86 C:\Program Files on RISC
 CONST CSIDL_PROGRAM_FILES_COMMON = &amp;H2B    'C:\Program Files\Common
 CONST CSIDL_PROGRAM_FILES_COMMONX86 = &amp;H2C 'x86 Program Files\Common on RISC
 CONST CSIDL_COMMON_TEMPLATES = &amp;H2D        'All Users\Templates
 CONST CSIDL_COMMON_DOCUMENTS = &amp;H2E        'All Users\Documents
 CONST CSIDL_COMMON_ADMINTOOLS = &amp;H2F       'All Users\Start Menu\Programs\Administrative Tools
 CONST CSIDL_ADMINTOOLS = &amp;H30              '&lt;user name&gt;\Start Menu\Programs\Administrative Tools
 CONST CSIDL_CONNECTIONS = &amp;H31             'Network and Dial-up Connections
 CONST CSIDL_COMMON_MUSIC = &amp;H35            'All Users\My Music
 CONST CSIDL_COMMON_PICTURES = &amp;H36         'All Users\My Pictures
 CONST CSIDL_COMMON_VIDEO = &amp;H37            'All Users\My Video
 CONST CSIDL_RESOURCES = &amp;H38               'Resource Directory
 CONST CSIDL_RESOURCES_LOCALIZED = &amp;H39     'Localized Resource Directory
 CONST CSIDL_COMMON_OEM_LINKS = &amp;H3A        'Links to All Users OEM specific apps
 CONST CSIDL_CDBURN_AREA = &amp;H3B             'USERPROFILE\Local Settings\Application Data\Microsoft\CD Burning

                 'See: [http://msdn.microsoft.com/en-us/library/bb762181(v=vs.85) http://msdn.microsoft.com/en-us/library/bb762181(v=vs.85)] 

</code></pre></div></div>

<h2 id="windows-version">Windows Version</h2>

<p><strong>Note that QB64 will not run on Windows 95 to ME computers currently!</strong></p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">DECLARE</span> <span class="n">LIBRARY</span>
  <span class="n">FUNCTION</span> <span class="n">GetVersion</span> <span class="p">()</span>
<span class="n">END</span> <span class="n">DECLARE</span>

<span class="c1">'Just grab the "build" number...</span>
<span class="n">b$</span> <span class="o">=</span> <span class="n">LTRIM</span><span class="err">$</span><span class="p">(</span><span class="n">RTRIM</span><span class="err">$</span><span class="p">(</span><span class="n">STR</span><span class="err">$</span><span class="p">((</span><span class="n">GetVersion</span> <span class="n">AND</span> <span class="o">&amp;</span><span class="n">HFFFF0000</span><span class="p">)</span> <span class="o">\</span> <span class="o">&amp;</span><span class="n">H10000</span><span class="p">)))</span>


<span class="n">PRINT</span> <span class="s">"The Windows version is: "</span><span class="err">;</span>

<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"095"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows 95"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"1111"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows 95"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"1381"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows NT"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"1998"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows 98"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"2222"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows 98 SE"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"3000"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows ME"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"2195"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows 2000"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"2600"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows XP"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"3790"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows Server 2003"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"6000"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows Vista/Server"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"6001"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows Vista/Server"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"6002"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows Vista/Server"</span>
<span class="n">IF</span> <span class="n">INSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b$</span><span class="p">,</span> <span class="s">"7600"</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">PRINT</span> <span class="s">"Windows 7"</span> 

</code></pre></div></div>
<p>Code courtesy of Dav</p>

<p><strong>NOTE</strong>: Microsoft depreciated GetVersion() for Windows 8 and higher - <a href="https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getversion">https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getversion</a></p>

<h2 id="reference">Reference</h2>

<p><strong>Note: C++ Header files should be placed in the QB64 folder and are not required after a program is compiled.</strong></p>

<p><strong>Your code contribution using the Windows Libraries could end up here!</strong></p>

<h2 id="see-also">See Also</h2>

<ul>
  <li><a href="_WINDOWHANDLE.html">_WINDOWHANDLE</a></li>
  <li><a href="Windows-Environment.html">Windows Environment</a></li>
  <li><a href="DECLARE-LIBRARY.html">DECLARE LIBRARY</a>, <a href="BYVAL.html">BYVAL</a>, <a href="ALIAS.html">ALIAS</a></li>
  <li><a href="_OFFSET.html">_OFFSET</a>, <a href="_OFFSET-(function).html">_OFFSET-(function)</a> (lp, ptr and p names)</li>
  <li><a href="SDL-Libraries.html">SDL Libraries</a>, <a href="DLL-Libraries.html">DLL Libraries</a>, <a href="C-Libraries.html">C Libraries</a></li>
  <li><a href="Libraries.html">Libraries</a></li>
  <li><a href="VB-Script.html">VB Script</a></li>
  <li><a href="Windows-Printer-Settings.html">Windows Printer Settings</a></li>
</ul>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">QB64.com maintained by <a href="https://github.com/DualBrain">Cory Smith</a> on <a href="https://github.com/DualBrain/QB64">GitHub</a>.</p>
        
        <p>Published with <a href="https://pages.github.com/">GitHub Pages</a></p>
      </footer>
    </div>
  </body>

<!-- Mirrored from qb64.com/wiki/Windows-Libraries by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 07 Nov 2024 13:43:40 GMT -->
</html>